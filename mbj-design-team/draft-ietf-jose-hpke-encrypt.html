<!DOCTYPE html>
<html lang="en" class="Internet-Draft">
<head>
<meta charset="utf-8">
<meta content="Common,Latin" name="scripts">
<meta content="initial-scale=1.0" name="viewport">
<title>Use of Hybrid Public Key Encryption (HPKE) with JSON Web Encryption (JWE)</title>
<meta content="Tirumaleswar Reddy" name="author">
<meta content="Hannes Tschofenig" name="author">
<meta content="Aritra Banerjee" name="author">
<meta content="Orie Steele" name="author">
<meta content="Michael B. Jones" name="author">
<meta content="
       This specification defines how to use Hybrid Public Key Encryption (HPKE) with
JSON Web Encryption (JWE).
HPKE enables public key encryption
of arbitrary-sized plaintexts to a recipient's public key, and provides security
against adaptive chosen ciphertext attacks.
This specification chooses a specific subset of the HPKE features to use with JWE. 
       This specification updates RFC 7516 (JWE) to enable use of
the Integrated Encryption Key Establishment Mode. 
    " name="description">
<meta content="xml2rfc 3.31.0" name="generator">
<meta content="Hybrid Public Key Encryption" name="keyword">
<meta content="HPKE" name="keyword">
<meta content="JSON Web Encryption" name="keyword">
<meta content="JWE" name="keyword">
<meta content="JSON Object Signing and Encryption" name="keyword">
<meta content="JOSE" name="keyword">
<meta content="Hybrid" name="keyword">
<meta content="draft-ietf-jose-hpke-encrypt-latest" name="ietf.draft">
<!-- Generator version information:
  xml2rfc 3.31.0
    Python 3.12.12
    ConfigArgParse 1.7
    google-i18n-address 3.1.1
    intervaltree 3.1.0
    Jinja2 3.1.6
    lxml 5.3.1
    platformdirs 4.5.0
    pycountry 24.6.1
    PyYAML 6.0.2
    requests 2.32.5
    wcwidth 0.2.14
-->
<link href="draft-ietf-jose-hpke-encrypt.xml" rel="alternate" type="application/rfc+xml">
<link href="#copyright" rel="license">
<style type="text/css">@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0460-052F, U+1C80-1C88, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
}
@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
}
@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-vietnamese.woff2') format('woff2');
  unicode-range: U+0102-0103, U+0110-0111, U+1EA0-1EF9, U+20AB;
}
@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}

@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0460-052F, U+1C80-1C88, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-cyrillic.woff2') format('woff2');
  unicode-range: U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-vietnamese.woff2') format('woff2');
  unicode-range: U+0102-0103, U+0110-0111, U+1EA0-1EF9, U+20AB;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}

@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0460-052F, U+1C80-1C88, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-cyrillic.woff2') format('woff2');
  unicode-range: U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-vietnamese.woff2') format('woff2');
  unicode-range: U+0102-0103, U+0110-0111, U+1EA0-1EF9, U+20AB;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 600;
  font-display: swap;
  src: local('Lora SemiBold'), local('Lora-SemiBold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-semibold-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}

@font-face {
  font-family: 'Oxygen Mono';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Oxygen Mono'), local('OxygenMono-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/oxygenmono-regular-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Oxygen Mono';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Oxygen Mono'), local('OxygenMono-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/oxygenmono-regular-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}

@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: italic;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-italic-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0460-052F, U+1C80-1C8A, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: italic;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-italic-cyrillic.woff2') format('woff2');
  unicode-range: U+0301, U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: italic;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-italic-greek.woff2') format('woff2');
  unicode-range: U+0370-0377, U+037A-037F, U+0384-038A, U+038C, U+038E-03A1, U+03A3-03FF;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: italic;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-italic-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-02BA, U+02BD-02C5, U+02C7-02CC, U+02CE-02D7, U+02DD-02FF, U+0304, U+0308, U+0329, U+1D00-1DBF, U+1E00-1E9F, U+1EF2-1EFF, U+2020, U+20A0-20AB, U+20AD-20C0, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: italic;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-italic-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+0304, U+0308, U+0329, U+2000-206F, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: normal;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-regular-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0460-052F, U+1C80-1C8A, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: normal;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-regular-cyrillic.woff2') format('woff2');
  unicode-range: U+0301, U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: normal;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-regular-greek.woff2') format('woff2');
  unicode-range: U+0370-0377, U+037A-037F, U+0384-038A, U+038C, U+038E-03A1, U+03A3-03FF;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: normal;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-regular-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-02BA, U+02BD-02C5, U+02C7-02CC, U+02CE-02D7, U+02DD-02FF, U+0304, U+0308, U+0329, U+1D00-1DBF, U+1E00-1E9F, U+1EF2-1EFF, U+2020, U+20A0-20AB, U+20AD-20C0, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: normal;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-regular-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+0304, U+0308, U+0329, U+2000-206F, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}

:root {
  color-scheme: light dark;
  --background-color: #fff;
  --text-color: #222;
  --title-color: #191919;
  --link-color: #2a6496;
  --highlight-color: #f9f9f9;
  --line-color: #eee;
  --pilcrow-weak: #ddd;
  --pilcrow-strong: #bbb;
  --small-font-size: 14.5px;
  --font-mono: 'Oxygen Mono', monospace;
  --font-title: "Sofia Sans Semi Condensed", sans-serif;
  scrollbar-color: #bbb #eee;
}
body {
  max-width: 600px;
  margin: 75px auto;
  padding: 0 5px;
  color: var(--text-color);
  background-color: var(--background-color);
  font: 16px/22px "Lora", serif;
  scroll-behavior: smooth;
}

.ears {
  display: none;
}

/* headings */
section {
  clear: both;
}
.section-number {
  padding-right: 0.5em;
}
h1, h2, h3, h4, h5, h6 {
  font-family: var(--font-title);
  font-weight: 680;
  margin: 0.8em 0 0.3em;
  font-size-adjust: 0.5;
  color: var(--title-color);
}
h1#title {
  font-size: 32px;
  line-height: 40px;
  clear: both;
}
h1#title, h1#rfcnum {
  margin: 1.5em 0 0.2em;
}
h1#rfcnum + h1#title {
  margin: 0.2em 0;
}

h1, h2, h3 {
  font-size: 22px;
  line-height: 27px;
}
h4, h5, h6 {
  font-size: 20px;
  line-height: 24px;
}

/* general structure */
.author {
  padding-bottom: 0.3em;
  vertical-align: top;
}
#abstract+p {
  font-size: 18px;
  line-height: 24px;
}
#abstract+p code, #abstract+p samp, #abstract+p tt {
  font-size: 16px;
  line-height: 0;
}

p {
  padding: 0;
  margin: 0.5em 0;
  text-align: left;
}
div {
  margin: 0;
}
.alignRight.art-text {
  background-color: var(--highlight-color);
  border: 1px solid var(--line-color);
  border-radius: 3px;
  padding: 0.5em 1em 0;
  margin-bottom: 0.5em;
}
.alignRight.art-text pre {
  padding: 0;
  width: auto;
}
.alignRight {
  margin: 1em 0;
}
.alignRight > *:first-child {
  border: none;
  margin: 0;
  float: right;
  clear: both;
}
.alignRight > *:nth-child(2) {
  clear: both;
  display: block;
  border: none;
}
svg {
  display: block;
}
/* font-family isn't space-separated, but =~ will have to do */
svg[font-family~="monospace" i], svg [font-family~="monospace" i] {
  font-family: var(--font-mono);
}
.alignCenter.art-text {
  background-color: var(--highlight-color);
  border: 1px solid var(--line-color);
  border-radius: 3px;
  padding: 0.5em 1em 0;
  margin-bottom: 0.5em;
}
.alignCenter.art-text pre {
  padding: 0;
  width: auto;
}
.alignCenter {
  margin: 1em 0;
}
.alignCenter > *:first-child {
  border: none;
  /* this isn't optimal, but it's an existence proof.  PrinceXML doesn't
     support flexbox yet.
  */
  display: table;
  margin: 0 auto;
}

/* lists */
ol, ul {
  padding: 0;
  margin: 0 0 0.5em 2em;
  & :is(ol, ul) {
    margin-left: 1em;
  }
}
li {
  margin: 0 0 0.25em 0;
}
ul.empty, .ulEmpty {
  list-style-type: none;
  & li {
    margin-top: 0.5em;
  }
}
:is(ul, ol).compact, .ulCompact, .olCompact {
  margin: 0 0 0 2em;
  & li {
    margin: 0;
    & :first-child { margin-top: 0; }
    & :last-child { margin-bottom: 0; }
  }
}

/* definition lists */
dl {
  clear: left;
  --indent: 3ch;
  /* --indent: attr(indent ch); not supported in any browser, but we can dream */
  &.olPercent {
    --indent: 5ch;
    & > dt {
      min-width: calc(var(--indent) - 2ch);
    }
  }
  &.olPercent > dt {
    float: none;
  }

  dl > dd > & {
    margin-top: 0.5em;
    margin-bottom: 0;
  }
}
dl:not(.dlNewline) > dt {
  float: left;
  margin-right: 2ch;
  min-width: 8ch;
}
dl > dd {
  margin-bottom: .8em;
  margin-left: var(--indent) !important; /* stupid element overrides */
  min-height: 2ex;
}
:is(dl.compact, .dlCompact) > dd {
  margin-bottom: 0;
  & > :is(:first-child, .break:first-child + *) {
    margin-top: 0;
  }
  & > :is(:last-child) {
    margin-bottom: 0;
  }
}
:is(dd, span).break {
  display: none;
}

/* links */
a, a[href].selfRef:hover {
  text-decoration: none;
}
a[href] {
  color: var(--link-color);
}
a[href].selfRef, .iref + a[href].internal {
  color: var(--text-color);
}
a[href]:hover {
  text-decoration: underline;
}
a[href].selfRef:hover {
  background-color: var(--highlight-color);
}
a.xref:is(.cite, .auto), :is(#status-of-memo, #copyright) a {
  white-space: nowrap;
}

/* Figures */
tt, code, pre {
  background-color: var(--highlight-color);
  font: 14px/22px var(--font-mono);
}
tt, code {
  /* changing the font for inline elements leads to different ascender
     and descender heights; as we want to retain baseline alignment,
     remove leading to avoid altering the final height of lines
     note: this fails if these blocks take an entire line,
     a different solution would be great */
  line-height: 0;
}
:is(h1, h2, h3, h4, h5, h6) :is(tt, code) {
  font-size: 84%;
}
pre {
  border: 1px solid var(--line-color);
  font-size: 13.5px;
  line-height: 16px;
  letter-spacing: -0.2px;
  margin: 5px;
  padding: 5px;
}
img {
  max-width: 100%;
}
figure {
  margin: 0.5em 0;
  padding: 0;
}
figure blockquote {
  margin: 0.8em 0.4em 0.4em;
}
figcaption, caption {
  font-style: italic;
  margin: 0.5em 1.5em;
  text-align: left;
  caption-side: bottom;
}
@media screen {
  /* Auto-collapse boilerplate. */
  :is(#status-of-memo, #copyright) p {
    margin: -2px 0;
    max-height: 0;
    transition: max-height 2s ease, margin 0.5s ease 0.5s;
    overflow: hidden;
  }
  :is(#status-of-memo, #copyright):hover p,
  :is(#status-of-memo, #copyright) h2:target ~ p {
    margin: 0.5em 0;
    max-height: 500px;
    overflow: auto;
  }
  pre, svg {
    display: inline-block;
    /* In the horizontal direction, sometimes people make over-sized figures.
       Scrollbars for those is therefore necessary: auto adds them as necessary..
       In the vertical direction, the line-height can combine with the font
       asender/descender height to produce scrollbars: hidden avoids that. */
    overflow: auto hidden;
  }
  pre {
    max-width: 100%;
    width: calc(100% - 22px - 1em);
  }
  svg {
    max-width: calc(100% - 22px - 1em);
  }
  figure pre {
    display: block;
    width: calc(100% - 25px);
  }
  :is(pre, svg) + .pilcrow {
    display: inline-block;
    vertical-align: text-bottom;
    padding-bottom: 8px;
  }
}

/* aside, blockquote */
aside, blockquote {
  margin-left: 0;
  padding: 0 2em;
  font-style: italic;
}
blockquote {
  margin: 1em 0;
}
cite {
  display: block;
  text-align: right;
  font-style: italic;
}

/* tables */
table {
  width: auto;
  max-width: 100%;
  margin: 0 0 1em;
  border-collapse: collapse;
}
table.right {
  margin-left: auto;
}
table.center {
  margin-left: auto;
  margin-right: auto;
}
table.left {
  margin-right: auto;
}
table .text-left {
  text-align: left;
}
table .text-center {
  text-align: center;
}
table .text-right {
  text-align: right;
}

thead, tbody {
  border: 1px solid var(--line-color);
}
th, td {
  text-align: left;
  vertical-align: top;
  padding: 5px 10px;
}
th {
  background-color: var(--line-color);
}
:is(tr:nth-child(2n), thead+tbody > tr:nth-child(2n+1)) > td {
  background-color: var(--background-color);
}
:is(tr:nth-child(2n+1), thead+tbody > tr:nth-child(2n)) > td {
  background-color: var(--highlight-color);
}
table caption {
  margin: 0;
  padding: 3px 0 3px 1em;
}
table p {
  margin: 0;
}

/* pilcrow */
a.pilcrow {
  margin-left: 3px;
  opacity: 0.2;
  user-select: none;
  &[href] {
    color: var(--pilcrow-weak);
    &:hover { text-decoration: none; }
  }
}
@media not print {
  :hover > a.pilcrow {
    opacity: 1;
  }
  a.pilcrow[href]:hover {
    color: var(--pilcrow-strong);
    background-color: transparent;
  }
}
@media print {
  a.pilcrow {
    display: none;
  }
}

/* misc */
hr {
  border: 0;
  border-top: 1px solid var(--line-color);
}
.bcp14 {
  font-variant: small-caps;
  font-weight: 600;
  font-size: var(--small-font-size);
}
.role {
  font-variant: all-small-caps;
}
sub, sup {
  line-height: 1;
  font-size: 80%;
}

/* info block */
#identifiers {
  margin: 0;
  font-size: var(--small-font-size);
  line-height: 18px;
  --identifier-width: 15ch;
  & dt {
    width: var(--identifier-width);
    min-width: var(--identifier-width);
    clear: left;
    float: left;
    text-align: right;
    margin-right: 1ch;
  }
  & dd {
    margin: 0;
    margin-left: calc(1em + var(--identifier-width)) !important;
    min-width: 5em;
  }
  & .authors {
    & .author {
      display: inline-block;
      margin-right: 1.5em;
    }
    & .org {
      font-style: italic;
    }
  }
}

/* The prepared/rendered info at the very bottom of the page */
.docInfo {
  color: #999;
  font-size: 0.9em;
  font-style: italic;
  margin-top: 2em;
}
.docInfo .prepared {
  float: right;
}

/* table of contents */
#toc {
  padding: 0.75em 0 2em 0;
  margin-bottom: 1em;

  & nav {
    & ul {
      margin: 0 0.5em 0 0;
      padding: 0;
      list-style: none;
    }
    & li {
      line-height: 1.3em;
      margin: 2px 0;
      padding-left: 1.2em;
      text-indent: -1.2em;
    }
  }
  & a.xref {
    white-space: normal;
  }
}

.references {
  & > dt {
    text-align: right;
    font-weight: bold;
    min-width: 10ch;
    margin-right: 1.5ch;
    &:target::before {
      content: "⇒";
      margin: 0 10px 0 -25px;
    }
  }
  & > dd {
    margin-left: 12ch !important;
    overflow: visible;
    & .refInstance {
      margin-bottom: 0.8em;
    }
    & .ascii {
      margin-bottom: 0.25em;
    }
  }
}

#rfc\.index\.index + ul {
  margin-left: 0;
}

/* authors */
address.vcard {
  font-style: normal;
  max-width: 20em;
  margin: 1em auto 1em 0;

  & .nameRole {
    font-weight: 700;
    margin-left: 0;
  }
  & .label {
    margin: 0.5em 0;
  }
  & .type {
    display: none;
  }
  & .alternative-contact {
    margin: 0.5em 0 0.25em 0;
  }
  & .non-ascii {
    margin: 0 0 0 2em;
  }
  & div.left {
    text-align: left;
  }
  & div.right {
    text-align: right;
  }
}

hr.addr {
  border-top: 1px dashed;
  margin: 0;
  color: #ddd;
  max-width: calc(100% - 16px);
}
@media (min-width: 500px) {
  #authors-addresses > section {
    column-count: 2;
    column-gap: 20px;
  }
  #authors-addresses > section > h2 {
    column-span: all;
  }
  /* hack for break-inside: avoid-column */
  #authors-addresses address {
    display: inline-block;
    break-inside: avoid-column;
  }
}

/* Comments */
.rfcEditorRemove p:first-of-type {
  font-style: italic;
}
.cref {
  background-color: rgba(249, 232, 105, 0.3);
  padding: 2px 4px;
}
.crefSource {
  font-style: italic;
}

@media screen {
  #toc nav {
    font-family: var(--font-title);
    font-weight: 360;
    & > ul { margin-bottom: 2em; }
    & ul {
      margin: 0 0 0 4px;
      & :is(p, li) {
        margin: 2px 0;
      }
    }
  }
  #toc a.toplink {
    float: right;
  }
}
@media not screen {
  #toc a.toplink {
    display: none;
  }
}


/* TOC layout for smaller screens */
@media screen and (max-width: 929px) {
  #toc {
    position: fixed;
    z-index: 2;
    top: 0;
    right: 0;
    padding: 1px 0 0 0;
    margin: 0;
    border-bottom: 1px solid #ccc;
    opacity: 0.6;
  }
  #toc h2 {
    margin: 0;
    padding: 2px 0 2px 6px;
    padding-right: 1em;
    font-size: 18px;
    line-height: 24px;
    min-width: 190px;
    text-align: right;
    background-color: #444;
    color: white;
    cursor: pointer;
    &::before { /* css hamburger */
      float: right;
      position: relative;
      width: 1em;
      height: 1px;
      left: -164px;
      margin: 8px 0 0 0;
      background: white none repeat scroll 0 0;
      box-shadow: 0 4px 0 0 white, 0 8px 0 0 white;
      content: "";
    }
  }
  #toc nav {
    display: none;
    background-color: var(--background-color);
    padding: 0.5em 1em 1em;
    overflow: auto;
    overscroll-behavior: contain;
    height: calc(100vh - 48px);
    border-left: 1px solid #ddd;
  }
  #toc.active {
    opacity: 1;
    & nav { display: block; }
  }
  /* Make the collapsed ToC header render white on gray also when it's a link */
  #toc h2 a,
  #toc h2 a:is(:link, :focus, :hover),
  #toc a.toplink,
  #toc a.toplink:hover {
    color: white;
    background-color: #444;
    text-decoration: none;
  }
  #toc a.toplink {
    margin: 2px 0.5em 0;
  }
}

/* TOC layout for wide screens */
@media screen and (min-width: 930px) {
  body {
    padding-right: 360px;
    padding-right: calc(min(180px + 20%, 500px));
  }
  #toc {
    position: fixed;
    bottom: 0;
    right: 0;
    right: calc(50vw - 480px);
    width: 312px;
    margin: 0;
    padding: 0;
    z-index: 1;
  }
  #toc h2 {
    margin: 0;
    padding: 0.25em 1em 1em 0;
  }
  #toc nav {
    display: block;
    height: calc(90vh - 84px);
    bottom: 0;
    padding: 0.5em 0 2em;
    overflow: auto;
    overscroll-behavior: contain;
    scrollbar-width: thin;
  }
  img { /* future proofing */
    max-width: 100%;
    height: auto;
  }
  #toc a.toplink {
    margin: 8px 0.5em 0;
  }
}

/* pagination */
@media print {
  body {
    width: 100%;
  }
  p {
    orphans: 3;
    widows: 3;
  }
  #n-copyright-notice {
    border-bottom: none;
  }
  #toc, #n-introduction {
    page-break-before: always;
  }
  #toc {
    border-top: none;
    padding-top: 0;
  }
  figure, pre, .vcard {
    page-break-inside: avoid;
  }
  h1, h2, h3, h4, h5, h6 {
    page-break-after: avoid;
  }
  :is(h2, h3, h4, h5, h6)+*, dd {
    page-break-before: avoid;
  }
  pre {
    white-space: pre-wrap;
    word-wrap: break-word;
    font-size: 10pt;
  }
  table {
    border: 1px solid #ddd;
  }
  td {
    border-top: 1px solid #ddd;
  }
}

@page :first {
  padding-top: 0;
  @top-left {
    content: normal;
    border: none;
  }
  @top-center {
    content: normal;
    border: none;
  }
  @top-right {
    content: normal;
    border: none;
  }
}

@page {
  size: A4;
  margin-bottom: 45mm;
  padding-top: 20px;
}

/* Dark mode. */
@media (prefers-color-scheme: dark) {
:root {
  --background-color: #121212;
  --text-color: #f0f0f0;
  --title-color: #fff;
  --link-color: #4da4f0;
  --highlight-color: #282828;
  --line-color: #444;
  --pilcrow-weak: #444;
  --pilcrow-strong: #666;
  scrollbar-color: #777 #333;
}
}

/* SVG Trick: a prefix match works because only black and white are allowed */
svg :is([stroke="black"], [stroke^="#000"]) {
  stroke: var(--text-color);
}
svg :is([stroke="white"], [stroke^="#fff"]) {
  stroke: var(--background-color);
}
svg :is([fill="black"], [fill^="#000"], :not([fill])) {
  fill: var(--text-color);
}
svg :is([fill="white"], [fill^="#fff"]) {
  fill: var(--background-color);
}
</style>

</head>
<body class="xml2rfc">
<table class="ears">
<thead><tr>
<td class="left">Internet-Draft</td>
<td class="center">Use of HPKE in JWE</td>
<td class="right">November 2025</td>
</tr></thead>
<tfoot><tr>
<td class="left">Reddy, et al.</td>
<td class="center">Expires 1 June 2026</td>
<td class="right">[Page]</td>
</tr></tfoot>
</table>
<div id="external-metadata" class="document-information"></div>
<div id="internal-metadata" class="document-information">
<dl id="identifiers">
<dt class="label-workgroup">Workgroup:</dt>
<dd class="workgroup">JOSE</dd>
<dt class="label-internet-draft">Internet-Draft:</dt>
<dd class="internet-draft">draft-ietf-jose-hpke-encrypt-latest</dd>
<dt class="label-updates">Updates:</dt>
<dd class="updates">
<a href="https://www.rfc-editor.org/rfc/rfc7516" class="eref">7516</a> (if approved)</dd>
<dt class="label-published">Published:</dt>
<dd class="published">
<time datetime="2025-11-28" class="published">28 November 2025</time>
    </dd>
<dt class="label-intended-status">Intended Status:</dt>
<dd class="intended-status">Standards Track</dd>
<dt class="label-expires">Expires:</dt>
<dd class="expires"><time datetime="2026-06-01">1 June 2026</time></dd>
<dt class="label-authors">Authors:</dt>
<dd class="authors">
<div class="author">
      <div class="author-name">T. Reddy</div>
<div class="org">Nokia</div>
</div>
<div class="author">
      <div class="author-name">H. Tschofenig</div>
<div class="org">H-BRS</div>
</div>
<div class="author">
      <div class="author-name">A. Banerjee</div>
<div class="org">Nokia</div>
</div>
<div class="author">
      <div class="author-name">O. Steele</div>
<div class="org">Tradeverifyd</div>
</div>
<div class="author">
      <div class="author-name">M. Jones</div>
<div class="org">Self-Issued Consulting</div>
</div>
</dd>
</dl>
</div>
<h1 id="title">Use of Hybrid Public Key Encryption (HPKE) with JSON Web Encryption (JWE)</h1>
<section id="section-abstract">
      <h2 id="abstract"><a href="#abstract" class="selfRef">Abstract</a></h2>
<p id="section-abstract-1">This specification defines how to use Hybrid Public Key Encryption (HPKE) with
JSON Web Encryption (JWE).
HPKE enables public key encryption
of arbitrary-sized plaintexts to a recipient's public key, and provides security
against adaptive chosen ciphertext attacks.
This specification chooses a specific subset of the HPKE features to use with JWE.<a href="#section-abstract-1" class="pilcrow">¶</a></p>
<p id="section-abstract-2">This specification updates RFC 7516 (JWE) to enable use of
the Integrated Encryption Key Establishment Mode.<a href="#section-abstract-2" class="pilcrow">¶</a></p>
</section>
<section class="note rfcEditorRemove" id="section-note.1">
      <h2 id="name-about-this-document">
<a href="#name-about-this-document" class="section-name selfRef">About This Document</a>
      </h2>
<p id="section-note.1-1">This note is to be removed before publishing as an RFC.<a href="#section-note.1-1" class="pilcrow">¶</a></p>
<p id="section-note.1-2">
        The latest revision of this draft can be found at <span><a href="https://ietf-wg-jose.github.io/draft-ietf-jose-hpke-encrypt/draft-ietf-jose-hpke-encrypt.html">https://ietf-wg-jose.github.io/draft-ietf-jose-hpke-encrypt/draft-ietf-jose-hpke-encrypt.html</a></span>.
        Status information for this document may be found at <span><a href="https://datatracker.ietf.org/doc/draft-ietf-jose-hpke-encrypt/">https://datatracker.ietf.org/doc/draft-ietf-jose-hpke-encrypt/</a></span>.<a href="#section-note.1-2" class="pilcrow">¶</a></p>
<p id="section-note.1-3">
        Discussion of this document takes place on the
        jose Working Group mailing list (<span><a href="mailto:jose@ietf.org">mailto:jose@ietf.org</a></span>),
        which is archived at <span><a href="https://mailarchive.ietf.org/arch/browse/jose/">https://mailarchive.ietf.org/arch/browse/jose/</a></span>.
        Subscribe at <span><a href="https://www.ietf.org/mailman/listinfo/jose/">https://www.ietf.org/mailman/listinfo/jose/</a></span>.<a href="#section-note.1-3" class="pilcrow">¶</a></p>
<p id="section-note.1-4">Source for this draft and an issue tracker can be found at
        <span><a href="https://github.com/ietf-wg-jose/draft-ietf-jose-hpke-encrypt">https://github.com/ietf-wg-jose/draft-ietf-jose-hpke-encrypt</a></span>.<a href="#section-note.1-4" class="pilcrow">¶</a></p>
</section>
<div id="status-of-memo">
<section id="section-boilerplate.1">
        <h2 id="name-status-of-this-memo">
<a href="#name-status-of-this-memo" class="section-name selfRef">Status of This Memo</a>
        </h2>
<p id="section-boilerplate.1-1">
        This Internet-Draft is submitted in full conformance with the
        provisions of BCP 78 and BCP 79.<a href="#section-boilerplate.1-1" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-2">
        Internet-Drafts are working documents of the Internet Engineering Task
        Force (IETF). Note that other groups may also distribute working
        documents as Internet-Drafts. The list of current Internet-Drafts is
        at <span><a href="https://datatracker.ietf.org/drafts/current/">https://datatracker.ietf.org/drafts/current/</a></span>.<a href="#section-boilerplate.1-2" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-3">
        Internet-Drafts are draft documents valid for a maximum of six months
        and may be updated, replaced, or obsoleted by other documents at any
        time. It is inappropriate to use Internet-Drafts as reference
        material or to cite them other than as "work in progress."<a href="#section-boilerplate.1-3" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-4">
        This Internet-Draft will expire on 1 June 2026.<a href="#section-boilerplate.1-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="copyright">
<section id="section-boilerplate.2">
        <h2 id="name-copyright-notice">
<a href="#name-copyright-notice" class="section-name selfRef">Copyright Notice</a>
        </h2>
<p id="section-boilerplate.2-1">
            Copyright (c) 2025 IETF Trust and the persons identified as the
            document authors. All rights reserved.<a href="#section-boilerplate.2-1" class="pilcrow">¶</a></p>
<p id="section-boilerplate.2-2">
            This document is subject to BCP 78 and the IETF Trust's Legal
            Provisions Relating to IETF Documents
            (<span><a href="https://trustee.ietf.org/license-info">https://trustee.ietf.org/license-info</a></span>) in effect on the date of
            publication of this document. Please review these documents
            carefully, as they describe your rights and restrictions with
            respect to this document. Code Components extracted from this
            document must include Revised BSD License text as described in
            Section 4.e of the Trust Legal Provisions and are provided without
            warranty as described in the Revised BSD License.<a href="#section-boilerplate.2-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="toc">
<section id="section-toc.1">
        <a href="#" onclick="scroll(0,0)" class="toplink">▲</a><h2 id="name-table-of-contents">
<a href="#name-table-of-contents" class="section-name selfRef">Table of Contents</a>
        </h2>
<nav class="toc"><ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1">
            <p id="section-toc.1-1.1.1" class="keepWithNext"><a href="#section-1" class="auto internal xref">1</a>.  <a href="#name-introduction" class="internal xref">Introduction</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2">
            <p id="section-toc.1-1.2.1" class="keepWithNext"><a href="#section-2" class="auto internal xref">2</a>.  <a href="#name-notational-conventions" class="internal xref">Notational Conventions</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3">
            <p id="section-toc.1-1.3.1" class="keepWithNext"><a href="#section-3" class="auto internal xref">3</a>.  <a href="#name-terminology" class="internal xref">Terminology</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4">
            <p id="section-toc.1-1.4.1"><a href="#section-4" class="auto internal xref">4</a>.  <a href="#name-overview" class="internal xref">Overview</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.1">
                <p id="section-toc.1-1.4.2.1.1"><a href="#section-4.1" class="auto internal xref">4.1</a>.  <a href="#name-auxiliary-authenticated-app" class="internal xref">Auxiliary Authenticated Application Information</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.2">
                <p id="section-toc.1-1.4.2.2.1"><a href="#section-4.2" class="auto internal xref">4.2</a>.  <a href="#name-encapsulated-secrets" class="internal xref">Encapsulated Secrets</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5">
            <p id="section-toc.1-1.5.1"><a href="#section-5" class="auto internal xref">5</a>.  <a href="#name-integrated-encryption" class="internal xref">Integrated Encryption</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.1">
                <p id="section-toc.1-1.5.2.1.1"><a href="#section-5.1" class="auto internal xref">5.1</a>.  <a href="#name-integrated-encryption-algor" class="internal xref">Integrated Encryption Algorithms using HPKE</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.2">
                <p id="section-toc.1-1.5.2.2.1"><a href="#section-5.2" class="auto internal xref">5.2</a>.  <a href="#name-jwe-compact-serialization-e" class="internal xref">JWE Compact Serialization Example</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.3">
                <p id="section-toc.1-1.5.2.3.1"><a href="#section-5.3" class="auto internal xref">5.3</a>.  <a href="#name-flattened-jwe-json-serializ" class="internal xref">Flattened JWE JSON Serialization Example</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6">
            <p id="section-toc.1-1.6.1"><a href="#section-6" class="auto internal xref">6</a>.  <a href="#name-key-encryption" class="internal xref">Key Encryption</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.1">
                <p id="section-toc.1-1.6.2.1.1"><a href="#section-6.1" class="auto internal xref">6.1</a>.  <a href="#name-recipient_structure" class="internal xref">Recipient_structure</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.2">
                <p id="section-toc.1-1.6.2.2.1"><a href="#section-6.2" class="auto internal xref">6.2</a>.  <a href="#name-key-encryption-algorithms-u" class="internal xref">Key Encryption Algorithms using HPKE</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.2.2.1">
                    <p id="section-toc.1-1.6.2.2.2.1.1"><a href="#section-6.2.1" class="auto internal xref">6.2.1</a>.  <a href="#name-recipient_structure-example" class="internal xref">Recipient_structure Example</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.3">
                <p id="section-toc.1-1.6.2.3.1"><a href="#section-6.3" class="auto internal xref">6.3</a>.  <a href="#name-general-jwe-json-serializat" class="internal xref">General JWE JSON Serialization Example</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7">
            <p id="section-toc.1-1.7.1"><a href="#section-7" class="auto internal xref">7</a>.  <a href="#name-producing-and-consuming-jwe" class="internal xref">Producing and Consuming JWEs</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.1">
                <p id="section-toc.1-1.7.2.1.1"><a href="#section-7.1" class="auto internal xref">7.1</a>.  <a href="#name-message-encryption" class="internal xref">Message Encryption</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.2">
                <p id="section-toc.1-1.7.2.2.1"><a href="#section-7.2" class="auto internal xref">7.2</a>.  <a href="#name-message-decryption" class="internal xref">Message Decryption</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8">
            <p id="section-toc.1-1.8.1"><a href="#section-8" class="auto internal xref">8</a>.  <a href="#name-distinguishing-between-jws-" class="internal xref">Distinguishing between JWS and JWE Objects</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9">
            <p id="section-toc.1-1.9.1"><a href="#section-9" class="auto internal xref">9</a>.  <a href="#name-jwk-representations-for-jwe" class="internal xref">JWK Representations for JWE HPKE Keys</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9.2.1">
                <p id="section-toc.1-1.9.2.1.1"><a href="#section-9.1" class="auto internal xref">9.1</a>.  <a href="#name-jwk-representation-of-key-u" class="internal xref">JWK Representation of Key using JWE HPKE Ciphersuite</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10">
            <p id="section-toc.1-1.10.1"><a href="#section-10" class="auto internal xref">10</a>. <a href="#name-security-considerations" class="internal xref">Security Considerations</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10.2.1">
                <p id="section-toc.1-1.10.2.1.1"><a href="#section-10.1" class="auto internal xref">10.1</a>.  <a href="#name-key-management" class="internal xref">Key Management</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10.2.2">
                <p id="section-toc.1-1.10.2.2.1"><a href="#section-10.2" class="auto internal xref">10.2</a>.  <a href="#name-jwt-best-current-practices" class="internal xref">JWT Best Current Practices</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11">
            <p id="section-toc.1-1.11.1"><a href="#section-11" class="auto internal xref">11</a>. <a href="#name-iana-considerations" class="internal xref">IANA Considerations</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11.2.1">
                <p id="section-toc.1-1.11.2.1.1"><a href="#section-11.1" class="auto internal xref">11.1</a>.  <a href="#name-json-web-signature-and-encr" class="internal xref">JSON Web Signature and Encryption Algorithms</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11.2.1.2.1">
                    <p id="section-toc.1-1.11.2.1.2.1.1"><a href="#section-11.1.1" class="auto internal xref">11.1.1</a>.  <a href="#name-hpke-0" class="internal xref">HPKE-0</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11.2.1.2.2">
                    <p id="section-toc.1-1.11.2.1.2.2.1"><a href="#section-11.1.2" class="auto internal xref">11.1.2</a>.  <a href="#name-hpke-1" class="internal xref">HPKE-1</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11.2.1.2.3">
                    <p id="section-toc.1-1.11.2.1.2.3.1"><a href="#section-11.1.3" class="auto internal xref">11.1.3</a>.  <a href="#name-hpke-2" class="internal xref">HPKE-2</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11.2.1.2.4">
                    <p id="section-toc.1-1.11.2.1.2.4.1"><a href="#section-11.1.4" class="auto internal xref">11.1.4</a>.  <a href="#name-hpke-3" class="internal xref">HPKE-3</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11.2.1.2.5">
                    <p id="section-toc.1-1.11.2.1.2.5.1"><a href="#section-11.1.5" class="auto internal xref">11.1.5</a>.  <a href="#name-hpke-4" class="internal xref">HPKE-4</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11.2.1.2.6">
                    <p id="section-toc.1-1.11.2.1.2.6.1"><a href="#section-11.1.6" class="auto internal xref">11.1.6</a>.  <a href="#name-hpke-5" class="internal xref">HPKE-5</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11.2.1.2.7">
                    <p id="section-toc.1-1.11.2.1.2.7.1"><a href="#section-11.1.7" class="auto internal xref">11.1.7</a>.  <a href="#name-hpke-6" class="internal xref">HPKE-6</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11.2.1.2.8">
                    <p id="section-toc.1-1.11.2.1.2.8.1"><a href="#section-11.1.8" class="auto internal xref">11.1.8</a>.  <a href="#name-hpke-7" class="internal xref">HPKE-7</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11.2.1.2.9">
                    <p id="section-toc.1-1.11.2.1.2.9.1"><a href="#section-11.1.9" class="auto internal xref">11.1.9</a>.  <a href="#name-hpke-0-ke" class="internal xref">HPKE-0-KE</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11.2.1.2.10">
                    <p id="section-toc.1-1.11.2.1.2.10.1"><a href="#section-11.1.10" class="auto internal xref">11.1.10</a>. <a href="#name-hpke-1-ke" class="internal xref">HPKE-1-KE</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11.2.1.2.11">
                    <p id="section-toc.1-1.11.2.1.2.11.1"><a href="#section-11.1.11" class="auto internal xref">11.1.11</a>. <a href="#name-hpke-2-ke" class="internal xref">HPKE-2-KE</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11.2.1.2.12">
                    <p id="section-toc.1-1.11.2.1.2.12.1"><a href="#section-11.1.12" class="auto internal xref">11.1.12</a>. <a href="#name-hpke-3-ke" class="internal xref">HPKE-3-KE</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11.2.1.2.13">
                    <p id="section-toc.1-1.11.2.1.2.13.1"><a href="#section-11.1.13" class="auto internal xref">11.1.13</a>. <a href="#name-hpke-4-ke" class="internal xref">HPKE-4-KE</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11.2.1.2.14">
                    <p id="section-toc.1-1.11.2.1.2.14.1"><a href="#section-11.1.14" class="auto internal xref">11.1.14</a>. <a href="#name-hpke-5-ke" class="internal xref">HPKE-5-KE</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11.2.1.2.15">
                    <p id="section-toc.1-1.11.2.1.2.15.1"><a href="#section-11.1.15" class="auto internal xref">11.1.15</a>. <a href="#name-hpke-6-ke" class="internal xref">HPKE-6-KE</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11.2.1.2.16">
                    <p id="section-toc.1-1.11.2.1.2.16.1"><a href="#section-11.1.16" class="auto internal xref">11.1.16</a>. <a href="#name-hpke-7-ke" class="internal xref">HPKE-7-KE</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11.2.2">
                <p id="section-toc.1-1.11.2.2.1"><a href="#section-11.2" class="auto internal xref">11.2</a>.  <a href="#name-json-web-signature-and-encry" class="internal xref">JSON Web Signature and Encryption Header Parameters</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11.2.2.2.1">
                    <p id="section-toc.1-1.11.2.2.2.1.1"><a href="#section-11.2.1" class="auto internal xref">11.2.1</a>.  <a href="#name-ek" class="internal xref">ek</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11.2.2.2.2">
                    <p id="section-toc.1-1.11.2.2.2.2.1"><a href="#section-11.2.2" class="auto internal xref">11.2.2</a>.  <a href="#name-psk_id" class="internal xref">psk_id</a></p>
</li>
                </ul>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.12">
            <p id="section-toc.1-1.12.1"><a href="#section-12" class="auto internal xref">12</a>. <a href="#name-references" class="internal xref">References</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.12.2.1">
                <p id="section-toc.1-1.12.2.1.1"><a href="#section-12.1" class="auto internal xref">12.1</a>.  <a href="#name-normative-references" class="internal xref">Normative References</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.12.2.2">
                <p id="section-toc.1-1.12.2.2.1"><a href="#section-12.2" class="auto internal xref">12.2</a>.  <a href="#name-informative-references" class="internal xref">Informative References</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.13">
            <p id="section-toc.1-1.13.1"><a href="#appendix-A" class="auto internal xref">Appendix A</a>.  <a href="#name-keys-used-in-examples" class="internal xref">Keys Used in Examples</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.13.2.1">
                <p id="section-toc.1-1.13.2.1.1"><a href="#appendix-A.1" class="auto internal xref">A.1</a>.  <a href="#name-integrated-encryption-key" class="internal xref">Integrated Encryption Key</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.13.2.2">
                <p id="section-toc.1-1.13.2.2.1"><a href="#appendix-A.2" class="auto internal xref">A.2</a>.  <a href="#name-key-encryption-key" class="internal xref">Key Encryption Key</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.14">
            <p id="section-toc.1-1.14.1"><a href="#appendix-B" class="auto internal xref"></a><a href="#name-acknowledgments" class="internal xref">Acknowledgments</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.15">
            <p id="section-toc.1-1.15.1"><a href="#appendix-C" class="auto internal xref"></a><a href="#name-document-history" class="internal xref">Document History</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.16">
            <p id="section-toc.1-1.16.1"><a href="#appendix-D" class="auto internal xref"></a><a href="#name-authors-addresses" class="internal xref">Authors' Addresses</a></p>
</li>
        </ul>
</nav>
</section>
</div>
<div id="introduction">
<section id="section-1">
      <h2 id="name-introduction">
<a href="#section-1" class="section-number selfRef">1. </a><a href="#name-introduction" class="section-name selfRef">Introduction</a>
      </h2>
<p id="section-1-1">Hybrid Public Key Encryption (HPKE) <span>[<a href="#I-D.ietf-hpke-hpke" class="cite xref">I-D.ietf-hpke-hpke</a>]</span> is a public key encryption
(PKE) scheme that provides encryption of arbitrary-sized plaintexts to a
recipient's public key.
This specification enables JSON Web Encryption (JWE) <span>[<a href="#RFC7516" class="cite xref">RFC7516</a>]</span> to leverage HPKE,
bringing support for HPKE encryption and KEMs to JWE,
and the possibility of utilizing future HPKE algorithms.<a href="#section-1-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="notational-conventions">
<section id="section-2">
      <h2 id="name-notational-conventions">
<a href="#section-2" class="section-number selfRef">2. </a><a href="#name-notational-conventions" class="section-name selfRef">Notational Conventions</a>
      </h2>
<p id="section-2-1">The key words "<span class="bcp14">MUST</span>", "<span class="bcp14">MUST NOT</span>", "<span class="bcp14">REQUIRED</span>", "<span class="bcp14">SHALL</span>", "<span class="bcp14">SHALL NOT</span>", "<span class="bcp14">SHOULD</span>", "<span class="bcp14">SHOULD NOT</span>", "<span class="bcp14">RECOMMENDED</span>", "<span class="bcp14">NOT RECOMMENDED</span>",
"<span class="bcp14">MAY</span>", and "<span class="bcp14">OPTIONAL</span>" in this document are to be interpreted as
described in BCP 14 <span>[<a href="#RFC2119" class="cite xref">RFC2119</a>]</span> <span>[<a href="#RFC8174" class="cite xref">RFC8174</a>]</span> when, and only when, they
appear in all capitals, as shown here.<a href="#section-2-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="terminology">
<section id="section-3">
      <h2 id="name-terminology">
<a href="#section-3" class="section-number selfRef">3. </a><a href="#name-terminology" class="section-name selfRef">Terminology</a>
      </h2>
<p id="section-3-1">This specification uses the following abbreviations and terms:<a href="#section-3-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3-2.1">
          <p id="section-3-2.1.1">Content Encryption Key (CEK), Header Parameter, and JOSE Header,
as defined in <span>[<a href="#RFC7516" class="cite xref">RFC7516</a>]</span>.<a href="#section-3-2.1.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-3-2.2">
          <p id="section-3-2.2.1">Hybrid Public Key Encryption (HPKE), as defined in <span>[<a href="#I-D.ietf-hpke-hpke" class="cite xref">I-D.ietf-hpke-hpke</a>]</span>.<a href="#section-3-2.2.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-3-2.3">
          <p id="section-3-2.3.1">pkR is the public key of the recipient, as defined in <span>[<a href="#I-D.ietf-hpke-hpke" class="cite xref">I-D.ietf-hpke-hpke</a>]</span>.<a href="#section-3-2.3.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-3-2.4">
          <p id="section-3-2.4.1">skR is the private key of the recipient, as defined in <span>[<a href="#I-D.ietf-hpke-hpke" class="cite xref">I-D.ietf-hpke-hpke</a>]</span>.<a href="#section-3-2.4.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-3-2.5">
          <p id="section-3-2.5.1">Key Encapsulation Mechanism (KEM), per <span>[<a href="#I-D.ietf-hpke-hpke" class="cite xref">I-D.ietf-hpke-hpke</a>]</span>.<a href="#section-3-2.5.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-3-2.6">
          <p id="section-3-2.6.1">Key Derivation Function (KDF), per <span>[<a href="#I-D.ietf-hpke-hpke" class="cite xref">I-D.ietf-hpke-hpke</a>]</span>.<a href="#section-3-2.6.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-3-2.7">
          <p id="section-3-2.7.1">Authenticated Encryption with Associated Data (AEAD); see <span>[<a href="#I-D.ietf-hpke-hpke" class="cite xref">I-D.ietf-hpke-hpke</a>]</span> and <span>[<a href="#RFC7516" class="cite xref">RFC7516</a>]</span>.<a href="#section-3-2.7.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-3-2.8">
          <p id="section-3-2.8.1">Additional Authenticated Data (AAD); see <span>[<a href="#I-D.ietf-hpke-hpke" class="cite xref">I-D.ietf-hpke-hpke</a>]</span> and <span>[<a href="#RFC7516" class="cite xref">RFC7516</a>]</span>.<a href="#section-3-2.8.1" class="pilcrow">¶</a></p>
</li>
      </ul>
<p id="section-3-3">This specification defines the following terms:<a href="#section-3-3" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-3-4">
        <dt id="section-3-4.1">Key Management Mode</dt>
        <dd style="margin-left: 1.5em" id="section-3-4.2">
          <p id="section-3-4.2.1">A method of determining whether a Content Encryption Key (CEK) value is used
and, if so, what CEK value to use.
Each method used for making these determinations uses a
specific Key Management Mode.
Key Management Modes employed by this specification are
Key Encryption,
Key Wrapping,
Direct Key Agreement,
Key Agreement with Key Wrapping,
Direct Encryption,
and
Integrated Encryption.<a href="#section-3-4.2.1" class="pilcrow">¶</a></p>
</dd>
        <dd class="break"></dd>
<dt id="section-3-4.3">Integrated Encryption</dt>
        <dd style="margin-left: 1.5em" id="section-3-4.4">
          <p id="section-3-4.4.1">A Key Management Mode in which the plaintext is directly encrypted
without the use of a Content Encryption Key (CEK).<a href="#section-3-4.4.1" class="pilcrow">¶</a></p>
</dd>
      <dd class="break"></dd>
</dl>
<p id="section-3-5">The definition of Key Management Mode above replaces the one in JWE <span>[<a href="#RFC7516" class="cite xref">RFC7516</a>]</span>.<a href="#section-3-5" class="pilcrow">¶</a></p>
</section>
</div>
<div id="overview">
<section id="section-4">
      <h2 id="name-overview">
<a href="#section-4" class="section-number selfRef">4. </a><a href="#name-overview" class="section-name selfRef">Overview</a>
      </h2>
<p id="section-4-1">This specification defines how to use HPKE in JWE in two Key Management Modes:<a href="#section-4-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4-2.1">
          <p id="section-4-2.1.1">Key Encryption, and<a href="#section-4-2.1.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-4-2.2">
          <p id="section-4-2.2.1">Integrated Encryption.<a href="#section-4-2.2.1" class="pilcrow">¶</a></p>
</li>
      </ul>
<p id="section-4-3">It defines the Integrated Encryption Key Management Mode.
It also defines JWE algorithm identifiers for using HPKE
with those two Key Management Modes.
Distinct JWE algorithms are used with Key Encryption and Integrated Encryption,
which is required for them to be fully-specified <span>[<a href="#RFC9864" class="cite xref">RFC9864</a>]</span>.<a href="#section-4-3" class="pilcrow">¶</a></p>
<p id="section-4-4">When the Key Management Mode is Integrated Encryption,
HPKE is used to directly encrypt the plaintext.
In this mode, the "enc" header parameter <span class="bcp14">MUST NOT</span> be present.
This specification updates the use of the "enc" header parameter,
which is defined in <span><a href="https://rfc-editor.org/rfc/rfc7516#section-4.1.2" class="relref">Section 4.1.2</a> of [<a href="#RFC7516" class="cite xref">RFC7516</a>]</span>,
to require it <span class="bcp14">MUST NOT</span> be present when Integrated Encryption is used.<a href="#section-4-4" class="pilcrow">¶</a></p>
<p id="section-4-5">When the Key Management Mode is Key Encryption,
HPKE is used to encrypt the Content Encryption Key (CEK).
In this mode, the "enc" header parameter is used as specified in JWE <span>[<a href="#RFC7516" class="cite xref">RFC7516</a>]</span>.
The HPKE AEAD encryption function used internally by HPKE
is distinct from the JWE AEAD algorithm specified in "enc".<a href="#section-4-5" class="pilcrow">¶</a></p>
<p id="section-4-6">In both Key Management Modes,
the HPKE key encapsulation mechanism (KEM), key derivation function (KDF),
and authenticated encryption with additional data (AEAD) encryption function
utilized depend on the JWE algorithm used.<a href="#section-4-6" class="pilcrow">¶</a></p>
<p id="section-4-7">HPKE supports two modes, which are described in Table 1 of <span>[<a href="#I-D.ietf-hpke-hpke" class="cite xref">I-D.ietf-hpke-hpke</a>]</span>.
In this specification, both "mode_base" and "mode_psk" are supported
for both Key Management Modes.
When the "psk_id" header parameter is present, the HPKE mode is "mode_psk";
otherwise, the HPKE mode is "mode_base".<a href="#section-4-7" class="pilcrow">¶</a></p>
<p id="section-4-8">JWE supports two kinds of serializations:<a href="#section-4-8" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4-9.1">
          <p id="section-4-9.1.1">the JWE Compact Serialization described in <span><a href="https://rfc-editor.org/rfc/rfc7516#section-3.1" class="relref">Section 3.1</a> of [<a href="#RFC7516" class="cite xref">RFC7516</a>]</span>, and<a href="#section-4-9.1.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-4-9.2">
          <p id="section-4-9.2.1">the JWE JSON Serialization described in <span><a href="https://rfc-editor.org/rfc/rfc7516#section-3.2" class="relref">Section 3.2</a> of [<a href="#RFC7516" class="cite xref">RFC7516</a>]</span>.<a href="#section-4-9.2.1" class="pilcrow">¶</a></p>
</li>
      </ul>
<p id="section-4-10">Certain JWE features are only supported in specific serializations.
For example, the JWE Compact Serialization does not support:<a href="#section-4-10" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4-11.1">
          <p id="section-4-11.1.1">the additional authenticated data header parameter "aad",<a href="#section-4-11.1.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-4-11.2">
          <p id="section-4-11.2.1">multiple recipients, and<a href="#section-4-11.2.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-4-11.3">
          <p id="section-4-11.3.1">unprotected header parameters.<a href="#section-4-11.3.1" class="pilcrow">¶</a></p>
</li>
      </ul>
<p id="section-4-12">Key Encryption can be used with the "aad" header parameter
when using the JWE JSON Serialization.
Single recipient Key Encryption with no "aad" header parameter can be expressed
in the JWE Compact Serialization.<a href="#section-4-12" class="pilcrow">¶</a></p>
<div id="auxiliary-authenticated-application-information">
<section id="section-4.1">
        <h3 id="name-auxiliary-authenticated-app">
<a href="#section-4.1" class="section-number selfRef">4.1. </a><a href="#name-auxiliary-authenticated-app" class="section-name selfRef">Auxiliary Authenticated Application Information</a>
        </h3>
<p id="section-4.1-1">The HPKE "aad parameter" for Open() and Seal()
specified in <span><a href="https://datatracker.ietf.org/doc/html/draft-ietf-hpke-hpke-02#section-8.1" class="relref">Section 8.1</a> of [<a href="#I-D.ietf-hpke-hpke" class="cite xref">I-D.ietf-hpke-hpke</a>]</span>
is used with both Integrated Encryption and Key Encryption.
Its value is the Additional Authenticated Data encryption parameter value
specified in Step 15 of <a href="#encryption" class="auto internal xref">Section 7.1</a>.<a href="#section-4.1-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="encapsulated-secrets">
<section id="section-4.2">
        <h3 id="name-encapsulated-secrets">
<a href="#section-4.2" class="section-number selfRef">4.2. </a><a href="#name-encapsulated-secrets" class="section-name selfRef">Encapsulated Secrets</a>
        </h3>
<p id="section-4.2-1">HPKE encapsulated secret is defined in <span><a href="https://datatracker.ietf.org/doc/html/draft-ietf-hpke-hpke-02#section-5" class="relref">Section 5</a> of [<a href="#I-D.ietf-hpke-hpke" class="cite xref">I-D.ietf-hpke-hpke</a>]</span>.<a href="#section-4.2-1" class="pilcrow">¶</a></p>
<p id="section-4.2-2">When using Integrated Encryption, the JWE Encrypted Key of the sole recipient
is the HPKE encapsulated secret.<a href="#section-4.2-2" class="pilcrow">¶</a></p>
<p id="section-4.2-3">When using Key Encryption, each recipient's JWE Encrypted Key
is the encrypted content encryption key, and the value of header parameter "ek"
is the base64url encoding of the HPKE encapsulated secret.<a href="#section-4.2-3" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="integrated-encryption">
<section id="section-5">
      <h2 id="name-integrated-encryption">
<a href="#section-5" class="section-number selfRef">5. </a><a href="#name-integrated-encryption" class="section-name selfRef">Integrated Encryption</a>
      </h2>
<p id="section-5-1">When using Integrated Encryption with HPKE:<a href="#section-5-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-5-2.1">
          <p id="section-5-2.1.1">The protected header <span class="bcp14">MUST</span> contain an "alg" value that is
an HPKE JWE algorithm using Integrated Encryption.<a href="#section-5-2.1.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-5-2.2">
          <p id="section-5-2.2.1">The "enc" header parameter <span class="bcp14">MUST NOT</span> be present.
This is because no separate content encryption algorithm is used in this mode.<a href="#section-5-2.2.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-5-2.3">
          <p id="section-5-2.3.1">The protected header parameter "psk_id" <span class="bcp14">MAY</span> be present.<a href="#section-5-2.3.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-5-2.4">
          <p id="section-5-2.4.1">The protected header parameter "ek" <span class="bcp14">MUST NOT</span> be present.<a href="#section-5-2.4.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-5-2.5">
          <p id="section-5-2.5.1">There <span class="bcp14">MUST</span> be exactly one recipient.<a href="#section-5-2.5.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-5-2.6">
          <p id="section-5-2.6.1">The JWE Encrypted Key <span class="bcp14">MUST</span> be the encapsulated secret, as defined in <span><a href="https://datatracker.ietf.org/doc/html/draft-ietf-hpke-hpke-02#section-5" class="relref">Section 5</a> of [<a href="#I-D.ietf-hpke-hpke" class="cite xref">I-D.ietf-hpke-hpke</a>]</span>.<a href="#section-5-2.6.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-5-2.7">
          <p id="section-5-2.7.1">The JWE Initialization Vector and JWE Authentication Tag <span class="bcp14">MUST</span> be the empty octet sequence.<a href="#section-5-2.7.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-5-2.8">
          <p id="section-5-2.8.1">The JWE AAD <span class="bcp14">MAY</span> be present when using the JWE JSON Serialization.<a href="#section-5-2.8.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-5-2.9">
          <p id="section-5-2.9.1">The HPKE aad parameter <span class="bcp14">MUST</span> be set to the "Additional Authenticated Data encryption parameter" value specified in Step 15 of <a href="#encryption" class="auto internal xref">Section 7.1</a>.<a href="#section-5-2.9.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-5-2.10">
          <p id="section-5-2.10.1">The HPKE info parameter defaults to the empty octet sequence;
mutually known private information (a concept also utilized in <span>[<a href="#NIST.SP.800-56Ar3" class="cite xref">NIST.SP.800-56Ar3</a>]</span>)
<span class="bcp14">MAY</span> be used instead so the application can include it during key derivation.<a href="#section-5-2.10.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-5-2.11">
          <p id="section-5-2.11.1">The JWE Ciphertext is the ciphertext from the HPKE encryption,
as defined in <span><a href="https://datatracker.ietf.org/doc/html/draft-ietf-hpke-hpke-02#section-5.2" class="relref">Section 5.2</a> of [<a href="#I-D.ietf-hpke-hpke" class="cite xref">I-D.ietf-hpke-hpke</a>]</span>.<a href="#section-5-2.11.1" class="pilcrow">¶</a></p>
</li>
      </ul>
<div id="int-algs">
<section id="section-5.1">
        <h3 id="name-integrated-encryption-algor">
<a href="#section-5.1" class="section-number selfRef">5.1. </a><a href="#name-integrated-encryption-algor" class="section-name selfRef">Integrated Encryption Algorithms using HPKE</a>
        </h3>
<p id="section-5.1-1">The following JWE algorithms using HPKE are defined for use with
the Integrated Encryption Key Establishment Mode:<a href="#section-5.1-1" class="pilcrow">¶</a></p>
<span id="name-algorithms-using-hpke-for-i"></span><div id="ciphersuite-int-algs">
<figure id="figure-1">
          <div class="alignLeft art-text artwork" id="section-5.1-2.1">
<pre>
+--------+----------------------------+-------------+------------------+
| "alg"  | HPKE KEM                   | HPKE KDF    | HPKE AEAD        |
+--------+----------------------------+-------------+------------------+
| HPKE-0 | DHKEM(P-256, HKDF-SHA256)  | HKDF-SHA256 | AES-128-GCM      |
| HPKE-1 | DHKEM(P-384, HKDF-SHA384)  | HKDF-SHA384 | AES-256-GCM      |
| HPKE-2 | DHKEM(P-521, HKDF-SHA512)  | HKDF-SHA512 | AES-256-GCM      |
| HPKE-3 | DHKEM(X25519, HKDF-SHA256) | HKDF-SHA256 | AES-128-GCM      |
| HPKE-4 | DHKEM(X25519, HKDF-SHA256) | HKDF-SHA256 | ChaCha20Poly1305 |
| HPKE-5 | DHKEM(X448, HKDF-SHA512)   | HKDF-SHA512 | AES-256-GCM      |
| HPKE-6 | DHKEM(X448, HKDF-SHA512)   | HKDF-SHA512 | ChaCha20Poly1305 |
| HPKE-7 | DHKEM(P-256, HKDF-SHA256)  | HKDF-SHA256 | AES-256-GCM      |
+--------+----------------------------+-------------+------------------+
</pre>
</div>
<figcaption><a href="#figure-1" class="selfRef">Figure 1</a>:
<a href="#name-algorithms-using-hpke-for-i" class="selfRef">Algorithms using HPKE for Integrated Encryption</a>
          </figcaption></figure>
</div>
<p id="section-5.1-3">The HPKE KEM, KDF, and AEAD values are chosen from the IANA HPKE registry <span>[<a href="#IANA.HPKE" class="cite xref">IANA.HPKE</a>]</span>.<a href="#section-5.1-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="compact-example">
<section id="section-5.2">
        <h3 id="name-jwe-compact-serialization-e">
<a href="#section-5.2" class="section-number selfRef">5.2. </a><a href="#name-jwe-compact-serialization-e" class="section-name selfRef">JWE Compact Serialization Example</a>
        </h3>
<p id="section-5.2-1">Below is an example of a JWE using the Compact Serialization and Integrated Encryption with HPKE:<a href="#section-5.2-1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-5.2-2">
<pre>
eyJhbGciOiJIUEtFLTAiLCJraWQiOiJ5Q25mYm1ZTVpjV3JLRHRfRGpOZWJSQ0IxdnhWb3F2NHVtSjRXSzhSWWprIn0.BLAJX8adrFsDKaoJAc3iy2dq-6jEH3Uv-bSgqIoDeREqpWglMoTS67XsXere1ZYxiQKEFU6MbWe8O7vmdlSmcUk..NcN9ew5aijn8W7piLVRU8r2cOP0JKqxOF4RllVsJM4qsAfVXW5Ka6so9zdUmXXNOXyCEk0wV_s8ICAnD4LbRa5TkhTeuhijIfAt9bQ2fMLOeyed3WyArs8yaMraa9Zbh4i6SaHunM7jU_xoz_N2WbykSOSySmCO49H4mP3jLW9L_TYQfeVfYsrB8clqokZ8h-3eQGNwmOPtkjWdpAfaHUsp4-HC9nRd6yrTU6mV65Nn2iYynu3Xkgy2Lm-kQKDavIEW3PBpEeiw6mtPJE9o8sT-0lZ9kpWtqog2XbNGEfjSOjujvNe1b0g4-FdNFMFO_fo0rxe902W1pGT7znv4Q-xBkIydK4ZwjiFN6dAXutnococ37A0Hr5esPLwHRTTrBFw.
</pre><a href="#section-5.2-2" class="pilcrow">¶</a>
</div>
<p id="section-5.2-3">The key used for this example is in <a href="#int-key" class="auto internal xref">Appendix A.1</a>.<a href="#section-5.2-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="flattened-example">
<section id="section-5.3">
        <h3 id="name-flattened-jwe-json-serializ">
<a href="#section-5.3" class="section-number selfRef">5.3. </a><a href="#name-flattened-jwe-json-serializ" class="section-name selfRef">Flattened JWE JSON Serialization Example</a>
        </h3>
<p id="section-5.3-1">Below is an example of a JWE using the Flattened JSON Serialization and Integrated Encryption with HPKE:<a href="#section-5.3-1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-5.3-2">
<pre>
{
  "ciphertext": "LabI8_KIPDbymUSbyVctj8AfISXQ07sMt1xQ1lrS-0heU2jjejpQIK75K1KXcvwn15E6Kil_tJ6LBcYCu02O1H8_aooJGuoLw1vEzQn16h498YX9e2SA2IcVrJTkcCjL7YpF9fsAF3JEzGfsmmrpZPPVdxCn7g8dkGRcyulnHrNvBu4BFtub-URtf-nYCFIJHZ4k-ul9fDddquicFzCxQonx66-ZX5nbj6azHG65tAZntd6VFkRgihdxTvIpvTS4gfulQeKyShbiw-OCJNbzFdEnOKEMnsyqRjwG7iVrFEilFAMsvLJ14-lcuR5btIkUntIwlnsfUa2Ytk33znCfAFN0wYukdDvJe-V0nnNUFlOeLyYV0eEGisgC9dQQ1kFu3g",
  "encrypted_key": "BAOlZ-VnbhQu4NOlTlDAVYwUJB-Q6YcWwnRNWK6YLSiHHlW4rN0qUzBJ3Rc2_y8nkasn8nUVGBzdq7OhdKKiLq4",
  "aad": "VGhlIEZlbGxvd3NoaXAgb2YgdGhlIFJpbmc",
  "protected": "eyJhbGciOiJIUEtFLTAiLCJraWQiOiJ5Q25mYm1ZTVpjV3JLRHRfRGpOZWJSQ0IxdnhWb3F2NHVtSjRXSzhSWWprIn0"
}
</pre><a href="#section-5.3-2" class="pilcrow">¶</a>
</div>
<p id="section-5.3-3">The key used for this example is in <a href="#int-key" class="auto internal xref">Appendix A.1</a>.<a href="#section-5.3-3" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="key-encryption">
<section id="section-6">
      <h2 id="name-key-encryption">
<a href="#section-6" class="section-number selfRef">6. </a><a href="#name-key-encryption" class="section-name selfRef">Key Encryption</a>
      </h2>
<p id="section-6-1">When using the JWE JSON Serialization,
recipients using Key Encryption with HPKE can be added alongside other recipients
(e.g., those using <code>ECDH-ES+A128KW</code> or <code>RSA-OAEP-256</code>),
since HPKE is used to encrypt the Content Encryption Key (CEK).<a href="#section-6-1" class="pilcrow">¶</a></p>
<p id="section-6-2">When using Key Encryption with HPKE:<a href="#section-6-2" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-6-3.1">
          <p id="section-6-3.1.1">When all recipients use the same JWE algorithm to secure the Content Encryption Key, the JWE Protected Header <span class="bcp14">SHOULD</span> contain "alg".
Otherwise, the JWE Protected Header (and JWE Shared Unprotected Header) <span class="bcp14">MUST NOT</span> contain "alg".<a href="#section-6-3.1.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-6-3.2">
          <p id="section-6-3.2.1">The "alg" header parameter <span class="bcp14">MUST</span> be a HPKE JWE algorithm using Key Encryption.<a href="#section-6-3.2.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-6-3.3">
          <p id="section-6-3.3.1">The header parameter "psk_id" <span class="bcp14">MAY</span> be present.<a href="#section-6-3.3.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-6-3.4">
          <p id="section-6-3.4.1">The header parameter "ek" <span class="bcp14">MUST</span> be present and contain the base64url-encoded HPKE encapsulated secret.<a href="#section-6-3.4.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-6-3.5">
          <p id="section-6-3.5.1">The HPKE aad parameter defaults to the empty octet sequence.<a href="#section-6-3.5.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-6-3.6">
          <p id="section-6-3.6.1">The HPKE info parameter is set to the value of the Recipient_structure defined below.<a href="#section-6-3.6.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-6-3.7">
          <p id="section-6-3.7.1">THE HPKE plaintext <span class="bcp14">MUST</span> be set to the CEK.<a href="#section-6-3.7.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-6-3.8">
          <p id="section-6-3.8.1">The recipient's JWE Encrypted Key is the ciphertext from the HPKE Encryption,
as defined in <span><a href="https://datatracker.ietf.org/doc/html/draft-ietf-hpke-hpke-02#section-5.2" class="relref">Section 5.2</a> of [<a href="#I-D.ietf-hpke-hpke" class="cite xref">I-D.ietf-hpke-hpke</a>]</span>.<a href="#section-6-3.8.1" class="pilcrow">¶</a></p>
</li>
      </ul>
<div id="recipient_structure">
<section id="section-6.1">
        <h3 id="name-recipient_structure">
<a href="#section-6.1" class="section-number selfRef">6.1. </a><a href="#name-recipient_structure" class="section-name selfRef">Recipient_structure</a>
        </h3>
<p id="section-6.1-1">The <code>Recipient_structure</code> used as the value of the HPKE info parameter
when performing Key Encryption with HPKE
provides context information used in key derivation.
To ensure compactness and interoperability,
this structure is encoded in a binary format.
The encoding is as follows:<a href="#section-6.1-1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-6.1-2">
<pre>
Recipient_structure = ASCII("JOSE-HPKE rcpt") ||
                      BYTE(255) ||
                      ASCII(content_encryption_alg) ||
                      BYTE(255) ||
                      recipient_extra_info
</pre><a href="#section-6.1-2" class="pilcrow">¶</a>
</div>
<p id="section-6.1-3">Where:<a href="#section-6.1-3" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-6.1-4.1">
            <p id="section-6.1-4.1.1">ASCII("JOSE-HPKE rcpt"): A fixed ASCII string identifying the context of the structure.<a href="#section-6.1-4.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-6.1-4.2">
            <p id="section-6.1-4.2.1">BYTE(255): A separator byte (0xFF) used to delimit fields.<a href="#section-6.1-4.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-6.1-4.3">
            <p id="section-6.1-4.3.1">ASCII(content_encryption_alg): Identifies the content encryption algorithm
with which the HPKE-encrypted Content Encryption Key (CEK) is used.
Its value <span class="bcp14">MUST</span> be the "enc" (encryption algorithm) header parameter value
in the JOSE Header.
This field provides JWE context information to the HPKE key schedule,
which ensures that the encapsulated secret is bound to the selected content encryption algorithm.<a href="#section-6.1-4.3.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-6.1-4.4">
            <p id="section-6.1-4.4.1">BYTE(255): A separator byte (0xFF) used to delimit fields.<a href="#section-6.1-4.4.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-6.1-4.5">
            <p id="section-6.1-4.5.1">recipient_extra_info: An octet string containing additional context information
that the application includes in the key derivation.
Mutually known private information (a concept also utilized in <span>[<a href="#NIST.SP.800-56Ar3" class="cite xref">NIST.SP.800-56Ar3</a>]</span>) <span class="bcp14">MAY</span> be used in this input parameter.
If no additional context information is provided, this field <span class="bcp14">MUST</span> be the empty octet sequence.<a href="#section-6.1-4.5.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="section-6.1-5">Note that Integrated Encryption does not use the <code>Recipient_structure</code> because the JWE Protected Header and JWE AAD are included in the HPKE aad value, which binds these parameters to the ciphertext.<a href="#section-6.1-5" class="pilcrow">¶</a></p>
</section>
</div>
<div id="ke-algs">
<section id="section-6.2">
        <h3 id="name-key-encryption-algorithms-u">
<a href="#section-6.2" class="section-number selfRef">6.2. </a><a href="#name-key-encryption-algorithms-u" class="section-name selfRef">Key Encryption Algorithms using HPKE</a>
        </h3>
<p id="section-6.2-1">The following JWE algorithms using HPKE are defined for use with
the Key Encryption Key Establishment Mode:<a href="#section-6.2-1" class="pilcrow">¶</a></p>
<span id="name-algorithms-using-hpke-for-k"></span><div id="ciphersuite-ke-algs">
<figure id="figure-2">
          <div class="alignLeft art-text artwork" id="section-6.2-2.1">
<pre>
+-----------+----------------------------+-------------+------------------+
| "alg"     | HPKE KEM                   | HPKE KDF    | HPKE AEAD        |
+-----------+----------------------------+-------------+------------------+
| HPKE-0-KE | DHKEM(P-256, HKDF-SHA256)  | HKDF-SHA256 | AES-128-GCM      |
| HPKE-1-KE | DHKEM(P-384, HKDF-SHA384)  | HKDF-SHA384 | AES-256-GCM      |
| HPKE-2-KE | DHKEM(P-521, HKDF-SHA512)  | HKDF-SHA512 | AES-256-GCM      |
| HPKE-3-KE | DHKEM(X25519, HKDF-SHA256) | HKDF-SHA256 | AES-128-GCM      |
| HPKE-4-KE | DHKEM(X25519, HKDF-SHA256) | HKDF-SHA256 | ChaCha20Poly1305 |
| HPKE-5-KE | DHKEM(X448, HKDF-SHA512)   | HKDF-SHA512 | AES-256-GCM      |
| HPKE-6-KE | DHKEM(X448, HKDF-SHA512)   | HKDF-SHA512 | ChaCha20Poly1305 |
| HPKE-7-KE | DHKEM(P-256, HKDF-SHA256)  | HKDF-SHA256 | AES-256-GCM      |
+-----------+----------------------------+-------------+------------------+
</pre>
</div>
<figcaption><a href="#figure-2" class="selfRef">Figure 2</a>:
<a href="#name-algorithms-using-hpke-for-k" class="selfRef">Algorithms using HPKE for Key Encryption</a>
          </figcaption></figure>
</div>
<p id="section-6.2-3">The HPKE KEM, KDF, and AEAD values are chosen from the IANA HPKE registry <span>[<a href="#IANA.HPKE" class="cite xref">IANA.HPKE</a>]</span>.<a href="#section-6.2-3" class="pilcrow">¶</a></p>
<div id="recipientstructure-example">
<section id="section-6.2.1">
          <h4 id="name-recipient_structure-example">
<a href="#section-6.2.1" class="section-number selfRef">6.2.1. </a><a href="#name-recipient_structure-example" class="section-name selfRef">Recipient_structure Example</a>
          </h4>
<p id="section-6.2.1-1">The Recipient_structure encoded in binary as specified in <a href="#recipient_structure" class="auto internal xref">Section 6.1</a>, and using the field values
(content_encryption_alg = "A128GCM", recipient_extra_info = ""),
results in the following byte sequence:<a href="#section-6.2.1-1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-6.2.1-2">
<pre>
"JOSE-HPKE rcpt\xffA128GCM\xff"
</pre><a href="#section-6.2.1-2" class="pilcrow">¶</a>
</div>
<p id="section-6.2.1-3">The corresponding hexadecimal representation is:<a href="#section-6.2.1-3" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-6.2.1-4">
<pre>
4a4f53452d48504b452072637074ff4131323847434dff
</pre><a href="#section-6.2.1-4" class="pilcrow">¶</a>
</div>
<p id="section-6.2.1-5">This value is used as the HPKE <code>info</code> parameter when performing Key Encryption with HPKE.<a href="#section-6.2.1-5" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="general-example">
<section id="section-6.3">
        <h3 id="name-general-jwe-json-serializat">
<a href="#section-6.3" class="section-number selfRef">6.3. </a><a href="#name-general-jwe-json-serializat" class="section-name selfRef">General JWE JSON Serialization Example</a>
        </h3>
<p id="section-6.3-1">Below is an example of a JWE using the General JSON Serialization and Key Encryption with HPKE:<a href="#section-6.3-1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-6.3-2">
<pre>
{
  "ciphertext": "uF1XBbVZWhYm_pDbeJvI_fkuqFJiKd1WMP3O_BAGOP-LkpTLE3Et2VQNcOpPAIBfyx8rUzshGqiOFOWzcoWZ3mIwYuDvvAW3-P1RCS8Dtq70JRvahO5O8sAN1vzJg8_dyBPnwsQY6Cy3RhMD6sSSCjjSw0FYmmx67IiI2zJ6Wr8z69k0f34ZTh43k4C-pTwaUSvjl2XI_YrUgdDVYmY_MJ5vmlPTcceMaefP8Onz_fx5xOcGfnVBVz2gpMQPuQL8k5Rk5KJvPGfFfN6hrgWkK_LDzi4lrfnIrvNsk3BCBeZPpc-n19-u7W4-GQxLjAlVyMHeGk5K4tU6gHB8PnnQ4ND5ZTtyXrJWQW-Qr1iFev6g",
  "iv": "mLiHjYaQA42nPm1L",
  "recipients": [
    {
      "encrypted_key": "hU6b0hp4-y4ZoK1Qz8YWmDmqDmgTto3HW25-RyPhcLU",
      "header": {
        "alg": "HPKE-0-KE",
        "kid": "9CfUPiGcAcTp7oXgVbDStw2FEjka-_KHU_i-X3XMCEA",
        "ek": "BGWPWLoD5BUjFEDIjMS-yvtcCXBn5A-kuv2RjzUY_2hKUjgZINqtEy1aHZ8dWxAiyApV5JafG76W8O_yZzy5T54"
      }
    }
  ],
  "tag": "K22C64ZhFABEu2S2F00PLg",
  "aad": "VGhlIEZlbGxvd3NoaXAgb2YgdGhlIFJpbmc",
  "protected": "eyJlbmMiOiJBMTI4R0NNIn0"
}
</pre><a href="#section-6.3-2" class="pilcrow">¶</a>
</div>
<p id="section-6.3-3">The key used for this example is in <a href="#ke-key" class="auto internal xref">Appendix A.2</a>.<a href="#section-6.3-3" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="producing-and-consuming-jwes">
<section id="section-7">
      <h2 id="name-producing-and-consuming-jwe">
<a href="#section-7" class="section-number selfRef">7. </a><a href="#name-producing-and-consuming-jwe" class="section-name selfRef">Producing and Consuming JWEs</a>
      </h2>
<p id="section-7-1">Sections 5.1 (Message Encryption) and 5.2 (Message Decryption) of <span>[<a href="#RFC7516" class="cite xref">RFC7516</a>]</span>
are replaced by the following sections,
which add processing rules for using the Integrated Encryption Key Management Mode.<a href="#section-7-1" class="pilcrow">¶</a></p>
<div id="encryption">
<section id="section-7.1">
        <h3 id="name-message-encryption">
<a href="#section-7.1" class="section-number selfRef">7.1. </a><a href="#name-message-encryption" class="section-name selfRef">Message Encryption</a>
        </h3>
<p id="section-7.1-1">The message encryption process is as follows.
The order of the steps is not significant in cases where
there are no dependencies between the inputs and outputs of the steps.<a href="#section-7.1-1" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-7.1-2">
<li id="section-7.1-2.1">
            <p id="section-7.1-2.1.1">Determine the Key Management Mode employed by the algorithm
used to determine the Content Encryption Key value.
(This is the algorithm recorded in the
<code>alg</code> (algorithm)
Header Parameter of the resulting JWE.)<a href="#section-7.1-2.1.1" class="pilcrow">¶</a></p>
</li>
          <li id="section-7.1-2.2">
            <p id="section-7.1-2.2.1">When Key Wrapping, Key Encryption,
or Key Agreement with Key Wrapping are employed,
generate a random CEK value to use for subsequent steps
unless one was already generated for a previously
processed recipient, in which case, let that be the one used
for subsequent steps.
See <span>[<a href="#RFC4086" class="cite xref">RFC4086</a>]</span> for
considerations on generating random values.
The CEK <span class="bcp14">MUST</span> have a length equal to that
required for the content encryption algorithm.<a href="#section-7.1-2.2.1" class="pilcrow">¶</a></p>
</li>
          <li id="section-7.1-2.3">
            <p id="section-7.1-2.3.1">When Direct Key Agreement or Key Agreement with Key Wrapping
are employed, use the key agreement algorithm
to compute the value of the agreed upon key.
When Direct Key Agreement is employed,
let the CEK be the agreed upon key.
When Key Agreement with Key Wrapping is employed,
the agreed upon key will be used to wrap the CEK.<a href="#section-7.1-2.3.1" class="pilcrow">¶</a></p>
</li>
          <li id="section-7.1-2.4">
            <p id="section-7.1-2.4.1">When Key Wrapping, Key Encryption,
or Key Agreement with Key Wrapping are employed,
encrypt the CEK to the recipient and let the result be the
JWE Encrypted Key.<a href="#section-7.1-2.4.1" class="pilcrow">¶</a></p>
</li>
          <li id="section-7.1-2.5">
            <p id="section-7.1-2.5.1">When Direct Key Agreement or Direct Encryption are employed,
let the JWE Encrypted Key be the empty octet sequence.<a href="#section-7.1-2.5.1" class="pilcrow">¶</a></p>
</li>
          <li id="section-7.1-2.6">
            <p id="section-7.1-2.6.1">When Direct Encryption is employed,
let the CEK be the shared symmetric key.<a href="#section-7.1-2.6.1" class="pilcrow">¶</a></p>
</li>
          <li id="section-7.1-2.7">
            <p id="section-7.1-2.7.1">When Integrated Encryption is employed,
let the JWE Encrypted Key be as specified by the Integrated Encryption algorithm.<a href="#section-7.1-2.7.1" class="pilcrow">¶</a></p>
</li>
          <li id="section-7.1-2.8">
            <p id="section-7.1-2.8.1">Compute the encoded key value BASE64URL(JWE Encrypted Key).<a href="#section-7.1-2.8.1" class="pilcrow">¶</a></p>
</li>
          <li id="section-7.1-2.9">
            <p id="section-7.1-2.9.1">If the JWE JSON Serialization is being used, repeat this process
(steps 1-8)
for each recipient.<a href="#section-7.1-2.9.1" class="pilcrow">¶</a></p>
</li>
          <li id="section-7.1-2.10">
            <p id="section-7.1-2.10.1">Generate a random JWE Initialization Vector of the correct size
for the content encryption algorithm (if required for the algorithm);
otherwise, let the JWE Initialization Vector be the empty octet sequence.<a href="#section-7.1-2.10.1" class="pilcrow">¶</a></p>
</li>
          <li id="section-7.1-2.11">
            <p id="section-7.1-2.11.1">Compute the encoded Initialization Vector value
BASE64URL(JWE Initialization Vector).<a href="#section-7.1-2.11.1" class="pilcrow">¶</a></p>
</li>
          <li id="section-7.1-2.12">
            <p id="section-7.1-2.12.1">If a <code>zip</code> parameter was included,
compress the plaintext using the specified compression algorithm
and let M be the octet sequence representing the compressed plaintext;
otherwise, let M be the octet sequence representing the plaintext.<a href="#section-7.1-2.12.1" class="pilcrow">¶</a></p>
</li>
          <li id="section-7.1-2.13">
            <p id="section-7.1-2.13.1">Create the JSON object(s) containing the desired set of Header Parameters,
which together comprise the JOSE Header: one or more of the JWE Protected
Header, the JWE Shared Unprotected
Header, and the JWE Per-Recipient Unprotected Header.<a href="#section-7.1-2.13.1" class="pilcrow">¶</a></p>
</li>
          <li id="section-7.1-2.14">
            <p id="section-7.1-2.14.1">Compute the Encoded Protected Header value
BASE64URL(UTF8(JWE Protected Header)).
If the JWE Protected Header is not present
(which can only happen when using the JWE JSON Serialization
and no <code>protected</code> member is present),
let this value be the empty string.<a href="#section-7.1-2.14.1" class="pilcrow">¶</a></p>
</li>
          <li id="section-7.1-2.15">
            <p id="section-7.1-2.15.1">Let the Additional Authenticated Data encryption parameter be
ASCII(Encoded Protected Header).
However, if a JWE AAD value is present
(which can only be the case when using the JWE JSON Serialization),
instead let the Additional Authenticated Data encryption parameter be
ASCII(Encoded Protected Header || '.' || BASE64URL(JWE AAD)).<a href="#section-7.1-2.15.1" class="pilcrow">¶</a></p>
</li>
          <li id="section-7.1-2.16">
            <p id="section-7.1-2.16.1">If Integrated Encryption is not being employed,
encrypt M using the CEK, the JWE Initialization Vector, and
the Additional Authenticated Data value
using the specified content encryption algorithm
to create the JWE Ciphertext value and the JWE Authentication Tag
(which is the Authentication Tag output from the encryption operation).<a href="#section-7.1-2.16.1" class="pilcrow">¶</a></p>
</li>
          <li id="section-7.1-2.17">
            <p id="section-7.1-2.17.1">If Integrated Encryption is being employed,
encrypt M
using the specified Integrated Encryption algorithm
to create the JWE Ciphertext value.
Let the JWE Authentication Tag be the empty octet sequence.<a href="#section-7.1-2.17.1" class="pilcrow">¶</a></p>
</li>
          <li id="section-7.1-2.18">
            <p id="section-7.1-2.18.1">Compute the encoded ciphertext value BASE64URL(JWE Ciphertext).<a href="#section-7.1-2.18.1" class="pilcrow">¶</a></p>
</li>
          <li id="section-7.1-2.19">
            <p id="section-7.1-2.19.1">Compute the encoded Authentication Tag value
BASE64URL(JWE Authentication Tag).<a href="#section-7.1-2.19.1" class="pilcrow">¶</a></p>
</li>
          <li id="section-7.1-2.20">
            <p id="section-7.1-2.20.1">If a JWE AAD value is present,
compute the encoded AAD value BASE64URL(JWE AAD).<a href="#section-7.1-2.20.1" class="pilcrow">¶</a></p>
</li>
          <li id="section-7.1-2.21">
            <p id="section-7.1-2.21.1">Create the desired serialized output.
The Compact Serialization of this result is the string
BASE64URL(UTF8(JWE Protected Header))
|| '.' || BASE64URL(JWE Encrypted Key)
|| '.' || BASE64URL(JWE Initialization Vector)
|| '.' || BASE64URL(JWE Ciphertext)
|| '.' || BASE64URL(JWE Authentication Tag).
The JWE JSON Serialization is described in <span><a href="https://rfc-editor.org/rfc/rfc7516#section-7.2" class="relref">Section 7.2</a> of [<a href="#RFC7516" class="cite xref">RFC7516</a>]</span>.<a href="#section-7.1-2.21.1" class="pilcrow">¶</a></p>
</li>
        </ol>
</section>
</div>
<div id="decryption">
<section id="section-7.2">
        <h3 id="name-message-decryption">
<a href="#section-7.2" class="section-number selfRef">7.2. </a><a href="#name-message-decryption" class="section-name selfRef">Message Decryption</a>
        </h3>
<p id="section-7.2-1">The message decryption process is the reverse of the
encryption process.
The order of the steps is not significant in cases where
there are no dependencies between the inputs and outputs of the steps.
If any of these steps fail, the encrypted content cannot be validated.<a href="#section-7.2-1" class="pilcrow">¶</a></p>
<p id="section-7.2-2">When there are multiple recipients,
it is an application decision which of the recipients' encrypted content
must successfully validate for the JWE to be accepted.
In some cases, encrypted content for all recipients must successfully validate
or the JWE will be considered invalid.
In other cases, only the encrypted content for a single recipient
needs to be successfully validated.
However, in all cases, the encrypted content for at least one recipient
<span class="bcp14">MUST</span> successfully validate or the JWE <span class="bcp14">MUST</span> be considered invalid.<a href="#section-7.2-2" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-7.2-3">
<li id="section-7.2-3.1">
            <p id="section-7.2-3.1.1">Parse the JWE representation to extract the serialized values
for the components of the JWE.
When using the JWE Compact Serialization,
these components are
the base64url-encoded representations of
the JWE Protected Header,
the JWE Encrypted Key,
the JWE Initialization Vector,
the JWE Ciphertext, and
the JWE Authentication Tag,
and when using the JWE JSON Serialization,
these components also include the base64url-encoded representation of
the JWE AAD and the unencoded
JWE Shared Unprotected Header and
JWE Per-Recipient Unprotected Header values.
When using the JWE Compact Serialization,
the JWE Protected Header,
the JWE Encrypted Key,
the JWE Initialization Vector,
the JWE Ciphertext, and
the JWE Authentication Tag
are represented as base64url-encoded values in that order,
with each value being separated from the next by a single period ('.') character,
resulting in exactly four delimiting period characters being used.
The JWE JSON Serialization
is described in <span><a href="https://rfc-editor.org/rfc/rfc7516#section-7.2" class="relref">Section 7.2</a> of [<a href="#RFC7516" class="cite xref">RFC7516</a>]</span>.<a href="#section-7.2-3.1.1" class="pilcrow">¶</a></p>
</li>
          <li id="section-7.2-3.2">
            <p id="section-7.2-3.2.1">Base64url decode the encoded representations of
the JWE Protected Header,
the JWE Encrypted Key,
the JWE Initialization Vector,
the JWE Ciphertext,
the JWE Authentication Tag, and
the JWE AAD,
following the restriction that no line breaks, whitespace, or other additional characters have been used.<a href="#section-7.2-3.2.1" class="pilcrow">¶</a></p>
</li>
          <li id="section-7.2-3.3">
            <p id="section-7.2-3.3.1">Verify that the octet sequence resulting from decoding the encoded JWE Protected Header
is a UTF-8-encoded representation of
a completely valid JSON object
conforming to <span>[<a href="#RFC8259" class="cite xref">RFC8259</a>]</span>;
let the JWE Protected Header be this JSON object.<a href="#section-7.2-3.3.1" class="pilcrow">¶</a></p>
</li>
          <li id="section-7.2-3.4">
            <p id="section-7.2-3.4.1">If using the JWE Compact Serialization, let the JOSE Header be the
JWE Protected Header.
Otherwise, when using the JWE JSON Serialization,
let the JOSE Header be the union of
the members of the JWE Protected Header,
the JWE Shared Unprotected Header and
the corresponding JWE Per-Recipient Unprotected Header,
all of which must be completely valid JSON objects.
During this step,
verify that the resulting JOSE Header does not contain duplicate
Header Parameter names.
When using the JWE JSON Serialization, this restriction includes
that the same Header Parameter name also <span class="bcp14">MUST NOT</span> occur in
distinct JSON object values that together comprise the JOSE Header.<a href="#section-7.2-3.4.1" class="pilcrow">¶</a></p>
</li>
          <li id="section-7.2-3.5">
            <p id="section-7.2-3.5.1">Verify that the implementation understands and can process
all fields that it is required to support,
whether required by this specification,
by the algorithms being used,
or by the <code>crit</code> Header Parameter value,
and that the values of those parameters are also understood and supported.<a href="#section-7.2-3.5.1" class="pilcrow">¶</a></p>
</li>
          <li id="section-7.2-3.6">
            <p id="section-7.2-3.6.1">Determine the Key Management Mode employed by the algorithm
specified by the
<code>alg</code> (algorithm) Header Parameter.<a href="#section-7.2-3.6.1" class="pilcrow">¶</a></p>
</li>
          <li id="section-7.2-3.7">
            <p id="section-7.2-3.7.1">Verify that the JWE uses a key known to the recipient.<a href="#section-7.2-3.7.1" class="pilcrow">¶</a></p>
</li>
          <li id="section-7.2-3.8">
            <p id="section-7.2-3.8.1">When Direct Key Agreement or Key Agreement with Key Wrapping
are employed, use the key agreement algorithm
to compute the value of the agreed upon key.
When Direct Key Agreement is employed,
let the CEK be the agreed upon key.
When Key Agreement with Key Wrapping is employed,
the agreed upon key will be used to decrypt the JWE Encrypted Key.<a href="#section-7.2-3.8.1" class="pilcrow">¶</a></p>
</li>
          <li id="section-7.2-3.9">
            <p id="section-7.2-3.9.1">When Key Wrapping, Key Encryption,
or Key Agreement with Key Wrapping are employed,
decrypt the JWE Encrypted Key to produce the CEK.
The CEK <span class="bcp14">MUST</span> have a length equal to that
required for the content encryption algorithm.
Note that when there are multiple recipients,
each recipient will only be able to decrypt JWE Encrypted Key values
that were encrypted to a key in that recipient's possession.
It is therefore normal to only be able to decrypt one of the
per-recipient JWE Encrypted Key values to obtain the CEK value.
Also, see <span><a href="https://rfc-editor.org/rfc/rfc7516#section-11.5" class="relref">Section 11.5</a> of [<a href="#RFC7516" class="cite xref">RFC7516</a>]</span> for security considerations
on mitigating timing attacks.<a href="#section-7.2-3.9.1" class="pilcrow">¶</a></p>
</li>
          <li id="section-7.2-3.10">
            <p id="section-7.2-3.10.1">When Direct Key Agreement or Direct Encryption are employed,
verify that the JWE Encrypted Key value is an empty octet sequence.<a href="#section-7.2-3.10.1" class="pilcrow">¶</a></p>
</li>
          <li id="section-7.2-3.11">
            <p id="section-7.2-3.11.1">When Direct Encryption is employed,
let the CEK be the shared symmetric key.<a href="#section-7.2-3.11.1" class="pilcrow">¶</a></p>
</li>
          <li id="section-7.2-3.12">
            <p id="section-7.2-3.12.1">If Integrated Encryption is not being employed,
record whether the CEK could be successfully determined for this recipient or not.<a href="#section-7.2-3.12.1" class="pilcrow">¶</a></p>
</li>
          <li id="section-7.2-3.13">
            <p id="section-7.2-3.13.1">If the JWE JSON Serialization is being used, repeat this process
(steps 4-12)
for each recipient contained in the representation.<a href="#section-7.2-3.13.1" class="pilcrow">¶</a></p>
</li>
          <li id="section-7.2-3.14">
            <p id="section-7.2-3.14.1">Compute the Encoded Protected Header value
BASE64URL(UTF8(JWE Protected Header)).
If the JWE Protected Header is not present
(which can only happen when using the JWE JSON Serialization
and no <code>protected</code> member is present),
let this value be the empty string.<a href="#section-7.2-3.14.1" class="pilcrow">¶</a></p>
</li>
          <li id="section-7.2-3.15">
            <p id="section-7.2-3.15.1">Let the Additional Authenticated Data encryption parameter be
ASCII(Encoded Protected Header).
However, if a JWE AAD value is present
(which can only be the case when using the JWE JSON Serialization),
instead let the Additional Authenticated Data encryption parameter be
ASCII(Encoded Protected Header || '.' || BASE64URL(JWE AAD)).<a href="#section-7.2-3.15.1" class="pilcrow">¶</a></p>
</li>
          <li id="section-7.2-3.16">
            <p id="section-7.2-3.16.1">If Integrated Encryption is not being employed,
decrypt the JWE Ciphertext using the CEK, the JWE Initialization Vector,
the Additional Authenticated Data value,
and the JWE Authentication Tag
(which is the Authentication Tag input to the calculation)
using the specified content encryption algorithm,
returning the decrypted plaintext and validating the JWE Authentication Tag
in the manner specified for the algorithm,
rejecting the input without emitting any decrypted output
if the JWE Authentication Tag is incorrect.<a href="#section-7.2-3.16.1" class="pilcrow">¶</a></p>
</li>
          <li id="section-7.2-3.17">
            <p id="section-7.2-3.17.1">If Integrated Encryption is being employed,
decrypt the JWE Ciphertext
using the specified Integrated Encryption algorithm,
returning the decrypted plaintext
in the manner specified for the algorithm,
rejecting the input without emitting any decrypted output
if the decryption fails.<a href="#section-7.2-3.17.1" class="pilcrow">¶</a></p>
</li>
          <li id="section-7.2-3.18">
            <p id="section-7.2-3.18.1">If a <code>zip</code> parameter was included,
uncompress the decrypted plaintext using the specified compression algorithm.<a href="#section-7.2-3.18.1" class="pilcrow">¶</a></p>
</li>
          <li id="section-7.2-3.19">
            <p id="section-7.2-3.19.1">If there was no recipient for which all of the decryption steps succeeded,
then the JWE <span class="bcp14">MUST</span> be considered invalid.
Otherwise, output the plaintext.
In the JWE JSON Serialization case, also return a result to the application
indicating for which of the recipients the decryption succeeded and failed.<a href="#section-7.2-3.19.1" class="pilcrow">¶</a></p>
</li>
        </ol>
<p id="section-7.2-4">Finally, note that it is an application decision which algorithms
may be used in a given context.
Even if a JWE can be successfully decrypted,
unless the algorithms used in the JWE are acceptable
to the application, it <span class="bcp14">SHOULD</span> consider the JWE to be invalid.<a href="#section-7.2-4" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="distinguishing-between-jws-and-jwe-objects">
<section id="section-8">
      <h2 id="name-distinguishing-between-jws-">
<a href="#section-8" class="section-number selfRef">8. </a><a href="#name-distinguishing-between-jws-" class="section-name selfRef">Distinguishing between JWS and JWE Objects</a>
      </h2>
<p id="section-8-1"><span><a href="https://rfc-editor.org/rfc/rfc7516#section-9" class="relref">Section 9</a> of [<a href="#RFC7516" class="cite xref">RFC7516</a>]</span> is updated to delete the last bullet, which says:<a href="#section-8-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-8-2.1">
          <p id="section-8-2.1.1">The JOSE Header for a JWS can also be distinguished from
the JOSE Header for a JWE by
determining whether an
<code>enc</code> (encryption algorithm) member exists.
If the <code>enc</code> member exists, it is a JWE;
otherwise, it is a JWS.<a href="#section-8-2.1.1" class="pilcrow">¶</a></p>
</li>
      </ul>
<p id="section-8-3">The deleted test no longer works when Integrated Encryption is used.<a href="#section-8-3" class="pilcrow">¶</a></p>
<p id="section-8-4">The other methods of distinguishing between
JSON Web Signature (JWS) <span>[<a href="#RFC7515" class="cite xref">RFC7515</a>]</span> and
JSON Web Encryption (JWE) <span>[<a href="#RFC7516" class="cite xref">RFC7516</a>]</span> objects continue to work.<a href="#section-8-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="jwk-representations-for-jwe-hpke-keys">
<section id="section-9">
      <h2 id="name-jwk-representations-for-jwe">
<a href="#section-9" class="section-number selfRef">9. </a><a href="#name-jwk-representations-for-jwe" class="section-name selfRef">JWK Representations for JWE HPKE Keys</a>
      </h2>
<p id="section-9-1">The JSON Web Key (JWK) <span>[<a href="#RFC7517" class="cite xref">RFC7517</a>]</span> representations for keys
used with the JWE algorithms defined in this specification are as follows.
The valid combinations of the
"alg", "kty", and "crv" in the JWK are shown in <a href="#ciphersuite-kty-crv" class="auto internal xref">Figure 3</a>.<a href="#section-9-1" class="pilcrow">¶</a></p>
<span id="name-jwk-types-and-curves-for-jw"></span><div id="ciphersuite-kty-crv">
<figure id="figure-3">
        <div class="alignLeft art-text artwork" id="section-9-2.1">
<pre>
+--------------------------------------+-------+--------+
| "alg" values                         | "kty" | "crv"  |
+--------------------------------------+-------+--------+
| HPKE-0, HPKE-0-KE, HPKE-7, HPKE-7-KE | EC    | P-256  |
| HPKE-1, HPKE-1-KE                    | EC    | P-384  |
| HPKE-2, HPKE-2-KE                    | EC    | P-521  |
| HPKE-3, HPKE-3-KE, HPKE-4, HPKE-4-KE | OKP   | X25519 |
| HPKE-5, HPKE-5-KE, HPKE-6, HPKE-6-KE | OKP   | X448   |
+--------------------------------------+-------+--------+
</pre>
</div>
<figcaption><a href="#figure-3" class="selfRef">Figure 3</a>:
<a href="#name-jwk-types-and-curves-for-jw" class="selfRef">JWK Types and Curves for JWE HPKE Ciphersuites</a>
        </figcaption></figure>
</div>
<div id="jwk-representation-of-key-using-jwe-hpke-ciphersuite">
<section id="section-9.1">
        <h3 id="name-jwk-representation-of-key-u">
<a href="#section-9.1" class="section-number selfRef">9.1. </a><a href="#name-jwk-representation-of-key-u" class="section-name selfRef">JWK Representation of Key using JWE HPKE Ciphersuite</a>
        </h3>
<p id="section-9.1-1">The example below is a JWK representation of a public and private key
used with the Integrated Encryption Key Establishment Mode:<a href="#section-9.1-1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-9.1-2">
<pre>
{
  "kty": "OKP",
  "crv": "X25519",
  "x": "3pPHgcHYVYpOpB6ISwHdoPRB6jNgd8mM4nRyyj4H3aE",
  "d": "nWGxne0tAiV8Hk6kcy4rN0wMskjl9yND0N3Xeho9n6g",
  "kid": "recipient-key-1",
  "alg": "HPKE-3",
  "use": "enc"
}
</pre><a href="#section-9.1-2" class="pilcrow">¶</a>
</div>
</section>
</div>
</section>
</div>
<div id="security-considerations">
<section id="section-10">
      <h2 id="name-security-considerations">
<a href="#section-10" class="section-number selfRef">10. </a><a href="#name-security-considerations" class="section-name selfRef">Security Considerations</a>
      </h2>
<p id="section-10-1">This specification uses HPKE and the security considerations of
<span>[<a href="#I-D.ietf-hpke-hpke" class="cite xref">I-D.ietf-hpke-hpke</a>]</span> are therefore applicable.<a href="#section-10-1" class="pilcrow">¶</a></p>
<p id="section-10-2">HPKE assumes the sender is in possession of the public key of the recipient and
HPKE JOSE makes the same assumptions. Hence, some form of public key distribution
mechanism is assumed to exist but outside the scope of this document.<a href="#section-10-2" class="pilcrow">¶</a></p>
<p id="section-10-3">HPKE in Base mode does not offer authentication as part of the HPKE KEM.<a href="#section-10-3" class="pilcrow">¶</a></p>
<p id="section-10-4">HPKE relies on a source of randomness being available on the device.
In Key Agreement with Key Wrapping mode, the CEK has to be randomly generated.
The guidance on randomness in <span>[<a href="#RFC4086" class="cite xref">RFC4086</a>]</span> applies.<a href="#section-10-4" class="pilcrow">¶</a></p>
<div id="key-management">
<section id="section-10.1">
        <h3 id="name-key-management">
<a href="#section-10.1" class="section-number selfRef">10.1. </a><a href="#name-key-management" class="section-name selfRef">Key Management</a>
        </h3>
<p id="section-10.1-1">A single key <span class="bcp14">MUST NOT</span> be used with multiple KEM algorithms.
Each key and its associated HPKE algorithm suite, comprising the KEM, KDF, and AEAD,
<span class="bcp14">SHOULD</span> be managed independently.
This separation prevents unintended interactions or vulnerabilities between algorithms,
ensuring the integrity and security guarantees of each algorithm are preserved.
Additionally, the same key <span class="bcp14">SHOULD NOT</span> be used for both
Key Encryption and Integrated Encryption, as it may introduce security risks.
It creates algorithm confusion, increases the potential for key leakage, cross-suite attacks, and improper handling of the key.<a href="#section-10.1-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="jwt-best-current-practices">
<section id="section-10.2">
        <h3 id="name-jwt-best-current-practices">
<a href="#section-10.2" class="section-number selfRef">10.2. </a><a href="#name-jwt-best-current-practices" class="section-name selfRef">JWT Best Current Practices</a>
        </h3>
<p id="section-10.2-1">The guidance in <span>[<a href="#RFC8725" class="cite xref">RFC8725</a>]</span> about encryption is also pertinent to this specification.<a href="#section-10.2-1" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="IANA">
<section id="section-11">
      <h2 id="name-iana-considerations">
<a href="#section-11" class="section-number selfRef">11. </a><a href="#name-iana-considerations" class="section-name selfRef">IANA Considerations</a>
      </h2>
<div id="json-web-signature-and-encryption-algorithms">
<section id="section-11.1">
        <h3 id="name-json-web-signature-and-encr">
<a href="#section-11.1" class="section-number selfRef">11.1. </a><a href="#name-json-web-signature-and-encr" class="section-name selfRef">JSON Web Signature and Encryption Algorithms</a>
        </h3>
<p id="section-11.1-1">The following entries are added to the IANA "JSON Web Signature and Encryption Algorithms" registry <span>[<a href="#IANA.JOSE" class="cite xref">IANA.JOSE</a>]</span> established by <span>[<a href="#RFC7518" class="cite xref">RFC7518</a>]</span>:<a href="#section-11.1-1" class="pilcrow">¶</a></p>
<div id="hpke-0">
<section id="section-11.1.1">
          <h4 id="name-hpke-0">
<a href="#section-11.1.1" class="section-number selfRef">11.1.1. </a><a href="#name-hpke-0" class="section-name selfRef">HPKE-0</a>
          </h4>
<ul class="normal">
<li class="normal" id="section-11.1.1-1.1">
              <p id="section-11.1.1-1.1.1">Algorithm Name: HPKE-0<a href="#section-11.1.1-1.1.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-11.1.1-1.2">
              <p id="section-11.1.1-1.2.1">Algorithm Description: Integrated Encryption with HPKE using DHKEM(P-256, HKDF-SHA256) KEM, HKDF-SHA256 KDF and AES-128-GCM AEAD<a href="#section-11.1.1-1.2.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-11.1.1-1.3">
              <p id="section-11.1.1-1.3.1">Algorithm Usage Location(s): "alg"<a href="#section-11.1.1-1.3.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-11.1.1-1.4">
              <p id="section-11.1.1-1.4.1">JOSE Implementation Requirements: Optional<a href="#section-11.1.1-1.4.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-11.1.1-1.5">
              <p id="section-11.1.1-1.5.1">Change Controller: IETF<a href="#section-11.1.1-1.5.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-11.1.1-1.6">
              <p id="section-11.1.1-1.6.1">Specification Document(s): <a href="#int-algs" class="auto internal xref">Section 5.1</a> of [[ this specification ]]<a href="#section-11.1.1-1.6.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-11.1.1-1.7">
              <p id="section-11.1.1-1.7.1">Algorithm Analysis Documents(s): <span>[<a href="#I-D.ietf-hpke-hpke" class="cite xref">I-D.ietf-hpke-hpke</a>]</span><a href="#section-11.1.1-1.7.1" class="pilcrow">¶</a></p>
</li>
          </ul>
</section>
</div>
<div id="hpke-1">
<section id="section-11.1.2">
          <h4 id="name-hpke-1">
<a href="#section-11.1.2" class="section-number selfRef">11.1.2. </a><a href="#name-hpke-1" class="section-name selfRef">HPKE-1</a>
          </h4>
<ul class="normal">
<li class="normal" id="section-11.1.2-1.1">
              <p id="section-11.1.2-1.1.1">Algorithm Name: HPKE-1<a href="#section-11.1.2-1.1.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-11.1.2-1.2">
              <p id="section-11.1.2-1.2.1">Algorithm Description: Integrated Encryption with HPKE using DHKEM(P-384, HKDF-SHA384) KEM, HKDF-SHA384 KDF, and AES-256-GCM AEAD<a href="#section-11.1.2-1.2.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-11.1.2-1.3">
              <p id="section-11.1.2-1.3.1">Algorithm Usage Location(s): "alg"<a href="#section-11.1.2-1.3.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-11.1.2-1.4">
              <p id="section-11.1.2-1.4.1">JOSE Implementation Requirements: Optional<a href="#section-11.1.2-1.4.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-11.1.2-1.5">
              <p id="section-11.1.2-1.5.1">Change Controller: IETF<a href="#section-11.1.2-1.5.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-11.1.2-1.6">
              <p id="section-11.1.2-1.6.1">Specification Document(s): <a href="#int-algs" class="auto internal xref">Section 5.1</a> of [[ this specification ]]<a href="#section-11.1.2-1.6.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-11.1.2-1.7">
              <p id="section-11.1.2-1.7.1">Algorithm Analysis Documents(s): <span>[<a href="#I-D.ietf-hpke-hpke" class="cite xref">I-D.ietf-hpke-hpke</a>]</span><a href="#section-11.1.2-1.7.1" class="pilcrow">¶</a></p>
</li>
          </ul>
</section>
</div>
<div id="hpke-2">
<section id="section-11.1.3">
          <h4 id="name-hpke-2">
<a href="#section-11.1.3" class="section-number selfRef">11.1.3. </a><a href="#name-hpke-2" class="section-name selfRef">HPKE-2</a>
          </h4>
<ul class="normal">
<li class="normal" id="section-11.1.3-1.1">
              <p id="section-11.1.3-1.1.1">Algorithm Name: HPKE-2<a href="#section-11.1.3-1.1.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-11.1.3-1.2">
              <p id="section-11.1.3-1.2.1">Algorithm Description: Integrated Encryption with HPKE using DHKEM(P-521, HKDF-SHA512) KEM, HKDF-SHA512 KDF, and AES-256-GCM AEAD<a href="#section-11.1.3-1.2.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-11.1.3-1.3">
              <p id="section-11.1.3-1.3.1">Algorithm Usage Location(s): "alg"<a href="#section-11.1.3-1.3.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-11.1.3-1.4">
              <p id="section-11.1.3-1.4.1">JOSE Implementation Requirements: Optional<a href="#section-11.1.3-1.4.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-11.1.3-1.5">
              <p id="section-11.1.3-1.5.1">Change Controller: IETF<a href="#section-11.1.3-1.5.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-11.1.3-1.6">
              <p id="section-11.1.3-1.6.1">Specification Document(s): <a href="#int-algs" class="auto internal xref">Section 5.1</a> of [[ this specification ]]<a href="#section-11.1.3-1.6.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-11.1.3-1.7">
              <p id="section-11.1.3-1.7.1">Algorithm Analysis Documents(s): <span>[<a href="#I-D.ietf-hpke-hpke" class="cite xref">I-D.ietf-hpke-hpke</a>]</span><a href="#section-11.1.3-1.7.1" class="pilcrow">¶</a></p>
</li>
          </ul>
</section>
</div>
<div id="hpke-3">
<section id="section-11.1.4">
          <h4 id="name-hpke-3">
<a href="#section-11.1.4" class="section-number selfRef">11.1.4. </a><a href="#name-hpke-3" class="section-name selfRef">HPKE-3</a>
          </h4>
<ul class="normal">
<li class="normal" id="section-11.1.4-1.1">
              <p id="section-11.1.4-1.1.1">Algorithm Name: HPKE-3<a href="#section-11.1.4-1.1.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-11.1.4-1.2">
              <p id="section-11.1.4-1.2.1">Algorithm Description: Integrated Encryption with HPKE using DHKEM(X25519, HKDF-SHA256) KEM, HKDF-SHA256 KDF, and AES-128-GCM AEAD<a href="#section-11.1.4-1.2.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-11.1.4-1.3">
              <p id="section-11.1.4-1.3.1">Algorithm Usage Location(s): "alg"<a href="#section-11.1.4-1.3.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-11.1.4-1.4">
              <p id="section-11.1.4-1.4.1">JOSE Implementation Requirements: Optional<a href="#section-11.1.4-1.4.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-11.1.4-1.5">
              <p id="section-11.1.4-1.5.1">Change Controller: IETF<a href="#section-11.1.4-1.5.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-11.1.4-1.6">
              <p id="section-11.1.4-1.6.1">Specification Document(s): <a href="#int-algs" class="auto internal xref">Section 5.1</a> of [[ this specification ]]<a href="#section-11.1.4-1.6.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-11.1.4-1.7">
              <p id="section-11.1.4-1.7.1">Algorithm Analysis Documents(s): <span>[<a href="#I-D.ietf-hpke-hpke" class="cite xref">I-D.ietf-hpke-hpke</a>]</span><a href="#section-11.1.4-1.7.1" class="pilcrow">¶</a></p>
</li>
          </ul>
</section>
</div>
<div id="hpke-4">
<section id="section-11.1.5">
          <h4 id="name-hpke-4">
<a href="#section-11.1.5" class="section-number selfRef">11.1.5. </a><a href="#name-hpke-4" class="section-name selfRef">HPKE-4</a>
          </h4>
<ul class="normal">
<li class="normal" id="section-11.1.5-1.1">
              <p id="section-11.1.5-1.1.1">Algorithm Name: HPKE-4<a href="#section-11.1.5-1.1.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-11.1.5-1.2">
              <p id="section-11.1.5-1.2.1">Algorithm Description: Integrated Encryption with HPKE using DHKEM(X25519, HKDF-SHA256) KEM, HKDF-SHA256 KDF, and ChaCha20Poly1305 AEAD<a href="#section-11.1.5-1.2.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-11.1.5-1.3">
              <p id="section-11.1.5-1.3.1">Algorithm Usage Location(s): "alg"<a href="#section-11.1.5-1.3.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-11.1.5-1.4">
              <p id="section-11.1.5-1.4.1">JOSE Implementation Requirements: Optional<a href="#section-11.1.5-1.4.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-11.1.5-1.5">
              <p id="section-11.1.5-1.5.1">Change Controller: IETF<a href="#section-11.1.5-1.5.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-11.1.5-1.6">
              <p id="section-11.1.5-1.6.1">Specification Document(s): <a href="#int-algs" class="auto internal xref">Section 5.1</a> of [[ this specification ]]<a href="#section-11.1.5-1.6.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-11.1.5-1.7">
              <p id="section-11.1.5-1.7.1">Algorithm Analysis Documents(s): <span>[<a href="#I-D.ietf-hpke-hpke" class="cite xref">I-D.ietf-hpke-hpke</a>]</span><a href="#section-11.1.5-1.7.1" class="pilcrow">¶</a></p>
</li>
          </ul>
</section>
</div>
<div id="hpke-5">
<section id="section-11.1.6">
          <h4 id="name-hpke-5">
<a href="#section-11.1.6" class="section-number selfRef">11.1.6. </a><a href="#name-hpke-5" class="section-name selfRef">HPKE-5</a>
          </h4>
<ul class="normal">
<li class="normal" id="section-11.1.6-1.1">
              <p id="section-11.1.6-1.1.1">Algorithm Name: HPKE-5<a href="#section-11.1.6-1.1.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-11.1.6-1.2">
              <p id="section-11.1.6-1.2.1">Algorithm Description: Integrated Encryption with HPKE using DHKEM(X448, HKDF-SHA512) KEM, HKDF-SHA512 KDF, and AES-256-GCM AEAD<a href="#section-11.1.6-1.2.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-11.1.6-1.3">
              <p id="section-11.1.6-1.3.1">Algorithm Usage Location(s): "alg"<a href="#section-11.1.6-1.3.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-11.1.6-1.4">
              <p id="section-11.1.6-1.4.1">JOSE Implementation Requirements: Optional<a href="#section-11.1.6-1.4.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-11.1.6-1.5">
              <p id="section-11.1.6-1.5.1">Change Controller: IETF<a href="#section-11.1.6-1.5.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-11.1.6-1.6">
              <p id="section-11.1.6-1.6.1">Specification Document(s): <a href="#int-algs" class="auto internal xref">Section 5.1</a> of [[ this specification ]]<a href="#section-11.1.6-1.6.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-11.1.6-1.7">
              <p id="section-11.1.6-1.7.1">Algorithm Analysis Documents(s): <span>[<a href="#I-D.ietf-hpke-hpke" class="cite xref">I-D.ietf-hpke-hpke</a>]</span><a href="#section-11.1.6-1.7.1" class="pilcrow">¶</a></p>
</li>
          </ul>
</section>
</div>
<div id="hpke-6">
<section id="section-11.1.7">
          <h4 id="name-hpke-6">
<a href="#section-11.1.7" class="section-number selfRef">11.1.7. </a><a href="#name-hpke-6" class="section-name selfRef">HPKE-6</a>
          </h4>
<ul class="normal">
<li class="normal" id="section-11.1.7-1.1">
              <p id="section-11.1.7-1.1.1">Algorithm Name: HPKE-6<a href="#section-11.1.7-1.1.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-11.1.7-1.2">
              <p id="section-11.1.7-1.2.1">Algorithm Description: Integrated Encryption with HPKE using DHKEM(X448, HKDF-SHA512) KEM, HKDF-SHA512 KDF, and ChaCha20Poly1305 AEAD<a href="#section-11.1.7-1.2.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-11.1.7-1.3">
              <p id="section-11.1.7-1.3.1">Algorithm Usage Location(s): "alg"<a href="#section-11.1.7-1.3.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-11.1.7-1.4">
              <p id="section-11.1.7-1.4.1">JOSE Implementation Requirements: Optional<a href="#section-11.1.7-1.4.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-11.1.7-1.5">
              <p id="section-11.1.7-1.5.1">Change Controller: IETF<a href="#section-11.1.7-1.5.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-11.1.7-1.6">
              <p id="section-11.1.7-1.6.1">Specification Document(s): <a href="#int-algs" class="auto internal xref">Section 5.1</a> of [[ this specification ]]<a href="#section-11.1.7-1.6.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-11.1.7-1.7">
              <p id="section-11.1.7-1.7.1">Algorithm Analysis Documents(s): <span>[<a href="#I-D.ietf-hpke-hpke" class="cite xref">I-D.ietf-hpke-hpke</a>]</span><a href="#section-11.1.7-1.7.1" class="pilcrow">¶</a></p>
</li>
          </ul>
</section>
</div>
<div id="hpke-7">
<section id="section-11.1.8">
          <h4 id="name-hpke-7">
<a href="#section-11.1.8" class="section-number selfRef">11.1.8. </a><a href="#name-hpke-7" class="section-name selfRef">HPKE-7</a>
          </h4>
<ul class="normal">
<li class="normal" id="section-11.1.8-1.1">
              <p id="section-11.1.8-1.1.1">Algorithm Name: HPKE-7<a href="#section-11.1.8-1.1.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-11.1.8-1.2">
              <p id="section-11.1.8-1.2.1">Algorithm Description: Integrated Encryption with HPKE using DHKEM(P-256, HKDF-SHA256) KEM, HKDF-SHA256 KDF, and AES-256-GCM AEAD<a href="#section-11.1.8-1.2.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-11.1.8-1.3">
              <p id="section-11.1.8-1.3.1">Algorithm Usage Location(s): "alg"<a href="#section-11.1.8-1.3.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-11.1.8-1.4">
              <p id="section-11.1.8-1.4.1">JOSE Implementation Requirements: Optional<a href="#section-11.1.8-1.4.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-11.1.8-1.5">
              <p id="section-11.1.8-1.5.1">Change Controller: IETF<a href="#section-11.1.8-1.5.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-11.1.8-1.6">
              <p id="section-11.1.8-1.6.1">Specification Document(s): <a href="#int-algs" class="auto internal xref">Section 5.1</a> of [[ this specification ]]<a href="#section-11.1.8-1.6.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-11.1.8-1.7">
              <p id="section-11.1.8-1.7.1">Algorithm Analysis Documents(s): <span>[<a href="#I-D.ietf-hpke-hpke" class="cite xref">I-D.ietf-hpke-hpke</a>]</span><a href="#section-11.1.8-1.7.1" class="pilcrow">¶</a></p>
</li>
          </ul>
</section>
</div>
<div id="hpke-0-ke">
<section id="section-11.1.9">
          <h4 id="name-hpke-0-ke">
<a href="#section-11.1.9" class="section-number selfRef">11.1.9. </a><a href="#name-hpke-0-ke" class="section-name selfRef">HPKE-0-KE</a>
          </h4>
<ul class="normal">
<li class="normal" id="section-11.1.9-1.1">
              <p id="section-11.1.9-1.1.1">Algorithm Name: HPKE-0-KE<a href="#section-11.1.9-1.1.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-11.1.9-1.2">
              <p id="section-11.1.9-1.2.1">Algorithm Description: Key Encryption with HPKE using DHKEM(P-256, HKDF-SHA256) KEM, HKDF-SHA256 KDF and AES-128-GCM AEAD<a href="#section-11.1.9-1.2.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-11.1.9-1.3">
              <p id="section-11.1.9-1.3.1">Algorithm Usage Location(s): "alg"<a href="#section-11.1.9-1.3.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-11.1.9-1.4">
              <p id="section-11.1.9-1.4.1">JOSE Implementation Requirements: Optional<a href="#section-11.1.9-1.4.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-11.1.9-1.5">
              <p id="section-11.1.9-1.5.1">Change Controller: IETF<a href="#section-11.1.9-1.5.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-11.1.9-1.6">
              <p id="section-11.1.9-1.6.1">Specification Document(s): <a href="#ke-algs" class="auto internal xref">Section 6.2</a> of [[ this specification ]]<a href="#section-11.1.9-1.6.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-11.1.9-1.7">
              <p id="section-11.1.9-1.7.1">Algorithm Analysis Documents(s): <span>[<a href="#I-D.ietf-hpke-hpke" class="cite xref">I-D.ietf-hpke-hpke</a>]</span><a href="#section-11.1.9-1.7.1" class="pilcrow">¶</a></p>
</li>
          </ul>
</section>
</div>
<div id="hpke-1-ke">
<section id="section-11.1.10">
          <h4 id="name-hpke-1-ke">
<a href="#section-11.1.10" class="section-number selfRef">11.1.10. </a><a href="#name-hpke-1-ke" class="section-name selfRef">HPKE-1-KE</a>
          </h4>
<ul class="normal">
<li class="normal" id="section-11.1.10-1.1">
              <p id="section-11.1.10-1.1.1">Algorithm Name: HPKE-1-KE<a href="#section-11.1.10-1.1.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-11.1.10-1.2">
              <p id="section-11.1.10-1.2.1">Algorithm Description: Key Encryption with HPKE using DHKEM(P-384, HKDF-SHA384) KEM, HKDF-SHA384 KDF, and AES-256-GCM AEAD<a href="#section-11.1.10-1.2.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-11.1.10-1.3">
              <p id="section-11.1.10-1.3.1">Algorithm Usage Location(s): "alg"<a href="#section-11.1.10-1.3.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-11.1.10-1.4">
              <p id="section-11.1.10-1.4.1">JOSE Implementation Requirements: Optional<a href="#section-11.1.10-1.4.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-11.1.10-1.5">
              <p id="section-11.1.10-1.5.1">Change Controller: IETF<a href="#section-11.1.10-1.5.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-11.1.10-1.6">
              <p id="section-11.1.10-1.6.1">Specification Document(s): <a href="#ke-algs" class="auto internal xref">Section 6.2</a> of [[ this specification ]]<a href="#section-11.1.10-1.6.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-11.1.10-1.7">
              <p id="section-11.1.10-1.7.1">Algorithm Analysis Documents(s): <span>[<a href="#I-D.ietf-hpke-hpke" class="cite xref">I-D.ietf-hpke-hpke</a>]</span><a href="#section-11.1.10-1.7.1" class="pilcrow">¶</a></p>
</li>
          </ul>
</section>
</div>
<div id="hpke-2-ke">
<section id="section-11.1.11">
          <h4 id="name-hpke-2-ke">
<a href="#section-11.1.11" class="section-number selfRef">11.1.11. </a><a href="#name-hpke-2-ke" class="section-name selfRef">HPKE-2-KE</a>
          </h4>
<ul class="normal">
<li class="normal" id="section-11.1.11-1.1">
              <p id="section-11.1.11-1.1.1">Algorithm Name: HPKE-2-KE<a href="#section-11.1.11-1.1.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-11.1.11-1.2">
              <p id="section-11.1.11-1.2.1">Algorithm Description: Key Encryption with HPKE using DHKEM(P-521, HKDF-SHA512) KEM, HKDF-SHA512 KDF, and AES-256-GCM AEAD<a href="#section-11.1.11-1.2.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-11.1.11-1.3">
              <p id="section-11.1.11-1.3.1">Algorithm Usage Location(s): "alg"<a href="#section-11.1.11-1.3.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-11.1.11-1.4">
              <p id="section-11.1.11-1.4.1">JOSE Implementation Requirements: Optional<a href="#section-11.1.11-1.4.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-11.1.11-1.5">
              <p id="section-11.1.11-1.5.1">Change Controller: IETF<a href="#section-11.1.11-1.5.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-11.1.11-1.6">
              <p id="section-11.1.11-1.6.1">Specification Document(s): <a href="#ke-algs" class="auto internal xref">Section 6.2</a> of [[ this specification ]]<a href="#section-11.1.11-1.6.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-11.1.11-1.7">
              <p id="section-11.1.11-1.7.1">Algorithm Analysis Documents(s): <span>[<a href="#I-D.ietf-hpke-hpke" class="cite xref">I-D.ietf-hpke-hpke</a>]</span><a href="#section-11.1.11-1.7.1" class="pilcrow">¶</a></p>
</li>
          </ul>
</section>
</div>
<div id="hpke-3-ke">
<section id="section-11.1.12">
          <h4 id="name-hpke-3-ke">
<a href="#section-11.1.12" class="section-number selfRef">11.1.12. </a><a href="#name-hpke-3-ke" class="section-name selfRef">HPKE-3-KE</a>
          </h4>
<ul class="normal">
<li class="normal" id="section-11.1.12-1.1">
              <p id="section-11.1.12-1.1.1">Algorithm Name: HPKE-3-KE<a href="#section-11.1.12-1.1.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-11.1.12-1.2">
              <p id="section-11.1.12-1.2.1">Algorithm Description: Key Encryption with HPKE using DHKEM(X25519, HKDF-SHA256) KEM, HKDF-SHA256 KDF, and AES-128-GCM AEAD<a href="#section-11.1.12-1.2.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-11.1.12-1.3">
              <p id="section-11.1.12-1.3.1">Algorithm Usage Location(s): "alg"<a href="#section-11.1.12-1.3.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-11.1.12-1.4">
              <p id="section-11.1.12-1.4.1">JOSE Implementation Requirements: Optional<a href="#section-11.1.12-1.4.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-11.1.12-1.5">
              <p id="section-11.1.12-1.5.1">Change Controller: IETF<a href="#section-11.1.12-1.5.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-11.1.12-1.6">
              <p id="section-11.1.12-1.6.1">Specification Document(s): <a href="#ke-algs" class="auto internal xref">Section 6.2</a> of [[ this specification ]]<a href="#section-11.1.12-1.6.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-11.1.12-1.7">
              <p id="section-11.1.12-1.7.1">Algorithm Analysis Documents(s): <span>[<a href="#I-D.ietf-hpke-hpke" class="cite xref">I-D.ietf-hpke-hpke</a>]</span><a href="#section-11.1.12-1.7.1" class="pilcrow">¶</a></p>
</li>
          </ul>
</section>
</div>
<div id="hpke-4-ke">
<section id="section-11.1.13">
          <h4 id="name-hpke-4-ke">
<a href="#section-11.1.13" class="section-number selfRef">11.1.13. </a><a href="#name-hpke-4-ke" class="section-name selfRef">HPKE-4-KE</a>
          </h4>
<ul class="normal">
<li class="normal" id="section-11.1.13-1.1">
              <p id="section-11.1.13-1.1.1">Algorithm Name: HPKE-4-KE<a href="#section-11.1.13-1.1.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-11.1.13-1.2">
              <p id="section-11.1.13-1.2.1">Algorithm Description: Key Encryption with HPKE using DHKEM(X25519, HKDF-SHA256) KEM, HKDF-SHA256 KDF, and ChaCha20Poly1305 AEAD<a href="#section-11.1.13-1.2.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-11.1.13-1.3">
              <p id="section-11.1.13-1.3.1">Algorithm Usage Location(s): "alg"<a href="#section-11.1.13-1.3.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-11.1.13-1.4">
              <p id="section-11.1.13-1.4.1">JOSE Implementation Requirements: Optional<a href="#section-11.1.13-1.4.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-11.1.13-1.5">
              <p id="section-11.1.13-1.5.1">Change Controller: IETF<a href="#section-11.1.13-1.5.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-11.1.13-1.6">
              <p id="section-11.1.13-1.6.1">Specification Document(s): <a href="#ke-algs" class="auto internal xref">Section 6.2</a> of [[ this specification ]]<a href="#section-11.1.13-1.6.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-11.1.13-1.7">
              <p id="section-11.1.13-1.7.1">Algorithm Analysis Documents(s): <span>[<a href="#I-D.ietf-hpke-hpke" class="cite xref">I-D.ietf-hpke-hpke</a>]</span><a href="#section-11.1.13-1.7.1" class="pilcrow">¶</a></p>
</li>
          </ul>
</section>
</div>
<div id="hpke-5-ke">
<section id="section-11.1.14">
          <h4 id="name-hpke-5-ke">
<a href="#section-11.1.14" class="section-number selfRef">11.1.14. </a><a href="#name-hpke-5-ke" class="section-name selfRef">HPKE-5-KE</a>
          </h4>
<ul class="normal">
<li class="normal" id="section-11.1.14-1.1">
              <p id="section-11.1.14-1.1.1">Algorithm Name: HPKE-5-KE<a href="#section-11.1.14-1.1.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-11.1.14-1.2">
              <p id="section-11.1.14-1.2.1">Algorithm Description: Key Encryption with HPKE using DHKEM(X448, HKDF-SHA512) KEM, HKDF-SHA512 KDF, and AES-256-GCM AEAD<a href="#section-11.1.14-1.2.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-11.1.14-1.3">
              <p id="section-11.1.14-1.3.1">Algorithm Usage Location(s): "alg"<a href="#section-11.1.14-1.3.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-11.1.14-1.4">
              <p id="section-11.1.14-1.4.1">JOSE Implementation Requirements: Optional<a href="#section-11.1.14-1.4.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-11.1.14-1.5">
              <p id="section-11.1.14-1.5.1">Change Controller: IETF<a href="#section-11.1.14-1.5.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-11.1.14-1.6">
              <p id="section-11.1.14-1.6.1">Specification Document(s): <a href="#ke-algs" class="auto internal xref">Section 6.2</a> of [[ this specification ]]<a href="#section-11.1.14-1.6.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-11.1.14-1.7">
              <p id="section-11.1.14-1.7.1">Algorithm Analysis Documents(s): <span>[<a href="#I-D.ietf-hpke-hpke" class="cite xref">I-D.ietf-hpke-hpke</a>]</span><a href="#section-11.1.14-1.7.1" class="pilcrow">¶</a></p>
</li>
          </ul>
</section>
</div>
<div id="hpke-6-ke">
<section id="section-11.1.15">
          <h4 id="name-hpke-6-ke">
<a href="#section-11.1.15" class="section-number selfRef">11.1.15. </a><a href="#name-hpke-6-ke" class="section-name selfRef">HPKE-6-KE</a>
          </h4>
<ul class="normal">
<li class="normal" id="section-11.1.15-1.1">
              <p id="section-11.1.15-1.1.1">Algorithm Name: HPKE-6-KE<a href="#section-11.1.15-1.1.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-11.1.15-1.2">
              <p id="section-11.1.15-1.2.1">Algorithm Description: Key Encryption with HPKE using DHKEM(X448, HKDF-SHA512) KEM, HKDF-SHA512 KDF, and ChaCha20Poly1305 AEAD<a href="#section-11.1.15-1.2.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-11.1.15-1.3">
              <p id="section-11.1.15-1.3.1">Algorithm Usage Location(s): "alg"<a href="#section-11.1.15-1.3.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-11.1.15-1.4">
              <p id="section-11.1.15-1.4.1">JOSE Implementation Requirements: Optional<a href="#section-11.1.15-1.4.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-11.1.15-1.5">
              <p id="section-11.1.15-1.5.1">Change Controller: IETF<a href="#section-11.1.15-1.5.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-11.1.15-1.6">
              <p id="section-11.1.15-1.6.1">Specification Document(s): <a href="#ke-algs" class="auto internal xref">Section 6.2</a> of [[ this specification ]]<a href="#section-11.1.15-1.6.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-11.1.15-1.7">
              <p id="section-11.1.15-1.7.1">Algorithm Analysis Documents(s): <span>[<a href="#I-D.ietf-hpke-hpke" class="cite xref">I-D.ietf-hpke-hpke</a>]</span><a href="#section-11.1.15-1.7.1" class="pilcrow">¶</a></p>
</li>
          </ul>
</section>
</div>
<div id="hpke-7-ke">
<section id="section-11.1.16">
          <h4 id="name-hpke-7-ke">
<a href="#section-11.1.16" class="section-number selfRef">11.1.16. </a><a href="#name-hpke-7-ke" class="section-name selfRef">HPKE-7-KE</a>
          </h4>
<ul class="normal">
<li class="normal" id="section-11.1.16-1.1">
              <p id="section-11.1.16-1.1.1">Algorithm Name: HPKE-7-KE<a href="#section-11.1.16-1.1.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-11.1.16-1.2">
              <p id="section-11.1.16-1.2.1">Algorithm Description: Key Encryption with HPKE using DHKEM(P-256, HKDF-SHA256) KEM, HKDF-SHA256 KDF, and AES-256-GCM AEAD<a href="#section-11.1.16-1.2.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-11.1.16-1.3">
              <p id="section-11.1.16-1.3.1">Algorithm Usage Location(s): "alg"<a href="#section-11.1.16-1.3.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-11.1.16-1.4">
              <p id="section-11.1.16-1.4.1">JOSE Implementation Requirements: Optional<a href="#section-11.1.16-1.4.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-11.1.16-1.5">
              <p id="section-11.1.16-1.5.1">Change Controller: IETF<a href="#section-11.1.16-1.5.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-11.1.16-1.6">
              <p id="section-11.1.16-1.6.1">Specification Document(s): <a href="#ke-algs" class="auto internal xref">Section 6.2</a> of [[ this specification ]]<a href="#section-11.1.16-1.6.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-11.1.16-1.7">
              <p id="section-11.1.16-1.7.1">Algorithm Analysis Documents(s): <span>[<a href="#I-D.ietf-hpke-hpke" class="cite xref">I-D.ietf-hpke-hpke</a>]</span><a href="#section-11.1.16-1.7.1" class="pilcrow">¶</a></p>
</li>
          </ul>
</section>
</div>
</section>
</div>
<div id="json-web-signature-and-encryption-header-parameters">
<section id="section-11.2">
        <h3 id="name-json-web-signature-and-encry">
<a href="#section-11.2" class="section-number selfRef">11.2. </a><a href="#name-json-web-signature-and-encry" class="section-name selfRef">JSON Web Signature and Encryption Header Parameters</a>
        </h3>
<p id="section-11.2-1">The following entries are added to the IANA "JSON Web Key Parameters" registry <span>[<a href="#IANA.JOSE" class="cite xref">IANA.JOSE</a>]</span>:<a href="#section-11.2-1" class="pilcrow">¶</a></p>
<div id="ek">
<section id="section-11.2.1">
          <h4 id="name-ek">
<a href="#section-11.2.1" class="section-number selfRef">11.2.1. </a><a href="#name-ek" class="section-name selfRef">ek</a>
          </h4>
<ul class="normal">
<li class="normal" id="section-11.2.1-1.1">
              <p id="section-11.2.1-1.1.1">Header Parameter Name: "ek"<a href="#section-11.2.1-1.1.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-11.2.1-1.2">
              <p id="section-11.2.1-1.2.1">Header Parameter Description: A base64url-encoded encapsulated secret, as defined in <span><a href="https://datatracker.ietf.org/doc/html/draft-ietf-hpke-hpke-02#section-5" class="relref">Section 5</a> of [<a href="#I-D.ietf-hpke-hpke" class="cite xref">I-D.ietf-hpke-hpke</a>]</span><a href="#section-11.2.1-1.2.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-11.2.1-1.3">
              <p id="section-11.2.1-1.3.1">Header Parameter Usage Location(s): JWE<a href="#section-11.2.1-1.3.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-11.2.1-1.4">
              <p id="section-11.2.1-1.4.1">Change Controller: IETF<a href="#section-11.2.1-1.4.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-11.2.1-1.5">
              <p id="section-11.2.1-1.5.1">Specification Document(s): <a href="#encapsulated-secrets" class="auto internal xref">Section 4.2</a> of [[ this specification ]]<a href="#section-11.2.1-1.5.1" class="pilcrow">¶</a></p>
</li>
          </ul>
</section>
</div>
<div id="pskid">
<section id="section-11.2.2">
          <h4 id="name-psk_id">
<a href="#section-11.2.2" class="section-number selfRef">11.2.2. </a><a href="#name-psk_id" class="section-name selfRef">psk_id</a>
          </h4>
<ul class="normal">
<li class="normal" id="section-11.2.2-1.1">
              <p id="section-11.2.2-1.1.1">Header Parameter Name: "psk_id"<a href="#section-11.2.2-1.1.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-11.2.2-1.2">
              <p id="section-11.2.2-1.2.1">Header Parameter Description: A base64url-encoded key identifier (kid) for the pre-shared key, as defined in <span><a href="https://datatracker.ietf.org/doc/html/draft-ietf-hpke-hpke-02#section-5.1.2" class="relref">Section 5.1.2</a> of [<a href="#I-D.ietf-hpke-hpke" class="cite xref">I-D.ietf-hpke-hpke</a>]</span><a href="#section-11.2.2-1.2.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-11.2.2-1.3">
              <p id="section-11.2.2-1.3.1">Header Parameter Usage Location(s): JWE<a href="#section-11.2.2-1.3.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-11.2.2-1.4">
              <p id="section-11.2.2-1.4.1">Change Controller: IETF<a href="#section-11.2.2-1.4.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-11.2.2-1.5">
              <p id="section-11.2.2-1.5.1">Specification Document(s): <a href="#overview" class="auto internal xref">Section 4</a> of [[ this specification ]]<a href="#section-11.2.2-1.5.1" class="pilcrow">¶</a></p>
</li>
          </ul>
</section>
</div>
</section>
</div>
</section>
</div>
<div id="sec-combined-references">
<section id="section-12">
      <h2 id="name-references">
<a href="#section-12" class="section-number selfRef">12. </a><a href="#name-references" class="section-name selfRef">References</a>
      </h2>
<div id="sec-normative-references">
<section id="section-12.1">
        <h3 id="name-normative-references">
<a href="#section-12.1" class="section-number selfRef">12.1. </a><a href="#name-normative-references" class="section-name selfRef">Normative References</a>
        </h3>
<dl class="references">
<dt id="I-D.ietf-hpke-hpke">[I-D.ietf-hpke-hpke]</dt>
        <dd>
<span class="refAuthor">Barnes, R.</span>, <span class="refAuthor">Bhargavan, K.</span>, <span class="refAuthor">Lipp, B.</span>, and <span class="refAuthor">C. A. Wood</span>, <span class="refTitle">"Hybrid Public Key Encryption"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-ietf-hpke-hpke-02</span>, <time datetime="2025-11-04" class="refDate">4 November 2025</time>, <span>&lt;<a href="https://datatracker.ietf.org/doc/html/draft-ietf-hpke-hpke-02">https://datatracker.ietf.org/doc/html/draft-ietf-hpke-hpke-02</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="IANA.JOSE">[IANA.JOSE]</dt>
        <dd>
<span class="refAuthor">IANA</span>, <span class="refTitle">"JSON Web Signature and Encryption Algorithms"</span>, <span>n.d.</span>, <span>&lt;<a href="https://www.iana.org/assignments/jose">https://www.iana.org/assignments/jose</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC2119">[RFC2119]</dt>
        <dd>
<span class="refAuthor">Bradner, S.</span>, <span class="refTitle">"Key words for use in RFCs to Indicate Requirement Levels"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 2119</span>, <span class="seriesInfo">DOI 10.17487/RFC2119</span>, <time datetime="1997-03" class="refDate">March 1997</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc2119">https://www.rfc-editor.org/rfc/rfc2119</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7516">[RFC7516]</dt>
        <dd>
<span class="refAuthor">Jones, M.</span> and <span class="refAuthor">J. Hildebrand</span>, <span class="refTitle">"JSON Web Encryption (JWE)"</span>, <span class="seriesInfo">RFC 7516</span>, <span class="seriesInfo">DOI 10.17487/RFC7516</span>, <time datetime="2015-05" class="refDate">May 2015</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc7516">https://www.rfc-editor.org/rfc/rfc7516</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7517">[RFC7517]</dt>
        <dd>
<span class="refAuthor">Jones, M.</span>, <span class="refTitle">"JSON Web Key (JWK)"</span>, <span class="seriesInfo">RFC 7517</span>, <span class="seriesInfo">DOI 10.17487/RFC7517</span>, <time datetime="2015-05" class="refDate">May 2015</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc7517">https://www.rfc-editor.org/rfc/rfc7517</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8174">[RFC8174]</dt>
        <dd>
<span class="refAuthor">Leiba, B.</span>, <span class="refTitle">"Ambiguity of Uppercase vs Lowercase in RFC 2119 Key Words"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 8174</span>, <span class="seriesInfo">DOI 10.17487/RFC8174</span>, <time datetime="2017-05" class="refDate">May 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc8174">https://www.rfc-editor.org/rfc/rfc8174</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8259">[RFC8259]</dt>
        <dd>
<span class="refAuthor">Bray, T., Ed.</span>, <span class="refTitle">"The JavaScript Object Notation (JSON) Data Interchange Format"</span>, <span class="seriesInfo">STD 90</span>, <span class="seriesInfo">RFC 8259</span>, <span class="seriesInfo">DOI 10.17487/RFC8259</span>, <time datetime="2017-12" class="refDate">December 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc8259">https://www.rfc-editor.org/rfc/rfc8259</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8725">[RFC8725]</dt>
      <dd>
<span class="refAuthor">Sheffer, Y.</span>, <span class="refAuthor">Hardt, D.</span>, and <span class="refAuthor">M. Jones</span>, <span class="refTitle">"JSON Web Token Best Current Practices"</span>, <span class="seriesInfo">BCP 225</span>, <span class="seriesInfo">RFC 8725</span>, <span class="seriesInfo">DOI 10.17487/RFC8725</span>, <time datetime="2020-02" class="refDate">February 2020</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc8725">https://www.rfc-editor.org/rfc/rfc8725</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
</div>
<div id="sec-informative-references">
<section id="section-12.2">
        <h3 id="name-informative-references">
<a href="#section-12.2" class="section-number selfRef">12.2. </a><a href="#name-informative-references" class="section-name selfRef">Informative References</a>
        </h3>
<dl class="references">
<dt id="I-D.ietf-cose-hpke">[I-D.ietf-cose-hpke]</dt>
        <dd>
<span class="refAuthor">Tschofenig, H.</span>, <span class="refAuthor">Steele, O.</span>, <span class="refAuthor">Daisuke, A.</span>, and <span class="refAuthor">L. Lundblade</span>, <span class="refTitle">"Use of Hybrid Public-Key Encryption (HPKE) with CBOR Object Signing and Encryption (COSE)"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-ietf-cose-hpke-18</span>, <time datetime="2025-10-19" class="refDate">19 October 2025</time>, <span>&lt;<a href="https://datatracker.ietf.org/doc/html/draft-ietf-cose-hpke-18">https://datatracker.ietf.org/doc/html/draft-ietf-cose-hpke-18</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="IANA.HPKE">[IANA.HPKE]</dt>
        <dd>
<span class="refAuthor">IANA</span>, <span class="refTitle">"Hybrid Public Key Encryption (HPKE)"</span>, <span>n.d.</span>, <span>&lt;<a href="https://www.iana.org/assignments/hpke">https://www.iana.org/assignments/hpke</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="NIST.SP.800-56Ar3">[NIST.SP.800-56Ar3]</dt>
        <dd>
<span class="refAuthor">National Institute of Standards and Technology</span>, <span class="refTitle">"Recommendation for Pair-Wise Key-Establishment Schemes Using Discrete Logarithm Cryptography, NIST Special Publication 800-56A Revision 3"</span>, <time datetime="2018-04" class="refDate">April 2018</time>, <span>&lt;<a href="https://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-56Ar3.pdf">https://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-56Ar3.pdf</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC4086">[RFC4086]</dt>
        <dd>
<span class="refAuthor">Eastlake 3rd, D.</span>, <span class="refAuthor">Schiller, J.</span>, and <span class="refAuthor">S. Crocker</span>, <span class="refTitle">"Randomness Requirements for Security"</span>, <span class="seriesInfo">BCP 106</span>, <span class="seriesInfo">RFC 4086</span>, <span class="seriesInfo">DOI 10.17487/RFC4086</span>, <time datetime="2005-06" class="refDate">June 2005</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc4086">https://www.rfc-editor.org/rfc/rfc4086</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7515">[RFC7515]</dt>
        <dd>
<span class="refAuthor">Jones, M.</span>, <span class="refAuthor">Bradley, J.</span>, and <span class="refAuthor">N. Sakimura</span>, <span class="refTitle">"JSON Web Signature (JWS)"</span>, <span class="seriesInfo">RFC 7515</span>, <span class="seriesInfo">DOI 10.17487/RFC7515</span>, <time datetime="2015-05" class="refDate">May 2015</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc7515">https://www.rfc-editor.org/rfc/rfc7515</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7518">[RFC7518]</dt>
        <dd>
<span class="refAuthor">Jones, M.</span>, <span class="refTitle">"JSON Web Algorithms (JWA)"</span>, <span class="seriesInfo">RFC 7518</span>, <span class="seriesInfo">DOI 10.17487/RFC7518</span>, <time datetime="2015-05" class="refDate">May 2015</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc7518">https://www.rfc-editor.org/rfc/rfc7518</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC9864">[RFC9864]</dt>
      <dd>
<span class="refAuthor">Jones, M.B.</span> and <span class="refAuthor">O. Steele</span>, <span class="refTitle">"Fully-Specified Algorithms for JSON Object Signing and Encryption (JOSE) and CBOR Object Signing and Encryption (COSE)"</span>, <span class="seriesInfo">RFC 9864</span>, <span class="seriesInfo">DOI 10.17487/RFC9864</span>, <time datetime="2025-10" class="refDate">October 2025</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc9864">https://www.rfc-editor.org/rfc/rfc9864</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
</div>
</section>
</div>
<div id="keys-used-in-examples">
<section id="appendix-A">
      <h2 id="name-keys-used-in-examples">
<a href="#appendix-A" class="section-number selfRef">Appendix A. </a><a href="#name-keys-used-in-examples" class="section-name selfRef">Keys Used in Examples</a>
      </h2>
<div id="int-key">
<section id="appendix-A.1">
        <h3 id="name-integrated-encryption-key">
<a href="#appendix-A.1" class="section-number selfRef">A.1. </a><a href="#name-integrated-encryption-key" class="section-name selfRef">Integrated Encryption Key</a>
        </h3>
<p id="appendix-A.1-1">This private key and its implied public key are used for
the Integrated Encryption example in <a href="#compact-example" class="auto internal xref">Section 5.2</a> and <a href="#flattened-example" class="auto internal xref">Section 5.3</a>:<a href="#appendix-A.1-1" class="pilcrow">¶</a></p>
<div class="lang-text sourcecode" id="appendix-A.1-2">
<pre>
{
  "kty": "EC",
  "use": "enc",
  "alg": "HPKE-0",
  "kid": "yCnfbmYMZcWrKDt_DjNebRCB1vxVoqv4umJ4WK8RYjk",
  "crv": "P-256",
  "x": "gixQJ0qg4Ag-6HSMaIEDL_zbDhoXavMyKlmdn__AQVE",
  "y": "ZxTgRLWaKONCL_GbZKLNPsW9EW6nBsN4AwQGEFAFFbM",
  "d": "g2DXtKapi2oN2zL_RCWX8D4bWURHCKN2-ZNGC05ZaR8"
}
</pre><a href="#appendix-A.1-2" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="ke-key">
<section id="appendix-A.2">
        <h3 id="name-key-encryption-key">
<a href="#appendix-A.2" class="section-number selfRef">A.2. </a><a href="#name-key-encryption-key" class="section-name selfRef">Key Encryption Key</a>
        </h3>
<p id="appendix-A.2-1">This private key and its implied public key are used for
the Key Encryption example in <a href="#general-example" class="auto internal xref">Section 6.3</a>:<a href="#appendix-A.2-1" class="pilcrow">¶</a></p>
<div class="lang-text sourcecode" id="appendix-A.2-2">
<pre>
{
  "kty": "EC",
  "use": "enc",
  "alg": "HPKE-0-KE",
  "kid": "9CfUPiGcAcTp7oXgVbDStw2FEjka-_KHU_i-X3XMCEA",
  "crv": "P-256",
  "x": "WVKOswXQAgntIrLSYlwkyaU1dIE-FIhrbTEotFgMwIA",
  "y": "jpZT1WNmQH752Bh_pDK41IhLkiXLj-15wR4ZBZ-MWFk",
  "d": "MeCnMF65SaRVZ11Gf1Weacx3H9SdzO7MtWcDXvHWNv8"
}
</pre><a href="#appendix-A.2-2" class="pilcrow">¶</a>
</div>
</section>
</div>
</section>
</div>
<div id="acknowledgments">
<section id="appendix-B">
      <h2 id="name-acknowledgments">
<a href="#name-acknowledgments" class="section-name selfRef">Acknowledgments</a>
      </h2>
<p id="appendix-B-1">This specification leverages text from <span>[<a href="#I-D.ietf-cose-hpke" class="cite xref">I-D.ietf-cose-hpke</a>]</span>.
We would like to thank
Richard Barnes,
Brian Campbell,
Matt Chanda,
Ilari Liusvaara,
Neil Madden,
Aaron Parecki,
Filip Skokan,
and
Sebastian Stenzel
for their contributions to the specification.<a href="#appendix-B-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="document-history">
<section id="appendix-C">
      <h2 id="name-document-history">
<a href="#name-document-history" class="section-name selfRef">Document History</a>
      </h2>
<p id="appendix-C-1">-15<a href="#appendix-C-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="appendix-C-2.1">
          <p id="appendix-C-2.1.1">Defined the Integrated Encryption Key Establishment Mode
and updated JWE to enable its use.<a href="#appendix-C-2.1.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="appendix-C-2.2">
          <p id="appendix-C-2.2.1">Specified distinct algorithms for use with Key Encryption and Integrated Encryption
so that they are fully-specified.<a href="#appendix-C-2.2.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="appendix-C-2.3">
          <p id="appendix-C-2.3.1">Updated the Message Encryption and Message Decryption procedures from JWE.<a href="#appendix-C-2.3.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="appendix-C-2.4">
          <p id="appendix-C-2.4.1">Said that JWS and JWE objects can no longer be distinguished by the presence of
an "enc" header parameter.<a href="#appendix-C-2.4.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="appendix-C-2.5">
          <p id="appendix-C-2.5.1">Many editorial improvements.<a href="#appendix-C-2.5.1" class="pilcrow">¶</a></p>
</li>
      </ul>
<p id="appendix-C-3">-14<a href="#appendix-C-3" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="appendix-C-4.1">
          <p id="appendix-C-4.1.1">Added HPKE-7.<a href="#appendix-C-4.1.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="appendix-C-4.2">
          <p id="appendix-C-4.2.1">Update to Recipient_structure.<a href="#appendix-C-4.2.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="appendix-C-4.3">
          <p id="appendix-C-4.3.1">Removed text related to apu and apv.<a href="#appendix-C-4.3.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="appendix-C-4.4">
          <p id="appendix-C-4.4.1">Updated description of mutually known private information.<a href="#appendix-C-4.4.1" class="pilcrow">¶</a></p>
</li>
      </ul>
<p id="appendix-C-5">-13<a href="#appendix-C-5" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="appendix-C-6.1">
          <p id="appendix-C-6.1.1">Removed orphan text about AKP kty field<a href="#appendix-C-6.1.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="appendix-C-6.2">
          <p id="appendix-C-6.2.1">Fixed bug in "include-fold" syntax<a href="#appendix-C-6.2.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="appendix-C-6.3">
          <p id="appendix-C-6.3.1">Switched reference from RFC 9180 to
draft-ietf-hpke-hpke<a href="#appendix-C-6.3.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="appendix-C-6.4">
          <p id="appendix-C-6.4.1">Editorial improvements to abstract and
introduction.<a href="#appendix-C-6.4.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="appendix-C-6.5">
          <p id="appendix-C-6.5.1">Removed Section 8.2 "Static Asymmetric
Authentication in HPKE"<a href="#appendix-C-6.5.1" class="pilcrow">¶</a></p>
</li>
      </ul>
<p id="appendix-C-7">-12<a href="#appendix-C-7" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="appendix-C-8.1">
          <p id="appendix-C-8.1.1">Added the Recipient_structure<a href="#appendix-C-8.1.1" class="pilcrow">¶</a></p>
</li>
      </ul>
<p id="appendix-C-9">-11<a href="#appendix-C-9" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="appendix-C-10.1">
          <p id="appendix-C-10.1.1">Fix too long lines<a href="#appendix-C-10.1.1" class="pilcrow">¶</a></p>
</li>
      </ul>
<p id="appendix-C-11">-10<a href="#appendix-C-11" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="appendix-C-12.1">
          <p id="appendix-C-12.1.1">Addressed WGLC review comments by Neil Madden and Sebastian Stenzel.<a href="#appendix-C-12.1.1" class="pilcrow">¶</a></p>
</li>
      </ul>
<p id="appendix-C-13">-09<a href="#appendix-C-13" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="appendix-C-14.1">
          <p id="appendix-C-14.1.1">Corrected examples.<a href="#appendix-C-14.1.1" class="pilcrow">¶</a></p>
</li>
      </ul>
<p id="appendix-C-15">-08<a href="#appendix-C-15" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="appendix-C-16.1">
          <p id="appendix-C-16.1.1">Use "enc":"int" for integrated encryption.<a href="#appendix-C-16.1.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="appendix-C-16.2">
          <p id="appendix-C-16.2.1">Described reasons for excluding authenticated HPKE.<a href="#appendix-C-16.2.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="appendix-C-16.3">
          <p id="appendix-C-16.3.1">Stated that mutually known private information <span class="bcp14">MAY</span> be used as the HPKE info value.<a href="#appendix-C-16.3.1" class="pilcrow">¶</a></p>
</li>
      </ul>
<p id="appendix-C-17">-07<a href="#appendix-C-17" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="appendix-C-18.1">
          <p id="appendix-C-18.1.1">Clarifications<a href="#appendix-C-18.1.1" class="pilcrow">¶</a></p>
</li>
      </ul>
<p id="appendix-C-19">-06<a href="#appendix-C-19" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="appendix-C-20.1">
          <p id="appendix-C-20.1.1">Remove auth mode and auth_kid from the specification.<a href="#appendix-C-20.1.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="appendix-C-20.2">
          <p id="appendix-C-20.2.1">HPKE AAD for JOSE HPKE Key Encryption is now empty.<a href="#appendix-C-20.2.1" class="pilcrow">¶</a></p>
</li>
      </ul>
<p id="appendix-C-21">-05<a href="#appendix-C-21" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="appendix-C-22.1">
          <p id="appendix-C-22.1.1">Removed incorrect text about HPKE algorithm names.<a href="#appendix-C-22.1.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="appendix-C-22.2">
          <p id="appendix-C-22.2.1">Fixed #21: Comply with NIST SP 800-227 Recommendations for Key-Encapsulation Mechanisms.<a href="#appendix-C-22.2.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="appendix-C-22.3">
          <p id="appendix-C-22.3.1">Fixed #19: Binding the Application Context.<a href="#appendix-C-22.3.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="appendix-C-22.4">
          <p id="appendix-C-22.4.1">Fixed #18: Use of apu and apv in Recipient context.<a href="#appendix-C-22.4.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="appendix-C-22.5">
          <p id="appendix-C-22.5.1">Added new Section 7.1 (Authentication using an Asymmetric Key).<a href="#appendix-C-22.5.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="appendix-C-22.6">
          <p id="appendix-C-22.6.1">Updated Section 7.2 (Key Management) to prevent cross-protocol attacks.<a href="#appendix-C-22.6.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="appendix-C-22.7">
          <p id="appendix-C-22.7.1">Updated HPKE Setup info parameter to be empty.<a href="#appendix-C-22.7.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="appendix-C-22.8">
          <p id="appendix-C-22.8.1">Added details on HPKE AEAD AAD, compression and decryption for HPKE Integrated Encryption.<a href="#appendix-C-22.8.1" class="pilcrow">¶</a></p>
</li>
      </ul>
<p id="appendix-C-23">-04<a href="#appendix-C-23" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="appendix-C-24.1">
          <p id="appendix-C-24.1.1">Fixed #8: Use short algorithm identifiers, per the JOSE naming conventions.<a href="#appendix-C-24.1.1" class="pilcrow">¶</a></p>
</li>
      </ul>
<p id="appendix-C-25">-03<a href="#appendix-C-25" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="appendix-C-26.1">
          <p id="appendix-C-26.1.1">Added new section 7.1 to discuss Key Management.<a href="#appendix-C-26.1.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="appendix-C-26.2">
          <p id="appendix-C-26.2.1">HPKE Setup info parameter is updated to carry JOSE context-specific data for both modes.<a href="#appendix-C-26.2.1" class="pilcrow">¶</a></p>
</li>
      </ul>
<p id="appendix-C-27">-02<a href="#appendix-C-27" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="appendix-C-28.1">
          <p id="appendix-C-28.1.1">Fixed #4: HPKE Integrated Encryption "enc: dir".<a href="#appendix-C-28.1.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="appendix-C-28.2">
          <p id="appendix-C-28.2.1">Updated text on the use of HPKE Setup info parameter.<a href="#appendix-C-28.2.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="appendix-C-28.3">
          <p id="appendix-C-28.3.1">Added Examples in Sections 5.1, 5.2 and 6.1.<a href="#appendix-C-28.3.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="appendix-C-28.4">
          <p id="appendix-C-28.4.1">Use of registered HPKE  "alg" value in the recipient unprotected header for Key Encryption.<a href="#appendix-C-28.4.1" class="pilcrow">¶</a></p>
</li>
      </ul>
<p id="appendix-C-29">-01<a href="#appendix-C-29" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="appendix-C-30.1">
          <p id="appendix-C-30.1.1">Apply feedback from call for adoption.<a href="#appendix-C-30.1.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="appendix-C-30.2">
          <p id="appendix-C-30.2.1">Provide examples of auth and psk modes for JSON and Compact Serializations<a href="#appendix-C-30.2.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="appendix-C-30.3">
          <p id="appendix-C-30.3.1">Simplify description of HPKE modes<a href="#appendix-C-30.3.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="appendix-C-30.4">
          <p id="appendix-C-30.4.1">Adjust IANA registration requests<a href="#appendix-C-30.4.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="appendix-C-30.5">
          <p id="appendix-C-30.5.1">Remove HPKE Mode from named algorithms<a href="#appendix-C-30.5.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="appendix-C-30.6">
          <p id="appendix-C-30.6.1">Fix AEAD named algorithms<a href="#appendix-C-30.6.1" class="pilcrow">¶</a></p>
</li>
      </ul>
<p id="appendix-C-31">-00<a href="#appendix-C-31" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="appendix-C-32.1">
          <p id="appendix-C-32.1.1">Created initial working group version from draft-rha-jose-hpke-encrypt-07<a href="#appendix-C-32.1.1" class="pilcrow">¶</a></p>
</li>
      </ul>
</section>
</div>
<div id="authors-addresses">
<section id="appendix-D">
      <h2 id="name-authors-addresses">
<a href="#name-authors-addresses" class="section-name selfRef">Authors' Addresses</a>
      </h2>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Tirumaleswar Reddy</span></div>
<div dir="auto" class="left"><span class="org">Nokia</span></div>
<div dir="auto" class="left">
<span class="locality">Bangalore</span> </div>
<div dir="auto" class="left"><span class="region">Karnataka</span></div>
<div dir="auto" class="left"><span class="country-name">India</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:kondtir@gmail.com" class="email">kondtir@gmail.com</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Hannes Tschofenig</span></div>
<div dir="auto" class="left"><span class="org">University of Applied Sciences Bonn-Rhein-Sieg</span></div>
<div dir="auto" class="left"><span class="country-name">Germany</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:hannes.tschofenig@gmx.net" class="email">hannes.tschofenig@gmx.net</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Aritra Banerjee</span></div>
<div dir="auto" class="left"><span class="org">Nokia</span></div>
<div dir="auto" class="left"><span class="locality">London</span></div>
<div dir="auto" class="left"><span class="country-name">United Kingdom</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:aritra.banerjee@nokia.com" class="email">aritra.banerjee@nokia.com</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Orie Steele</span></div>
<div dir="auto" class="left"><span class="org">Tradeverifyd</span></div>
<div dir="auto" class="left"><span class="country-name">United States</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:orie@or13.io" class="email">orie@or13.io</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Michael B. Jones</span></div>
<div dir="auto" class="left"><span class="org">Self-Issued Consulting</span></div>
<div dir="auto" class="left"><span class="country-name">United States</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:michael_b_jones@hotmail.com" class="email">michael_b_jones@hotmail.com</a>
</div>
<div class="url">
<span>URI:</span>
<a href="https://self-issued.info/" class="url">https://self-issued.info/</a>
</div>
</address>
</section>
</div>
<script>const toc = document.getElementById("toc");
toc.querySelector("h2").addEventListener("click", e => {
  toc.classList.toggle("active");
});
toc.querySelector("nav").addEventListener("click", e => {
  toc.classList.remove("active");
});
</script>
</body>
</html>
