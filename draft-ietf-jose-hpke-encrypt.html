<!DOCTYPE html>
<html lang="en" class="Internet-Draft">
<head>
<meta charset="utf-8">
<meta content="Common,Latin" name="scripts">
<meta content="initial-scale=1.0" name="viewport">
<title>Use of Hybrid Public Key Encryption (HPKE) with JSON Object Signing and Encryption (JOSE)</title>
<meta content="Tirumaleswar Reddy" name="author">
<meta content="Hannes Tschofenig" name="author">
<meta content="Aritra Banerjee" name="author">
<meta content="Orie Steele" name="author">
<meta content="Michael B. Jones" name="author">
<meta content="
       This specification defines Hybrid Public Key Encryption (HPKE) for use with
JSON Object Signing and Encryption (JOSE). HPKE offers a variant of public key encryption
of arbitrary-sized plaintexts for a recipient public key, and provides security
against adaptive chosen ciphertext attacks (IND-CCA2-secure). 
       HPKE also includes a variant that authenticates possession of a pre-shared key.
HPKE works for any combination of an asymmetric KEM, key derivation
function (KDF), and authenticated encryption with additional data
(AEAD) encryption function. 
       This document defines the use of HPKE with JOSE.
The specification chooses a specific subset of the HPKE features to use with JOSE. 
    " name="description">
<meta content="xml2rfc 3.30.2" name="generator">
<meta content="HPKE" name="keyword">
<meta content="JOSE" name="keyword">
<meta content="JWE" name="keyword">
<meta content="Hybrid" name="keyword">
<meta content="draft-ietf-jose-hpke-encrypt-latest" name="ietf.draft">
<!-- Generator version information:
  xml2rfc 3.30.2
    Python 3.12.11
    ConfigArgParse 1.7
    google-i18n-address 3.1.1
    intervaltree 3.1.0
    Jinja2 3.1.6
    lxml 5.3.1
    platformdirs 4.4.0
    pycountry 24.6.1
    PyYAML 6.0.2
    requests 2.32.5
    setuptools 80.9.0
    wcwidth 0.2.14
-->
<link href="draft-ietf-jose-hpke-encrypt.xml" rel="alternate" type="application/rfc+xml">
<link href="#copyright" rel="license">
<style type="text/css">@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0460-052F, U+1C80-1C88, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
}
@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
}
@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-vietnamese.woff2') format('woff2');
  unicode-range: U+0102-0103, U+0110-0111, U+1EA0-1EF9, U+20AB;
}
@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}

@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0460-052F, U+1C80-1C88, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-cyrillic.woff2') format('woff2');
  unicode-range: U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-vietnamese.woff2') format('woff2');
  unicode-range: U+0102-0103, U+0110-0111, U+1EA0-1EF9, U+20AB;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}

@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0460-052F, U+1C80-1C88, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-cyrillic.woff2') format('woff2');
  unicode-range: U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-vietnamese.woff2') format('woff2');
  unicode-range: U+0102-0103, U+0110-0111, U+1EA0-1EF9, U+20AB;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 600;
  font-display: swap;
  src: local('Lora SemiBold'), local('Lora-SemiBold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-semibold-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}

@font-face {
  font-family: 'Oxygen Mono';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Oxygen Mono'), local('OxygenMono-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/oxygenmono-regular-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Oxygen Mono';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Oxygen Mono'), local('OxygenMono-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/oxygenmono-regular-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}

@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: italic;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-italic-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0460-052F, U+1C80-1C8A, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: italic;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-italic-cyrillic.woff2') format('woff2');
  unicode-range: U+0301, U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: italic;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-italic-greek.woff2') format('woff2');
  unicode-range: U+0370-0377, U+037A-037F, U+0384-038A, U+038C, U+038E-03A1, U+03A3-03FF;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: italic;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-italic-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-02BA, U+02BD-02C5, U+02C7-02CC, U+02CE-02D7, U+02DD-02FF, U+0304, U+0308, U+0329, U+1D00-1DBF, U+1E00-1E9F, U+1EF2-1EFF, U+2020, U+20A0-20AB, U+20AD-20C0, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: italic;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-italic-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+0304, U+0308, U+0329, U+2000-206F, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: normal;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-regular-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0460-052F, U+1C80-1C8A, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: normal;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-regular-cyrillic.woff2') format('woff2');
  unicode-range: U+0301, U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: normal;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-regular-greek.woff2') format('woff2');
  unicode-range: U+0370-0377, U+037A-037F, U+0384-038A, U+038C, U+038E-03A1, U+03A3-03FF;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: normal;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-regular-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-02BA, U+02BD-02C5, U+02C7-02CC, U+02CE-02D7, U+02DD-02FF, U+0304, U+0308, U+0329, U+1D00-1DBF, U+1E00-1E9F, U+1EF2-1EFF, U+2020, U+20A0-20AB, U+20AD-20C0, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: normal;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-regular-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+0304, U+0308, U+0329, U+2000-206F, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}

:root {
  color-scheme: light dark;
  --background-color: #fff;
  --text-color: #222;
  --title-color: #191919;
  --link-color: #2a6496;
  --highlight-color: #f9f9f9;
  --line-color: #eee;
  --pilcrow-weak: #ddd;
  --pilcrow-strong: #bbb;
  --small-font-size: 14.5px;
  --font-mono: 'Oxygen Mono', monospace;
  --font-title: "Sofia Sans Semi Condensed", sans-serif;
  scrollbar-color: #bbb #eee;
}
body {
  max-width: 600px;
  margin: 75px auto;
  padding: 0 5px;
  color: var(--text-color);
  background-color: var(--background-color);
  font: 16px/22px "Lora", serif;
  scroll-behavior: smooth;
}

.ears {
  display: none;
}

/* headings */
section {
  clear: both;
}
.section-number {
  padding-right: 0.5em;
}
h1, h2, h3, h4, h5, h6 {
  font-family: var(--font-title);
  font-weight: 680;
  margin: 0.8em 0 0.3em;
  font-size-adjust: 0.5;
  color: var(--title-color);
}
h1#title {
  font-size: 32px;
  line-height: 40px;
  clear: both;
}
h1#title, h1#rfcnum {
  margin: 1.5em 0 0.2em;
}
h1#rfcnum + h1#title {
  margin: 0.2em 0;
}

h1, h2, h3 {
  font-size: 22px;
  line-height: 27px;
}
h4, h5, h6 {
  font-size: 20px;
  line-height: 24px;
}

/* general structure */
.author {
  padding-bottom: 0.3em;
  vertical-align: top;
}
#abstract+p {
  font-size: 18px;
  line-height: 24px;
}
#abstract+p code, #abstract+p samp, #abstract+p tt {
  font-size: 16px;
  line-height: 0;
}

p {
  padding: 0;
  margin: 0.5em 0;
  text-align: left;
}
div {
  margin: 0;
}
.alignRight.art-text {
  background-color: var(--highlight-color);
  border: 1px solid var(--line-color);
  border-radius: 3px;
  padding: 0.5em 1em 0;
  margin-bottom: 0.5em;
}
.alignRight.art-text pre {
  padding: 0;
  width: auto;
}
.alignRight {
  margin: 1em 0;
}
.alignRight > *:first-child {
  border: none;
  margin: 0;
  float: right;
  clear: both;
}
.alignRight > *:nth-child(2) {
  clear: both;
  display: block;
  border: none;
}
svg {
  display: block;
}
/* font-family isn't space-separated, but =~ will have to do */
svg[font-family~="monospace" i], svg [font-family~="monospace" i] {
  font-family: var(--font-mono);
}
.alignCenter.art-text {
  background-color: var(--highlight-color);
  border: 1px solid var(--line-color);
  border-radius: 3px;
  padding: 0.5em 1em 0;
  margin-bottom: 0.5em;
}
.alignCenter.art-text pre {
  padding: 0;
  width: auto;
}
.alignCenter {
  margin: 1em 0;
}
.alignCenter > *:first-child {
  border: none;
  /* this isn't optimal, but it's an existence proof.  PrinceXML doesn't
     support flexbox yet.
  */
  display: table;
  margin: 0 auto;
}

/* lists */
ol, ul {
  padding: 0;
  margin: 0 0 0.5em 2em;
  & :is(ol, ul) {
    margin-left: 1em;
  }
}
li {
  margin: 0 0 0.25em 0;
}
ul.empty, .ulEmpty {
  list-style-type: none;
  & li {
    margin-top: 0.5em;
  }
}
:is(ul, ol).compact, .ulCompact, .olCompact {
  margin: 0 0 0 2em;
  & li {
    margin: 0;
    & :first-child { margin-top: 0; }
    & :last-child { margin-bottom: 0; }
  }
}

/* definition lists */
dl {
  clear: left;
  --indent: 3ch;
  /* --indent: attr(indent ch); not supported in any browser, but we can dream */
  &.olPercent {
    --indent: 5ch;
    & > dt {
      min-width: calc(var(--indent) - 2ch);
    }
  }
  &.olPercent > dt {
    float: none;
  }

  dl > dd > & {
    margin-top: 0.5em;
    margin-bottom: 0;
  }
}
dl:not(.dlNewline) > dt {
  float: left;
  margin-right: 2ch;
  min-width: 8ch;
}
dl > dd {
  margin-bottom: .8em;
  margin-left: var(--indent) !important; /* stupid element overrides */
  min-height: 2ex;
}
:is(dl.compact, .dlCompact) > dd {
  margin-bottom: 0;
  & > :is(:first-child, .break:first-child + *) {
    margin-top: 0;
  }
  & > :is(:last-child) {
    margin-bottom: 0;
  }
}
:is(dd, span).break {
  display: none;
}

/* links */
a, a[href].selfRef:hover {
  text-decoration: none;
}
a[href] {
  color: var(--link-color);
}
a[href].selfRef, .iref + a[href].internal {
  color: var(--text-color);
}
a[href]:hover {
  text-decoration: underline;
}
a[href].selfRef:hover {
  background-color: var(--highlight-color);
}
a.xref:is(.cite, .auto), :is(#status-of-memo, #copyright) a {
  white-space: nowrap;
}

/* Figures */
tt, code, pre {
  background-color: var(--highlight-color);
  font: 14px/22px var(--font-mono);
}
tt, code {
  /* changing the font for inline elements leads to different ascender
     and descender heights; as we want to retain baseline alignment,
     remove leading to avoid altering the final height of lines
     note: this fails if these blocks take an entire line,
     a different solution would be great */
  line-height: 0;
}
:is(h1, h2, h3, h4, h5, h6) :is(tt, code) {
  font-size: 84%;
}
pre {
  border: 1px solid var(--line-color);
  font-size: 13.5px;
  line-height: 16px;
  letter-spacing: -0.2px;
  margin: 5px;
  padding: 5px;
}
img {
  max-width: 100%;
}
figure {
  margin: 0.5em 0;
  padding: 0;
}
figure blockquote {
  margin: 0.8em 0.4em 0.4em;
}
figcaption, caption {
  font-style: italic;
  margin: 0.5em 1.5em;
  text-align: left;
  caption-side: bottom;
}
@media screen {
  /* Auto-collapse boilerplate. */
  :is(#status-of-memo, #copyright) p {
    margin: -2px 0;
    max-height: 0;
    transition: max-height 2s ease, margin 0.5s ease 0.5s;
    overflow: hidden;
  }
  :is(#status-of-memo, #copyright):hover p,
  :is(#status-of-memo, #copyright) h2:target ~ p {
    margin: 0.5em 0;
    max-height: 500px;
    overflow: auto;
  }
  pre, svg {
    display: inline-block;
    /* In the horizontal direction, sometimes people make over-sized figures.
       Scrollbars for those is therefore necessary: auto adds them as necessary..
       In the vertical direction, the line-height can combine with the font
       asender/descender height to produce scrollbars: hidden avoids that. */
    overflow: auto hidden;
  }
  pre {
    max-width: 100%;
    width: calc(100% - 22px - 1em);
  }
  svg {
    max-width: calc(100% - 22px - 1em);
  }
  figure pre {
    display: block;
    width: calc(100% - 25px);
  }
  :is(pre, svg) + .pilcrow {
    display: inline-block;
    vertical-align: text-bottom;
    padding-bottom: 8px;
  }
}

/* aside, blockquote */
aside, blockquote {
  margin-left: 0;
  padding: 0 2em;
  font-style: italic;
}
blockquote {
  margin: 1em 0;
}
cite {
  display: block;
  text-align: right;
  font-style: italic;
}

/* tables */
table {
  width: auto;
  max-width: 100%;
  margin: 0 0 1em;
  border-collapse: collapse;
}
table.right {
  margin-left: auto;
}
table.center {
  margin-left: auto;
  margin-right: auto;
}
table.left {
  margin-right: auto;
}
table .text-left {
  text-align: left;
}
table .text-center {
  text-align: center;
}
table .text-right {
  text-align: right;
}

thead, tbody {
  border: 1px solid var(--line-color);
}
th, td {
  text-align: left;
  vertical-align: top;
  padding: 5px 10px;
}
th {
  background-color: var(--line-color);
}
:is(tr:nth-child(2n), thead+tbody > tr:nth-child(2n+1)) > td {
  background-color: var(--background-color);
}
:is(tr:nth-child(2n+1), thead+tbody > tr:nth-child(2n)) > td {
  background-color: var(--highlight-color);
}
table caption {
  margin: 0;
  padding: 3px 0 3px 1em;
}
table p {
  margin: 0;
}

/* pilcrow */
a.pilcrow {
  margin-left: 3px;
  opacity: 0.2;
  user-select: none;
  &[href] {
    color: var(--pilcrow-weak);
    &:hover { text-decoration: none; }
  }
}
@media not print {
  :hover > a.pilcrow {
    opacity: 1;
  }
  a.pilcrow[href]:hover {
    color: var(--pilcrow-strong);
    background-color: transparent;
  }
}
@media print {
  a.pilcrow {
    display: none;
  }
}

/* misc */
hr {
  border: 0;
  border-top: 1px solid var(--line-color);
}
.bcp14 {
  font-variant: small-caps;
  font-weight: 600;
  font-size: var(--small-font-size);
}
.role {
  font-variant: all-small-caps;
}
sub, sup {
  line-height: 1;
  font-size: 80%;
}

/* info block */
#identifiers {
  margin: 0;
  font-size: var(--small-font-size);
  line-height: 18px;
  --identifier-width: 15ch;
  & dt {
    width: var(--identifier-width);
    min-width: var(--identifier-width);
    clear: left;
    float: left;
    text-align: right;
    margin-right: 1ch;
  }
  & dd {
    margin: 0;
    margin-left: calc(1em + var(--identifier-width)) !important;
    min-width: 5em;
  }
  & .authors {
    & .author {
      display: inline-block;
      margin-right: 1.5em;
    }
    & .org {
      font-style: italic;
    }
  }
}

/* The prepared/rendered info at the very bottom of the page */
.docInfo {
  color: #999;
  font-size: 0.9em;
  font-style: italic;
  margin-top: 2em;
}
.docInfo .prepared {
  float: right;
}

/* table of contents */
#toc {
  padding: 0.75em 0 2em 0;
  margin-bottom: 1em;

  & nav {
    & ul {
      margin: 0 0.5em 0 0;
      padding: 0;
      list-style: none;
    }
    & li {
      line-height: 1.3em;
      margin: 2px 0;
      padding-left: 1.2em;
      text-indent: -1.2em;
    }
  }
  & a.xref {
    white-space: normal;
  }
}

.references {
  & > dt {
    text-align: right;
    font-weight: bold;
    min-width: 10ch;
    margin-right: 1.5ch;
    &:target::before {
      content: "⇒";
      margin: 0 10px 0 -25px;
    }
  }
  & > dd {
    margin-left: 12ch !important;
    overflow: visible;
    & .refInstance {
      margin-bottom: 0.8em;
    }
    & .ascii {
      margin-bottom: 0.25em;
    }
  }
}

#rfc\.index\.index + ul {
  margin-left: 0;
}

/* authors */
address.vcard {
  font-style: normal;
  max-width: 20em;
  margin: 1em auto 1em 0;

  & .nameRole {
    font-weight: 700;
    margin-left: 0;
  }
  & .label {
    margin: 0.5em 0;
  }
  & .type {
    display: none;
  }
  & .alternative-contact {
    margin: 0.5em 0 0.25em 0;
  }
  & .non-ascii {
    margin: 0 0 0 2em;
  }
  & div.left {
    text-align: left;
  }
  & div.right {
    text-align: right;
  }
}

hr.addr {
  border-top: 1px dashed;
  margin: 0;
  color: #ddd;
  max-width: calc(100% - 16px);
}
@media (min-width: 500px) {
  #authors-addresses > section {
    column-count: 2;
    column-gap: 20px;
  }
  #authors-addresses > section > h2 {
    column-span: all;
  }
  /* hack for break-inside: avoid-column */
  #authors-addresses address {
    display: inline-block;
    break-inside: avoid-column;
  }
}

/* Comments */
.rfcEditorRemove p:first-of-type {
  font-style: italic;
}
.cref {
  background-color: rgba(249, 232, 105, 0.3);
  padding: 2px 4px;
}
.crefSource {
  font-style: italic;
}

@media screen {
  #toc nav {
    font-family: var(--font-title);
    font-weight: 360;
    & > ul { margin-bottom: 2em; }
    & ul {
      margin: 0 0 0 4px;
      & :is(p, li) {
        margin: 2px 0;
      }
    }
  }
  #toc a.toplink {
    float: right;
  }
}
@media not screen {
  #toc a.toplink {
    display: none;
  }
}


/* TOC layout for smaller screens */
@media screen and (max-width: 929px) {
  #toc {
    position: fixed;
    z-index: 2;
    top: 0;
    right: 0;
    padding: 1px 0 0 0;
    margin: 0;
    border-bottom: 1px solid #ccc;
    opacity: 0.6;
  }
  #toc h2 {
    margin: 0;
    padding: 2px 0 2px 6px;
    padding-right: 1em;
    font-size: 18px;
    line-height: 24px;
    min-width: 190px;
    text-align: right;
    background-color: #444;
    color: white;
    cursor: pointer;
    &::before { /* css hamburger */
      float: right;
      position: relative;
      width: 1em;
      height: 1px;
      left: -164px;
      margin: 8px 0 0 0;
      background: white none repeat scroll 0 0;
      box-shadow: 0 4px 0 0 white, 0 8px 0 0 white;
      content: "";
    }
  }
  #toc nav {
    display: none;
    background-color: var(--background-color);
    padding: 0.5em 1em 1em;
    overflow: auto;
    overscroll-behavior: contain;
    height: calc(100vh - 48px);
    border-left: 1px solid #ddd;
  }
  #toc.active {
    opacity: 1;
    & nav { display: block; }
  }
  /* Make the collapsed ToC header render white on gray also when it's a link */
  #toc h2 a,
  #toc h2 a:is(:link, :focus, :hover),
  #toc a.toplink,
  #toc a.toplink:hover {
    color: white;
    background-color: #444;
    text-decoration: none;
  }
  #toc a.toplink {
    margin: 2px 0.5em 0;
  }
}

/* TOC layout for wide screens */
@media screen and (min-width: 930px) {
  body {
    padding-right: 360px;
    padding-right: calc(min(180px + 20%, 500px));
  }
  #toc {
    position: fixed;
    bottom: 0;
    right: 0;
    right: calc(50vw - 480px);
    width: 312px;
    margin: 0;
    padding: 0;
    z-index: 1;
  }
  #toc h2 {
    margin: 0;
    padding: 0.25em 1em 1em 0;
  }
  #toc nav {
    display: block;
    height: calc(90vh - 84px);
    bottom: 0;
    padding: 0.5em 0 2em;
    overflow: auto;
    overscroll-behavior: contain;
    scrollbar-width: thin;
  }
  img { /* future proofing */
    max-width: 100%;
    height: auto;
  }
  #toc a.toplink {
    margin: 8px 0.5em 0;
  }
}

/* pagination */
@media print {
  body {
    width: 100%;
  }
  p {
    orphans: 3;
    widows: 3;
  }
  #n-copyright-notice {
    border-bottom: none;
  }
  #toc, #n-introduction {
    page-break-before: always;
  }
  #toc {
    border-top: none;
    padding-top: 0;
  }
  figure, pre, .vcard {
    page-break-inside: avoid;
  }
  h1, h2, h3, h4, h5, h6 {
    page-break-after: avoid;
  }
  :is(h2, h3, h4, h5, h6)+*, dd {
    page-break-before: avoid;
  }
  pre {
    white-space: pre-wrap;
    word-wrap: break-word;
    font-size: 10pt;
  }
  table {
    border: 1px solid #ddd;
  }
  td {
    border-top: 1px solid #ddd;
  }
}

@page :first {
  padding-top: 0;
  @top-left {
    content: normal;
    border: none;
  }
  @top-center {
    content: normal;
    border: none;
  }
  @top-right {
    content: normal;
    border: none;
  }
}

@page {
  size: A4;
  margin-bottom: 45mm;
  padding-top: 20px;
}

/* Dark mode. */
@media (prefers-color-scheme: dark) {
:root {
  --background-color: #121212;
  --text-color: #f0f0f0;
  --title-color: #fff;
  --link-color: #4da4f0;
  --highlight-color: #282828;
  --line-color: #444;
  --pilcrow-weak: #444;
  --pilcrow-strong: #666;
  scrollbar-color: #777 #333;
}
}

/* SVG Trick: a prefix match works because only black and white are allowed */
svg :is([stroke="black"], [stroke^="#000"]) {
  stroke: var(--text-color);
}
svg :is([stroke="white"], [stroke^="#fff"]) {
  stroke: var(--background-color);
}
svg :is([fill="black"], [fill^="#000"], :not([fill])) {
  fill: var(--text-color);
}
svg :is([fill="white"], [fill^="#fff"]) {
  fill: var(--background-color);
}
</style>

</head>
<body class="xml2rfc">
<table class="ears">
<thead><tr>
<td class="left">Internet-Draft</td>
<td class="center">Use of HPKE in JOSE</td>
<td class="right">October 2025</td>
</tr></thead>
<tfoot><tr>
<td class="left">Reddy, et al.</td>
<td class="center">Expires 8 April 2026</td>
<td class="right">[Page]</td>
</tr></tfoot>
</table>
<div id="external-metadata" class="document-information"></div>
<div id="internal-metadata" class="document-information">
<dl id="identifiers">
<dt class="label-workgroup">Workgroup:</dt>
<dd class="workgroup">JOSE</dd>
<dt class="label-internet-draft">Internet-Draft:</dt>
<dd class="internet-draft">draft-ietf-jose-hpke-encrypt-latest</dd>
<dt class="label-updates">Updates:</dt>
<dd class="updates">
<a href="https://www.rfc-editor.org/rfc/rfc7516" class="eref">7516</a> (if approved)</dd>
<dt class="label-published">Published:</dt>
<dd class="published">
<time datetime="2025-10-05" class="published">5 October 2025</time>
    </dd>
<dt class="label-intended-status">Intended Status:</dt>
<dd class="intended-status">Standards Track</dd>
<dt class="label-expires">Expires:</dt>
<dd class="expires"><time datetime="2026-04-08">8 April 2026</time></dd>
<dt class="label-authors">Authors:</dt>
<dd class="authors">
<div class="author">
      <div class="author-name">T. Reddy</div>
<div class="org">Nokia</div>
</div>
<div class="author">
      <div class="author-name">H. Tschofenig</div>
<div class="org">H-BRS</div>
</div>
<div class="author">
      <div class="author-name">A. Banerjee</div>
<div class="org">Nokia</div>
</div>
<div class="author">
      <div class="author-name">O. Steele</div>
<div class="org">Tradeverifyd</div>
</div>
<div class="author">
      <div class="author-name">M. Jones</div>
<div class="org">Self-Issued Consulting</div>
</div>
</dd>
</dl>
</div>
<h1 id="title">Use of Hybrid Public Key Encryption (HPKE) with JSON Object Signing and Encryption (JOSE)</h1>
<section id="section-abstract">
      <h2 id="abstract"><a href="#abstract" class="selfRef">Abstract</a></h2>
<p id="section-abstract-1">This specification defines Hybrid Public Key Encryption (HPKE) for use with
JSON Object Signing and Encryption (JOSE). HPKE offers a variant of public key encryption
of arbitrary-sized plaintexts for a recipient public key, and provides security
against adaptive chosen ciphertext attacks (IND-CCA2-secure).<a href="#section-abstract-1" class="pilcrow">¶</a></p>
<p id="section-abstract-2">HPKE also includes a variant that authenticates possession of a pre-shared key.
HPKE works for any combination of an asymmetric KEM, key derivation
function (KDF), and authenticated encryption with additional data
(AEAD) encryption function.<a href="#section-abstract-2" class="pilcrow">¶</a></p>
<p id="section-abstract-3">This document defines the use of HPKE with JOSE.
The specification chooses a specific subset of the HPKE features to use with JOSE.<a href="#section-abstract-3" class="pilcrow">¶</a></p>
</section>
<section class="note rfcEditorRemove" id="section-note.1">
      <h2 id="name-about-this-document">
<a href="#name-about-this-document" class="section-name selfRef">About This Document</a>
      </h2>
<p id="section-note.1-1">This note is to be removed before publishing as an RFC.<a href="#section-note.1-1" class="pilcrow">¶</a></p>
<p id="section-note.1-2">
        The latest revision of this draft can be found at <span><a href="https://ietf-wg-jose.github.io/draft-ietf-jose-hpke-encrypt/draft-ietf-jose-hpke-encrypt.html">https://ietf-wg-jose.github.io/draft-ietf-jose-hpke-encrypt/draft-ietf-jose-hpke-encrypt.html</a></span>.
        Status information for this document may be found at <span><a href="https://datatracker.ietf.org/doc/draft-ietf-jose-hpke-encrypt/">https://datatracker.ietf.org/doc/draft-ietf-jose-hpke-encrypt/</a></span>.<a href="#section-note.1-2" class="pilcrow">¶</a></p>
<p id="section-note.1-3">
        Discussion of this document takes place on the
        jose Working Group mailing list (<span><a href="mailto:jose@ietf.org">mailto:jose@ietf.org</a></span>),
        which is archived at <span><a href="https://mailarchive.ietf.org/arch/browse/jose/">https://mailarchive.ietf.org/arch/browse/jose/</a></span>.
        Subscribe at <span><a href="https://www.ietf.org/mailman/listinfo/jose/">https://www.ietf.org/mailman/listinfo/jose/</a></span>.<a href="#section-note.1-3" class="pilcrow">¶</a></p>
<p id="section-note.1-4">Source for this draft and an issue tracker can be found at
        <span><a href="https://github.com/ietf-wg-jose/draft-ietf-jose-hpke-encrypt">https://github.com/ietf-wg-jose/draft-ietf-jose-hpke-encrypt</a></span>.<a href="#section-note.1-4" class="pilcrow">¶</a></p>
</section>
<div id="status-of-memo">
<section id="section-boilerplate.1">
        <h2 id="name-status-of-this-memo">
<a href="#name-status-of-this-memo" class="section-name selfRef">Status of This Memo</a>
        </h2>
<p id="section-boilerplate.1-1">
        This Internet-Draft is submitted in full conformance with the
        provisions of BCP 78 and BCP 79.<a href="#section-boilerplate.1-1" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-2">
        Internet-Drafts are working documents of the Internet Engineering Task
        Force (IETF). Note that other groups may also distribute working
        documents as Internet-Drafts. The list of current Internet-Drafts is
        at <span><a href="https://datatracker.ietf.org/drafts/current/">https://datatracker.ietf.org/drafts/current/</a></span>.<a href="#section-boilerplate.1-2" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-3">
        Internet-Drafts are draft documents valid for a maximum of six months
        and may be updated, replaced, or obsoleted by other documents at any
        time. It is inappropriate to use Internet-Drafts as reference
        material or to cite them other than as "work in progress."<a href="#section-boilerplate.1-3" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-4">
        This Internet-Draft will expire on 8 April 2026.<a href="#section-boilerplate.1-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="copyright">
<section id="section-boilerplate.2">
        <h2 id="name-copyright-notice">
<a href="#name-copyright-notice" class="section-name selfRef">Copyright Notice</a>
        </h2>
<p id="section-boilerplate.2-1">
            Copyright (c) 2025 IETF Trust and the persons identified as the
            document authors. All rights reserved.<a href="#section-boilerplate.2-1" class="pilcrow">¶</a></p>
<p id="section-boilerplate.2-2">
            This document is subject to BCP 78 and the IETF Trust's Legal
            Provisions Relating to IETF Documents
            (<span><a href="https://trustee.ietf.org/license-info">https://trustee.ietf.org/license-info</a></span>) in effect on the date of
            publication of this document. Please review these documents
            carefully, as they describe your rights and restrictions with
            respect to this document. Code Components extracted from this
            document must include Revised BSD License text as described in
            Section 4.e of the Trust Legal Provisions and are provided without
            warranty as described in the Revised BSD License.<a href="#section-boilerplate.2-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="toc">
<section id="section-toc.1">
        <a href="#" onclick="scroll(0,0)" class="toplink">▲</a><h2 id="name-table-of-contents">
<a href="#name-table-of-contents" class="section-name selfRef">Table of Contents</a>
        </h2>
<nav class="toc"><ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1">
            <p id="section-toc.1-1.1.1" class="keepWithNext"><a href="#section-1" class="auto internal xref">1</a>.  <a href="#name-introduction" class="internal xref">Introduction</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2">
            <p id="section-toc.1-1.2.1" class="keepWithNext"><a href="#section-2" class="auto internal xref">2</a>.  <a href="#name-conventions-and-definitions" class="internal xref">Conventions and Definitions</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3">
            <p id="section-toc.1-1.3.1" class="keepWithNext"><a href="#section-3" class="auto internal xref">3</a>.  <a href="#name-conventions-and-terminology" class="internal xref">Conventions and Terminology</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4">
            <p id="section-toc.1-1.4.1"><a href="#section-4" class="auto internal xref">4</a>.  <a href="#name-overview" class="internal xref">Overview</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.1">
                <p id="section-toc.1-1.4.2.1.1"><a href="#section-4.1" class="auto internal xref">4.1</a>.  <a href="#name-auxiliary-authenticated-app" class="internal xref">Auxiliary Authenticated Application Information</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.2">
                <p id="section-toc.1-1.4.2.2.1"><a href="#section-4.2" class="auto internal xref">4.2</a>.  <a href="#name-encapsulated-keys" class="internal xref">Encapsulated Keys</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5">
            <p id="section-toc.1-1.5.1"><a href="#section-5" class="auto internal xref">5</a>.  <a href="#name-integrated-encryption" class="internal xref">Integrated Encryption</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.1">
                <p id="section-toc.1-1.5.2.1.1"><a href="#section-5.1" class="auto internal xref">5.1</a>.  <a href="#name-compact-example" class="internal xref">Compact Example</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6">
            <p id="section-toc.1-1.6.1"><a href="#section-6" class="auto internal xref">6</a>.  <a href="#name-key-encryption" class="internal xref">Key Encryption</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.1">
                <p id="section-toc.1-1.6.2.1.1"><a href="#section-6.1" class="auto internal xref">6.1</a>.  <a href="#name-recipient_structure" class="internal xref">Recipient_structure</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.1.2.1">
                    <p id="section-toc.1-1.6.2.1.2.1.1"><a href="#section-6.1.1" class="auto internal xref">6.1.1</a>.  <a href="#name-deterministic-serialization" class="internal xref">Deterministic Serialization for HPKE <code>info</code></a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.2">
                <p id="section-toc.1-1.6.2.2.1"><a href="#section-6.2" class="auto internal xref">6.2</a>.  <a href="#name-json-example" class="internal xref">JSON Example</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7">
            <p id="section-toc.1-1.7.1"><a href="#section-7" class="auto internal xref">7</a>.  <a href="#name-mapping-hpke-keys-to-jwk-fo" class="internal xref">Mapping HPKE Keys to JWK for JOSE</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.1">
                <p id="section-toc.1-1.7.2.1.1"><a href="#section-7.1" class="auto internal xref">7.1</a>.  <a href="#name-jwk-representation-of-a-jos" class="internal xref">JWK Representation of a JOSE-HPKE Key with HPKE Ciphersuite</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8">
            <p id="section-toc.1-1.8.1"><a href="#section-8" class="auto internal xref">8</a>.  <a href="#name-security-considerations" class="internal xref">Security Considerations</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.1">
                <p id="section-toc.1-1.8.2.1.1"><a href="#section-8.1" class="auto internal xref">8.1</a>.  <a href="#name-key-management" class="internal xref">Key Management</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.2">
                <p id="section-toc.1-1.8.2.2.1"><a href="#section-8.2" class="auto internal xref">8.2</a>.  <a href="#name-review-jwt-best-current-pra" class="internal xref">Review JWT Best Current Practices</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9">
            <p id="section-toc.1-1.9.1"><a href="#section-9" class="auto internal xref">9</a>.  <a href="#name-ciphersuite-registration" class="internal xref">Ciphersuite Registration</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10">
            <p id="section-toc.1-1.10.1"><a href="#section-10" class="auto internal xref">10</a>. <a href="#name-iana-considerations" class="internal xref">IANA Considerations</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10.2.1">
                <p id="section-toc.1-1.10.2.1.1"><a href="#section-10.1" class="auto internal xref">10.1</a>.  <a href="#name-json-web-signature-and-encr" class="internal xref">JSON Web Signature and Encryption Algorithms</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10.2.1.2.1">
                    <p id="section-toc.1-1.10.2.1.2.1.1"><a href="#section-10.1.1" class="auto internal xref">10.1.1</a>.  <a href="#name-hpke-0" class="internal xref">HPKE-0</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10.2.1.2.2">
                    <p id="section-toc.1-1.10.2.1.2.2.1"><a href="#section-10.1.2" class="auto internal xref">10.1.2</a>.  <a href="#name-hpke-1" class="internal xref">HPKE-1</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10.2.1.2.3">
                    <p id="section-toc.1-1.10.2.1.2.3.1"><a href="#section-10.1.3" class="auto internal xref">10.1.3</a>.  <a href="#name-hpke-2" class="internal xref">HPKE-2</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10.2.1.2.4">
                    <p id="section-toc.1-1.10.2.1.2.4.1"><a href="#section-10.1.4" class="auto internal xref">10.1.4</a>.  <a href="#name-hpke-3" class="internal xref">HPKE-3</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10.2.1.2.5">
                    <p id="section-toc.1-1.10.2.1.2.5.1"><a href="#section-10.1.5" class="auto internal xref">10.1.5</a>.  <a href="#name-hpke-4" class="internal xref">HPKE-4</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10.2.1.2.6">
                    <p id="section-toc.1-1.10.2.1.2.6.1"><a href="#section-10.1.6" class="auto internal xref">10.1.6</a>.  <a href="#name-hpke-5" class="internal xref">HPKE-5</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10.2.1.2.7">
                    <p id="section-toc.1-1.10.2.1.2.7.1"><a href="#section-10.1.7" class="auto internal xref">10.1.7</a>.  <a href="#name-hpke-6" class="internal xref">HPKE-6</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10.2.1.2.8">
                    <p id="section-toc.1-1.10.2.1.2.8.1"><a href="#section-10.1.8" class="auto internal xref">10.1.8</a>.  <a href="#name-int" class="internal xref">int</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10.2.2">
                <p id="section-toc.1-1.10.2.2.1"><a href="#section-10.2" class="auto internal xref">10.2</a>.  <a href="#name-json-web-signature-and-encry" class="internal xref">JSON Web Signature and Encryption Header Parameters</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10.2.2.2.1">
                    <p id="section-toc.1-1.10.2.2.2.1.1"><a href="#section-10.2.1" class="auto internal xref">10.2.1</a>.  <a href="#name-ek" class="internal xref">ek</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10.2.2.2.2">
                    <p id="section-toc.1-1.10.2.2.2.2.1"><a href="#section-10.2.2" class="auto internal xref">10.2.2</a>.  <a href="#name-psk_id" class="internal xref">psk_id</a></p>
</li>
                </ul>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11">
            <p id="section-toc.1-1.11.1"><a href="#section-11" class="auto internal xref">11</a>. <a href="#name-references" class="internal xref">References</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11.2.1">
                <p id="section-toc.1-1.11.2.1.1"><a href="#section-11.1" class="auto internal xref">11.1</a>.  <a href="#name-normative-references" class="internal xref">Normative References</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11.2.2">
                <p id="section-toc.1-1.11.2.2.1"><a href="#section-11.2" class="auto internal xref">11.2</a>.  <a href="#name-informative-references" class="internal xref">Informative References</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.12">
            <p id="section-toc.1-1.12.1"><a href="#appendix-A" class="auto internal xref">Appendix A</a>.  <a href="#name-keys-used-in-examples" class="internal xref">Keys Used in Examples</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.13">
            <p id="section-toc.1-1.13.1"><a href="#appendix-B" class="auto internal xref"></a><a href="#name-acknowledgments" class="internal xref">Acknowledgments</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.14">
            <p id="section-toc.1-1.14.1"><a href="#appendix-C" class="auto internal xref"></a><a href="#name-document-history" class="internal xref">Document History</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.15">
            <p id="section-toc.1-1.15.1"><a href="#appendix-D" class="auto internal xref"></a><a href="#name-authors-addresses" class="internal xref">Authors' Addresses</a></p>
</li>
        </ul>
</nav>
</section>
</div>
<div id="introduction">
<section id="section-1">
      <h2 id="name-introduction">
<a href="#section-1" class="section-number selfRef">1. </a><a href="#name-introduction" class="section-name selfRef">Introduction</a>
      </h2>
<p id="section-1-1">Hybrid Public Key Encryption (HPKE) <span>[<a href="#I-D.ietf-hpke-hpke" class="cite xref">I-D.ietf-hpke-hpke</a>]</span> is a public key encryption
(PKE) scheme that provides encryption of arbitrary-sized plaintexts given a
recipient's public key.<a href="#section-1-1" class="pilcrow">¶</a></p>
<p id="section-1-2">This specification enables JSON Web Encryption (JWE) to leverage HPKE,
bringing support for KEMs and the possibility of Hybrid KEMs to JWE.<a href="#section-1-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="conventions-and-definitions">
<section id="section-2">
      <h2 id="name-conventions-and-definitions">
<a href="#section-2" class="section-number selfRef">2. </a><a href="#name-conventions-and-definitions" class="section-name selfRef">Conventions and Definitions</a>
      </h2>
<p id="section-2-1">The key words "<span class="bcp14">MUST</span>", "<span class="bcp14">MUST NOT</span>", "<span class="bcp14">REQUIRED</span>", "<span class="bcp14">SHALL</span>", "<span class="bcp14">SHALL NOT</span>", "<span class="bcp14">SHOULD</span>", "<span class="bcp14">SHOULD NOT</span>", "<span class="bcp14">RECOMMENDED</span>", "<span class="bcp14">NOT RECOMMENDED</span>",
"<span class="bcp14">MAY</span>", and "<span class="bcp14">OPTIONAL</span>" in this document are to be interpreted as
described in BCP 14 <span>[<a href="#RFC2119" class="cite xref">RFC2119</a>]</span> <span>[<a href="#RFC8174" class="cite xref">RFC8174</a>]</span> when, and only when, they
appear in all capitals, as shown here.<a href="#section-2-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="conventions-and-terminology">
<section id="section-3">
      <h2 id="name-conventions-and-terminology">
<a href="#section-3" class="section-number selfRef">3. </a><a href="#name-conventions-and-terminology" class="section-name selfRef">Conventions and Terminology</a>
      </h2>
<p id="section-3-1">This specification uses the following abbreviations and terms:<a href="#section-3-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3-2.1">
          <p id="section-3-2.1.1">Content Encryption Key (CEK), is defined in <span>[<a href="#RFC7517" class="cite xref">RFC7517</a>]</span>.<a href="#section-3-2.1.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-3-2.2">
          <p id="section-3-2.2.1">Hybrid Public Key Encryption (HPKE) is defined in <span>[<a href="#I-D.ietf-hpke-hpke" class="cite xref">I-D.ietf-hpke-hpke</a>]</span>.<a href="#section-3-2.2.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-3-2.3">
          <p id="section-3-2.3.1">pkR is the public key of the recipient, as defined in <span>[<a href="#I-D.ietf-hpke-hpke" class="cite xref">I-D.ietf-hpke-hpke</a>]</span>.<a href="#section-3-2.3.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-3-2.4">
          <p id="section-3-2.4.1">skR is the private key of the recipient, as defined in <span>[<a href="#I-D.ietf-hpke-hpke" class="cite xref">I-D.ietf-hpke-hpke</a>]</span>.<a href="#section-3-2.4.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-3-2.5">
          <p id="section-3-2.5.1">Key Encapsulation Mechanism (KEM), see <span>[<a href="#I-D.ietf-hpke-hpke" class="cite xref">I-D.ietf-hpke-hpke</a>]</span>.<a href="#section-3-2.5.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-3-2.6">
          <p id="section-3-2.6.1">Key Derivation Function (KDF), see <span>[<a href="#I-D.ietf-hpke-hpke" class="cite xref">I-D.ietf-hpke-hpke</a>]</span>.<a href="#section-3-2.6.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-3-2.7">
          <p id="section-3-2.7.1">Authenticated Encryption with Associated Data (AEAD), see <span>[<a href="#I-D.ietf-hpke-hpke" class="cite xref">I-D.ietf-hpke-hpke</a>]</span> and <span>[<a href="#RFC7516" class="cite xref">RFC7516</a>]</span>.<a href="#section-3-2.7.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-3-2.8">
          <p id="section-3-2.8.1">Additional Authenticated Data (AAD), see <span>[<a href="#I-D.ietf-hpke-hpke" class="cite xref">I-D.ietf-hpke-hpke</a>]</span> and <span>[<a href="#RFC7516" class="cite xref">RFC7516</a>]</span>.<a href="#section-3-2.8.1" class="pilcrow">¶</a></p>
</li>
      </ul>
</section>
</div>
<div id="overview">
<section id="section-4">
      <h2 id="name-overview">
<a href="#section-4" class="section-number selfRef">4. </a><a href="#name-overview" class="section-name selfRef">Overview</a>
      </h2>
<p id="section-4-1">This specification defines two modes of use for HPKE in JWE:<a href="#section-4-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4-2.1">
          <p id="section-4-2.1.1">HPKE JWE Integrated Encryption, where HPKE is used to encrypt the plaintext.<a href="#section-4-2.1.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-4-2.2">
          <p id="section-4-2.2.1">HPKE JWE Key Encryption, where HPKE is used to encrypt a content encryption key (CEK) and the CEK is subsequently used to encrypt the plaintext.<a href="#section-4-2.2.1" class="pilcrow">¶</a></p>
</li>
      </ul>
<p id="section-4-3">When "alg" is a JOSE-HPKE algorithm:<a href="#section-4-3" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4-4.1">
          <p id="section-4-4.1.1">If "enc" is "int", HPKE JWE Integrated Encryption is used.<a href="#section-4-4.1.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-4-4.2">
          <p id="section-4-4.2.1">If "enc" is an AEAD algorithm, the recipient Key Management mode is Key Encryption.<a href="#section-4-4.2.1" class="pilcrow">¶</a></p>
</li>
      </ul>
<p id="section-4-5">The HPKE KEM, KDF, and AEAD used depend on the JOSE-HPKE algorithm used. This HPKE AEAD is used internally by HPKE and is distinct from the AEAD algorithm specified in "enc".<a href="#section-4-5" class="pilcrow">¶</a></p>
<p id="section-4-6">HPKE supports two modes, which are described in Table 1 of <span>[<a href="#I-D.ietf-hpke-hpke" class="cite xref">I-D.ietf-hpke-hpke</a>]</span>.<a href="#section-4-6" class="pilcrow">¶</a></p>
<p id="section-4-7">In JOSE-HPKE, both "mode_base" and "mode_psk" are supported.
When "psk_id" JOSE Header parameter is present the mode is "mode_psk", otherwise the mode is "mode_base".<a href="#section-4-7" class="pilcrow">¶</a></p>
<p id="section-4-8">JWE supports different serializations, including Compact JWE Serialization as described in <span><a href="https://rfc-editor.org/rfc/rfc7516#section-3.1" class="relref">Section 3.1</a> of [<a href="#RFC7516" class="cite xref">RFC7516</a>]</span>, General JWE JSON Serialization as described in <span><a href="https://rfc-editor.org/rfc/rfc7516#section-3.2" class="relref">Section 3.2</a> of [<a href="#RFC7516" class="cite xref">RFC7516</a>]</span>.<a href="#section-4-8" class="pilcrow">¶</a></p>
<p id="section-4-9">Certain JWE features are only supported in specific serializations.<a href="#section-4-9" class="pilcrow">¶</a></p>
<p id="section-4-10">For example Compact JWE Serialization does not support the following:<a href="#section-4-10" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4-11.1">
          <p id="section-4-11.1.1">additional authenticated data<a href="#section-4-11.1.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-4-11.2">
          <p id="section-4-11.2.1">multiple recipients<a href="#section-4-11.2.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-4-11.3">
          <p id="section-4-11.3.1">unprotected headers<a href="#section-4-11.3.1" class="pilcrow">¶</a></p>
</li>
      </ul>
<p id="section-4-12">HPKE JWE Key Encryption can be used with "aad" but only when not expressed with Compact JWE Serialization.<a href="#section-4-12" class="pilcrow">¶</a></p>
<p id="section-4-13">Single recipient HPKE JWE Key Encryption with no "aad" can be expressed in Compact JWE Serialization, so long as the recipient and sender use the same HPKE Setup process as described in <span><a href="https://datatracker.ietf.org/doc/html/draft-ietf-hpke-hpke-01#section-5" class="relref">Section 5</a> of [<a href="#I-D.ietf-hpke-hpke" class="cite xref">I-D.ietf-hpke-hpke</a>]</span>.<a href="#section-4-13" class="pilcrow">¶</a></p>
<p id="section-4-14">This specification updates the "enc" definition in <span><a href="https://rfc-editor.org/rfc/rfc7516#section-4.1.2" class="relref">Section 4.1.2</a> of [<a href="#RFC7516" class="cite xref">RFC7516</a>]</span>
by allowing the "enc" value "int" when the "alg" value is a JOSE-HPKE algorithm.
When "alg" is not a JOSE-HPKE algorithm and the "enc" value is "int",
the input <span class="bcp14">MUST NOT</span> be used and <span class="bcp14">MUST</span> be rejected.<a href="#section-4-14" class="pilcrow">¶</a></p>
<div id="auxiliary-authenticated-application-information">
<section id="section-4.1">
        <h3 id="name-auxiliary-authenticated-app">
<a href="#section-4.1" class="section-number selfRef">4.1. </a><a href="#name-auxiliary-authenticated-app" class="section-name selfRef">Auxiliary Authenticated Application Information</a>
        </h3>
<p id="section-4.1-1">The HPKE "aad parameter" for Open() and Seal()
specified in <span><a href="https://datatracker.ietf.org/doc/html/draft-ietf-hpke-hpke-01#section-8.1" class="relref">Section 8.1</a> of [<a href="#I-D.ietf-hpke-hpke" class="cite xref">I-D.ietf-hpke-hpke</a>]</span>
is used with both HPKE JWE Integrated Encryption and HPKE JWE Key Encryption.
Its value is the Additional Authenticated Data encryption parameter value
computed in Step 14 of <span><a href="https://rfc-editor.org/rfc/rfc7518#section-5.1" class="relref">Section 5.1</a> of [<a href="#RFC7518" class="cite xref">RFC7518</a>]</span> (Message Encryption).<a href="#section-4.1-1" class="pilcrow">¶</a></p>
<p id="section-4.1-2">Despite similarities to ECDH-ES,
this specification does not use the <code>apu</code> and <code>apv</code> header parameters,
which are described in <span><a href="https://rfc-editor.org/rfc/rfc7518#section-4.6.1" class="relref">Section 4.6.1</a> of [<a href="#RFC7518" class="cite xref">RFC7518</a>]</span>.<a href="#section-4.1-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="encapsulated-keys">
<section id="section-4.2">
        <h3 id="name-encapsulated-keys">
<a href="#section-4.2" class="section-number selfRef">4.2. </a><a href="#name-encapsulated-keys" class="section-name selfRef">Encapsulated Keys</a>
        </h3>
<p id="section-4.2-1">HPKE encapsulated key is defined in <span><a href="https://datatracker.ietf.org/doc/html/draft-ietf-hpke-hpke-01#section-5" class="relref">Section 5</a> of [<a href="#I-D.ietf-hpke-hpke" class="cite xref">I-D.ietf-hpke-hpke</a>]</span>.<a href="#section-4.2-1" class="pilcrow">¶</a></p>
<p id="section-4.2-2">In HPKE JWE Integrated Encryption, the JWE Encrypted Key of the sole recipient is the HPKE encapsulated key.<a href="#section-4.2-2" class="pilcrow">¶</a></p>
<p id="section-4.2-3">In HPKE JWE Key Encryption, each recipient JWE Encrypted Key is the encrypted content encryption key, and the value of JOSE Header parameter "ek"
is base64url-encoded HPKE encapsulated key.<a href="#section-4.2-3" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="integrated-encryption">
<section id="section-5">
      <h2 id="name-integrated-encryption">
<a href="#section-5" class="section-number selfRef">5. </a><a href="#name-integrated-encryption" class="section-name selfRef">Integrated Encryption</a>
      </h2>
<p id="section-5-1">In HPKE JWE Integrated Encryption:<a href="#section-5-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-5-2.1">
          <p id="section-5-2.1.1">The protected header <span class="bcp14">MUST</span> contain an "alg" that is JOSE-HPKE algorithm.<a href="#section-5-2.1.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-5-2.2">
          <p id="section-5-2.2.1">The protected header <span class="bcp14">MUST</span> contain an "enc" with value "int". This is an explicit exception to requirement in <span><a href="https://rfc-editor.org/rfc/rfc7516#section-4.1.2" class="relref">Section 4.1.2</a> of [<a href="#RFC7516" class="cite xref">RFC7516</a>]</span> that
"enc" must be an AEAD algorithm. This is appropriate, as HPKE will perform plaintext encryption.<a href="#section-5-2.2.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-5-2.3">
          <p id="section-5-2.3.1">The protected header parameters "psk_id" <span class="bcp14">MAY</span> be present.<a href="#section-5-2.3.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-5-2.4">
          <p id="section-5-2.4.1">The protected header parameter "ek" <span class="bcp14">MUST NOT</span> be present.<a href="#section-5-2.4.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-5-2.5">
          <p id="section-5-2.5.1">There <span class="bcp14">MUST</span> be exactly one recipient.<a href="#section-5-2.5.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-5-2.6">
          <p id="section-5-2.6.1">The JWE Encrypted Key <span class="bcp14">MUST</span> be encapsulated key, as defined in <span><a href="https://datatracker.ietf.org/doc/html/draft-ietf-hpke-hpke-01#section-5" class="relref">Section 5</a> of [<a href="#I-D.ietf-hpke-hpke" class="cite xref">I-D.ietf-hpke-hpke</a>]</span>.<a href="#section-5-2.6.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-5-2.7">
          <p id="section-5-2.7.1">The JWE Initialization Vector and JWE Authentication Tag <span class="bcp14">MUST</span> be the empty octet sequence.<a href="#section-5-2.7.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-5-2.8">
          <p id="section-5-2.8.1">The JWE AAD <span class="bcp14">MAY</span> be present when using the JWE JSON Serialization.<a href="#section-5-2.8.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-5-2.9">
          <p id="section-5-2.9.1">The JWE Ciphertext is the ciphertext defined in <span><a href="https://datatracker.ietf.org/doc/html/draft-ietf-hpke-hpke-01#section-5.2" class="relref">Section 5.2</a> of [<a href="#I-D.ietf-hpke-hpke" class="cite xref">I-D.ietf-hpke-hpke</a>]</span>.<a href="#section-5-2.9.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-5-2.10">
          <p id="section-5-2.10.1">The HPKE info parameter defaults to the empty string; mutually known private information <span class="bcp14">MAY</span> be used instead. The concept of mutually known private information is defined in <span>[<a href="#NIST.SP.800-56Ar3" class="cite xref">NIST.SP.800-56Ar3</a>]</span> as an input to the key derivation function.<a href="#section-5-2.10.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-5-2.11">
          <p id="section-5-2.11.1">The HPKE aad parameter <span class="bcp14">MUST</span> be set to the "Additional Authenticated Data encryption parameter", as specified in Step 14 of <span><a href="https://rfc-editor.org/rfc/rfc7516#section-5.1" class="relref">Section 5.1</a> of [<a href="#RFC7516" class="cite xref">RFC7516</a>]</span>.<a href="#section-5-2.11.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-5-2.12">
          <p id="section-5-2.12.1">Then follow Steps 11-19 of <span><a href="https://rfc-editor.org/rfc/rfc7516#section-5.1" class="relref">Section 5.1</a> of [<a href="#RFC7516" class="cite xref">RFC7516</a>]</span> (Message Encryption).<a href="#section-5-2.12.1" class="pilcrow">¶</a></p>
</li>
      </ul>
<p id="section-5-3">When decrypting, the checks in <span><a href="https://rfc-editor.org/rfc/rfc7516#section-5.2" class="relref">Section 5.2</a> of [<a href="#RFC7516" class="cite xref">RFC7516</a>]</span>,
Steps 1 through 5 <span class="bcp14">MUST</span> be performed. The JWE Encrypted Key in Step 2 is the
base64url-encoded encapsulated key.<a href="#section-5-3" class="pilcrow">¶</a></p>
<div id="compact-example">
<section id="section-5.1">
        <h3 id="name-compact-example">
<a href="#section-5.1" class="section-number selfRef">5.1. </a><a href="#name-compact-example" class="section-name selfRef">Compact Example</a>
        </h3>
<p id="section-5.1-1">Below is an example of a Compact JWE using HPKE integrated encryption:<a href="#section-5.1-1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-5.1-2">
<pre>
=============== NOTE: '\' line wrapping per RFC 8792 ================

eyJhbGciOiAiSFBLRS0wIiwgImVuYyI6ICJpbnQiLCAia2lkIjogIkc1Tl9fQ3FNdl9r\
SkdpZUdTRnVBdWd2bDBqclFKQ1ozeUt3Vks2c1VNNG8ifQ.BIh6I40uiBbK8-\
UK7nHdo3ISEfgwJ_MF3zWjQzLt00GhFF2-\
1VgWKHSYLXdeVeRV7AinyocYiCYmISvW0yqiDmc..Ov-\
                                    llz6VUyiw8nZL0OPGLGZckLTm5UcTZFg.
</pre><a href="#section-5.1-2" class="pilcrow">¶</a>
</div>
<p id="section-5.1-3">The keys used for this example are in <a href="#keys-used" class="auto internal xref">Appendix A</a>.<a href="#section-5.1-3" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="key-encryption">
<section id="section-6">
      <h2 id="name-key-encryption">
<a href="#section-6" class="section-number selfRef">6. </a><a href="#name-key-encryption" class="section-name selfRef">Key Encryption</a>
      </h2>
<p id="section-6-1">When using the JWE JSON Serialization,
recipients using JOSE-HPKE can be added alongside other recipients
(e.g., those using <code>ECDH-ES+A128KW</code> or <code>RSA-OAEP-256</code>),
since HPKE is used to encrypt the Content Encryption Key,
which is then processed as specified in JWE.<a href="#section-6-1" class="pilcrow">¶</a></p>
<p id="section-6-2">The encoding of the protected header remains consistent with existing JWE rules.<a href="#section-6-2" class="pilcrow">¶</a></p>
<p id="section-6-3">In HPKE JWE Key Encryption:<a href="#section-6-3" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-6-4.1">
          <p id="section-6-4.1.1">The Key Management Mode is Key Encryption.<a href="#section-6-4.1.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-6-4.2">
          <p id="section-6-4.2.1">When all recipients use the same HPKE algorithm to secure the Content Encryption Key, the JWE Protected Header <span class="bcp14">SHOULD</span> contain "alg".
Otherwise, the JWE Protected Header (and JWE Shared Unprotected Header) <span class="bcp14">MUST NOT</span> contain "alg".<a href="#section-6-4.2.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-6-4.3">
          <p id="section-6-4.3.1">JOSE Header parameter "alg" <span class="bcp14">MUST</span> be a JOSE-HPKE algorithm.<a href="#section-6-4.3.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-6-4.4">
          <p id="section-6-4.4.1">JOSE Header parameter "psk_id" <span class="bcp14">MAY</span> be present.<a href="#section-6-4.4.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-6-4.5">
          <p id="section-6-4.5.1">JOSE Header parameter "ek" <span class="bcp14">MUST</span> be present and contain the base64url-encoded HPKE encapsulated key.<a href="#section-6-4.5.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-6-4.6">
          <p id="section-6-4.6.1">Recipient JWE Encrypted Key <span class="bcp14">MUST</span> be the ciphertext from HPKE Encryption.<a href="#section-6-4.6.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-6-4.7">
          <p id="section-6-4.7.1">The HPKE info parameter contains the encoding of the Recipient_structure, which is described in <a href="#recipient_structure" class="auto internal xref">Section 6.1</a>.<a href="#section-6-4.7.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-6-4.8">
          <p id="section-6-4.8.1">The HPKE AAD parameter defaults to the empty string; externally provided information <span class="bcp14">MAY</span> be used instead.<a href="#section-6-4.8.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-6-4.9">
          <p id="section-6-4.9.1">THE HPKE plaintext <span class="bcp14">MUST</span> be set to the CEK.<a href="#section-6-4.9.1" class="pilcrow">¶</a></p>
</li>
      </ul>
<p id="section-6-5">The processing of "enc", "iv", "tag", "aad", and "ciphertext" is as already defined in <span>[<a href="#RFC7516" class="cite xref">RFC7516</a>]</span>.
Implementations process these parameters as defined in <span>[<a href="#RFC7516" class="cite xref">RFC7516</a>]</span>;
no additional processing requirements are introduced by HPKE-based key encryption.<a href="#section-6-5" class="pilcrow">¶</a></p>
<div id="recipient_structure">
<section id="section-6.1">
        <h3 id="name-recipient_structure">
<a href="#section-6.1" class="section-number selfRef">6.1. </a><a href="#name-recipient_structure" class="section-name selfRef">Recipient_structure</a>
        </h3>
<p id="section-6.1-1">The <code>Recipient_structure</code> is a JSON object with the following members:<a href="#section-6.1-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-6.1-2.1">
            <p id="section-6.1-2.1.1">context (string): This member <span class="bcp14">MUST</span> include the constant string value "JOSE HPKE Recipient".<a href="#section-6.1-2.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-6.1-2.2">
            <p id="section-6.1-2.2.1">next_layer_alg (string): Identifies the algorithm with which the HPKE-encrypted key <span class="bcp14">MUST</span> be used. Its value <span class="bcp14">MUST</span> match the "enc" (encryption algorithm) header parameter in the JWE protected header. This field is included for alignment with the COSE HPKE <span>[<a href="#I-D.ietf-cose-hpke" class="cite xref">I-D.ietf-cose-hpke</a>]</span> specification. Currently, there are no known attacks that allow a downgrade attack of the content encryption algorithm.<a href="#section-6.1-2.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-6.1-2.3">
            <p id="section-6.1-2.3.1">recipient_protected_header (object): This member contains the base64url-encoded JWE Per-Recipient Unprotected Header (see JWE JSON Serialization in <span><a href="https://rfc-editor.org/rfc/rfc7156#section-7.1" class="relref">Section 7.1</a> of [<a href="#RFC7156" class="cite xref">RFC7156</a>]</span> of the recipients member. To serialize this header member the procedure from Section 3.3 of RFC 7638 <span class="bcp14">MUST</span> be used. Unlike with RFC 7638, all members from this member are included except for the "ek" member. The inclusion of this data in the <code>Recipient_structure</code> allows context information to be included in the key derivation.<a href="#section-6.1-2.3.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-6.1-2.4">
            <p id="section-6.1-2.4.1">recipient_extra_info (string): Contains additional context information that the application includes in the key derivation via the HPKE <code>info</code> parameter. Mutually known private information, which is defined in <span>[<a href="#NIST.SP.800-56Ar3" class="cite xref">NIST.SP.800-56Ar3</a>]</span>, <span class="bcp14">MAY</span> be used in this input parameter. If no additional context is provided, this value <span class="bcp14">MUST</span> be the empty string "".<a href="#section-6.1-2.4.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<div id="deterministic-serialization-for-hpke-info">
<section id="section-6.1.1">
          <h4 id="name-deterministic-serialization">
<a href="#section-6.1.1" class="section-number selfRef">6.1.1. </a><a href="#name-deterministic-serialization" class="section-name selfRef">Deterministic Serialization for HPKE <code>info</code></a>
          </h4>
<p id="section-6.1.1-1">JSON texts that are semantically identical can serialize differently (e.g., member order, whitespace), which would lead to divergent <code>info</code> values and failed key agreement.<a href="#section-6.1.1-1" class="pilcrow">¶</a></p>
<p id="section-6.1.1-2">To produce the HPKE <code>info</code> byte string from a <code>Recipient_structure</code>, both sides <span class="bcp14">MUST</span> produce the deterministic JSON representation using the JSON Web Key (JWK) Thumbprint serialization rules <span>[<a href="#RFC7638" class="cite xref">RFC7638</a>]</span>:<a href="#section-6.1.1-2" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-6.1.1-3">
<li id="section-6.1.1-3.1">
              <p id="section-6.1.1-3.1.1">Construct the <code>Recipient_structure</code> JSON object exactly as defined <a href="#recipient_structure" class="auto internal xref">Section 6.1</a>.<a href="#section-6.1.1-3.1.1" class="pilcrow">¶</a></p>
</li>
            <li id="section-6.1.1-3.2">
              <p id="section-6.1.1-3.2.1">Prepare the JSON structure based on Section 3.3 of RFC 7638.<a href="#section-6.1.1-3.2.1" class="pilcrow">¶</a></p>
</li>
            <li id="section-6.1.1-3.3">
              <p id="section-6.1.1-3.3.1">Use the resulting JSON structure, base64url-encode it and use the octets as the HPKE <code>info</code> value.<a href="#section-6.1.1-3.3.1" class="pilcrow">¶</a></p>
</li>
          </ol>
<div id="example">
<section id="section-6.1.1.1">
            <h5 id="name-example">
<a href="#section-6.1.1.1" class="section-number selfRef">6.1.1.1. </a><a href="#name-example" class="section-name selfRef">Example</a>
            </h5>
<p id="section-6.1.1.1-1">The example below shows a pretty-printed JSON object with an empty <code>recipient_extra_info</code> member.<a href="#section-6.1.1.1-1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-6.1.1.1-2">
<pre>
{{::include-fold examples/recipient_structure_example.txt}}
</pre><a href="#section-6.1.1.1-2" class="pilcrow">¶</a>
</div>
<p id="section-6.1.1.1-3">The serialized JSON leads to:<a href="#section-6.1.1.1-3" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-6.1.1.1-4">
<pre>
{{::include-fold examples/serialization_example1.txt}}
</pre><a href="#section-6.1.1.1-4" class="pilcrow">¶</a>
</div>
<p id="section-6.1.1.1-5">The base64url-encoded JSON structure above is used as the HPKE <code>info</code> bytes.<a href="#section-6.1.1.1-5" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
</section>
</div>
<div id="json-example">
<section id="section-6.2">
        <h3 id="name-json-example">
<a href="#section-6.2" class="section-number selfRef">6.2. </a><a href="#name-json-example" class="section-name selfRef">JSON Example</a>
        </h3>
<p id="section-6.2-1">Below is an example of a JWE using the JSON Serialization and HPKE key encryption:<a href="#section-6.2-1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-6.2-2">
<pre>
=============== NOTE: '\' line wrapping per RFC 8792 ================

{
  "protected": "eyJlbmMiOiAiQTEyOEdDTSJ9",
  "ciphertext": "9AxOd65ROJY1cQ",
  "iv": "2u3NRi3CSr-x7Wuj",
  "tag": "1NKYSWVV4pw5thsq7t6m6Q",
  "recipients": [
    {
      "encrypted_key": "l9VRW1K5CA037fY2ZqVF4bDej413TaAtfjoe3k89-eI",
      "header": {
        "alg": "HPKE-0",
        "kid": "G5N__CqMv_kJGieGSFuAugvl0jrQJCZ3yKwVK6sUM4o",
        "ek": "BJl0V6KLl3HOAZbzFwiAL9eaYbFQPg7-\
             ROmIJpluIQjNS5zultZsC4rGhGzmW1GUWG8bzJUWLQtxFF9oze0AKhU"
      }
    }
  ]
}
</pre><a href="#section-6.2-2" class="pilcrow">¶</a>
</div>
<p id="section-6.2-3">The keys used for this example are in <a href="#keys-used" class="auto internal xref">Appendix A</a>.<a href="#section-6.2-3" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="alg-mapping">
<section id="section-7">
      <h2 id="name-mapping-hpke-keys-to-jwk-fo">
<a href="#section-7" class="section-number selfRef">7. </a><a href="#name-mapping-hpke-keys-to-jwk-fo" class="section-name selfRef">Mapping HPKE Keys to JWK for JOSE</a>
      </h2>
<p id="section-7-1">JWKs can be used to represent JOSE-HPKE private or public keys. For the algorithms defined in this document, the valid combinations of the
JWE Algorithm, "kty", and "crv" are shown in <a href="#ciphersuite-kty-crv" class="auto internal xref">Figure 1</a>.<a href="#section-7-1" class="pilcrow">¶</a></p>
<span id="name-jwk-types-and-curves-for-jo"></span><div id="ciphersuite-kty-crv">
<figure id="figure-1">
        <div class="alignLeft art-text artwork" id="section-7-2.1">
<pre>
+---------------------+-----------------+
| JWE Algorithm       | JWK |           |
|                     | kty | crv       |
+---------------------+-----+-----------+
| HPKE-0              | EC  | P-256     |
| HPKE-1              | EC  | P-384     |
| HPKE-2              | EC  | P-521     |
| HPKE-3, HPKE-4      | OKP | X25519    |
| HPKE-5, HPKE-6      | OKP | X448      |
+---------------------+-----+-----------+
</pre>
</div>
<figcaption><a href="#figure-1" class="selfRef">Figure 1</a>:
<a href="#name-jwk-types-and-curves-for-jo" class="selfRef">JWK Types and Curves for JOSE-HPKE Ciphersuites</a>
        </figcaption></figure>
</div>
<p id="section-7-3">When the "kty" field is "AKP" (Algorithm Key Pair <span>[<a href="#I-D.ietf-cose-dilithium" class="cite xref">I-D.ietf-cose-dilithium</a>]</span>) and "alg" is a JOSE-HPKE algorithm, the public and private keys <span class="bcp14">MUST</span> be raw HPKE public and private keys (respectively)
for the KEM used by HPKE.<a href="#section-7-3" class="pilcrow">¶</a></p>
<div id="jwk-representation-of-a-jose-hpke-key-with-hpke-ciphersuite">
<section id="section-7.1">
        <h3 id="name-jwk-representation-of-a-jos">
<a href="#section-7.1" class="section-number selfRef">7.1. </a><a href="#name-jwk-representation-of-a-jos" class="section-name selfRef">JWK Representation of a JOSE-HPKE Key with HPKE Ciphersuite</a>
        </h3>
<p id="section-7.1-1">The example below is a JWK representation of a JOSE-HPKE public and private key:<a href="#section-7.1-1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-7.1-2">
<pre>
{
  "kty": "OKP",
  "crv": "X25519",
  "x": "3pPHgcHYVYpOpB6ISwHdoPRB6jNgd8mM4nRyyj4H3aE",
  "d": "nWGxne0tAiV8Hk6kcy4rN0wMskjl9yND0N3Xeho9n6g",
  "kid": "recipient-key-1",
  "alg": "HPKE-3",
  "key_ops": "encrypt"
}
</pre><a href="#section-7.1-2" class="pilcrow">¶</a>
</div>
<p id="section-7.1-3">It uses the "key_ops" value of "encrypt",
which is appropriate when using integrated encryption.<a href="#section-7.1-3" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="security-considerations">
<section id="section-8">
      <h2 id="name-security-considerations">
<a href="#section-8" class="section-number selfRef">8. </a><a href="#name-security-considerations" class="section-name selfRef">Security Considerations</a>
      </h2>
<p id="section-8-1">This specification is based on HPKE and the security considerations of
<span>[<a href="#I-D.ietf-hpke-hpke" class="cite xref">I-D.ietf-hpke-hpke</a>]</span> are therefore applicable also to this specification.<a href="#section-8-1" class="pilcrow">¶</a></p>
<p id="section-8-2">HPKE assumes the sender is in possession of the public key of the recipient and
HPKE JOSE makes the same assumptions. Hence, some form of public key distribution
mechanism is assumed to exist but outside the scope of this document.<a href="#section-8-2" class="pilcrow">¶</a></p>
<p id="section-8-3">HPKE in Base mode does not offer authentication as part of the HPKE KEM.<a href="#section-8-3" class="pilcrow">¶</a></p>
<p id="section-8-4">HPKE relies on a source of randomness being available on the device.
In Key Agreement with Key Wrapping mode, the CEK has to be randomly generated.
The guidance on randomness in <span>[<a href="#RFC4086" class="cite xref">RFC4086</a>]</span> applies.<a href="#section-8-4" class="pilcrow">¶</a></p>
<div id="key-management">
<section id="section-8.1">
        <h3 id="name-key-management">
<a href="#section-8.1" class="section-number selfRef">8.1. </a><a href="#name-key-management" class="section-name selfRef">Key Management</a>
        </h3>
<p id="section-8.1-1">A single KEM key <span class="bcp14">MUST NOT</span> be used with multiple KEM algorithms.
Each key and its associated algorithm suite, comprising the KEM, KDF, and AEAD,
should be managed independently.
This separation prevents unintended interactions or vulnerabilities between algorithms,
ensuring the integrity and security guarantees of each algorithm are preserved.
Additionally, the same key should not be used for both key encryption and integrated encryption, as it may introduce security risks.
It creates algorithm confusion, increases the potential for key leakage, cross-suite attacks, and improper handling of the key.<a href="#section-8.1-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="review-jwt-best-current-practices">
<section id="section-8.2">
        <h3 id="name-review-jwt-best-current-pra">
<a href="#section-8.2" class="section-number selfRef">8.2. </a><a href="#name-review-jwt-best-current-pra" class="section-name selfRef">Review JWT Best Current Practices</a>
        </h3>
<p id="section-8.2-1">The guidance in <span>[<a href="#RFC8725" class="cite xref">RFC8725</a>]</span> about encryption is also pertinent to this specification.<a href="#section-8.2-1" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="ciphersuite-registration">
<section id="section-9">
      <h2 id="name-ciphersuite-registration">
<a href="#section-9" class="section-number selfRef">9. </a><a href="#name-ciphersuite-registration" class="section-name selfRef">Ciphersuite Registration</a>
      </h2>
<p id="section-9-1">This specification registers a number of ciphersuites for use with HPKE.
A ciphersuite is a group of algorithms, often sharing component algorithms such as hash functions, targeting a security level.
A JOSE-HPKE algorithm makes choices for the following HPKE parameters:<a href="#section-9-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-9-2.1">
          <p id="section-9-2.1.1">KEM Algorithm<a href="#section-9-2.1.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-9-2.2">
          <p id="section-9-2.2.1">KDF Algorithm<a href="#section-9-2.2.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-9-2.3">
          <p id="section-9-2.3.1">AEAD Algorithm<a href="#section-9-2.3.1" class="pilcrow">¶</a></p>
</li>
      </ul>
<p id="section-9-3">The "KEM", "KDF", and "AEAD" values are chosen from the IANA HPKE registry <span>[<a href="#IANA.HPKE" class="cite xref">IANA.HPKE</a>]</span>.<a href="#section-9-3" class="pilcrow">¶</a></p>
<p id="section-9-4">All JOSE-HPKE algorithm identifiers registered by this specification begin with the string "HPKE-".
Future JOSE-HPKE ciphersuite names registered <span class="bcp14">MUST</span> also follow this convention.<a href="#section-9-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="IANA">
<section id="section-10">
      <h2 id="name-iana-considerations">
<a href="#section-10" class="section-number selfRef">10. </a><a href="#name-iana-considerations" class="section-name selfRef">IANA Considerations</a>
      </h2>
<div id="json-web-signature-and-encryption-algorithms">
<section id="section-10.1">
        <h3 id="name-json-web-signature-and-encr">
<a href="#section-10.1" class="section-number selfRef">10.1. </a><a href="#name-json-web-signature-and-encr" class="section-name selfRef">JSON Web Signature and Encryption Algorithms</a>
        </h3>
<p id="section-10.1-1">The following entries are added to the IANA "JSON Web Signature and Encryption Algorithms" registry <span>[<a href="#IANA.JOSE" class="cite xref">IANA.JOSE</a>]</span>:<a href="#section-10.1-1" class="pilcrow">¶</a></p>
<div id="hpke-0">
<section id="section-10.1.1">
          <h4 id="name-hpke-0">
<a href="#section-10.1.1" class="section-number selfRef">10.1.1. </a><a href="#name-hpke-0" class="section-name selfRef">HPKE-0</a>
          </h4>
<ul class="normal">
<li class="normal" id="section-10.1.1-1.1">
              <p id="section-10.1.1-1.1.1">Algorithm Name: HPKE-0<a href="#section-10.1.1-1.1.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-10.1.1-1.2">
              <p id="section-10.1.1-1.2.1">Algorithm Description: Cipher suite for JOSE-HPKE using the DHKEM(P-256, HKDF-SHA256) KEM, the HKDF-SHA256 KDF and the AES-128-GCM AEAD<a href="#section-10.1.1-1.2.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-10.1.1-1.3">
              <p id="section-10.1.1-1.3.1">Algorithm Usage Location(s): "alg"<a href="#section-10.1.1-1.3.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-10.1.1-1.4">
              <p id="section-10.1.1-1.4.1">JOSE Implementation Requirements: Optional<a href="#section-10.1.1-1.4.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-10.1.1-1.5">
              <p id="section-10.1.1-1.5.1">Change Controller: IETF<a href="#section-10.1.1-1.5.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-10.1.1-1.6">
              <p id="section-10.1.1-1.6.1">Specification Document(s): <a href="#alg-mapping" class="auto internal xref">Section 7</a> of this specification<a href="#section-10.1.1-1.6.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-10.1.1-1.7">
              <p id="section-10.1.1-1.7.1">Algorithm Analysis Documents(s): <span>[<a href="#I-D.ietf-hpke-hpke" class="cite xref">I-D.ietf-hpke-hpke</a>]</span><a href="#section-10.1.1-1.7.1" class="pilcrow">¶</a></p>
</li>
          </ul>
</section>
</div>
<div id="hpke-1">
<section id="section-10.1.2">
          <h4 id="name-hpke-1">
<a href="#section-10.1.2" class="section-number selfRef">10.1.2. </a><a href="#name-hpke-1" class="section-name selfRef">HPKE-1</a>
          </h4>
<ul class="normal">
<li class="normal" id="section-10.1.2-1.1">
              <p id="section-10.1.2-1.1.1">Algorithm Name: HPKE-1<a href="#section-10.1.2-1.1.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-10.1.2-1.2">
              <p id="section-10.1.2-1.2.1">Algorithm Description: Cipher suite for JOSE-HPKE using the DHKEM(P-384, HKDF-SHA384) KEM, the HKDF-SHA384 KDF, and the AES-256-GCM AEAD<a href="#section-10.1.2-1.2.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-10.1.2-1.3">
              <p id="section-10.1.2-1.3.1">Algorithm Usage Location(s): "alg"<a href="#section-10.1.2-1.3.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-10.1.2-1.4">
              <p id="section-10.1.2-1.4.1">JOSE Implementation Requirements: Optional<a href="#section-10.1.2-1.4.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-10.1.2-1.5">
              <p id="section-10.1.2-1.5.1">Change Controller: IETF<a href="#section-10.1.2-1.5.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-10.1.2-1.6">
              <p id="section-10.1.2-1.6.1">Specification Document(s): <a href="#alg-mapping" class="auto internal xref">Section 7</a> of this specification<a href="#section-10.1.2-1.6.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-10.1.2-1.7">
              <p id="section-10.1.2-1.7.1">Algorithm Analysis Documents(s): <span>[<a href="#I-D.ietf-hpke-hpke" class="cite xref">I-D.ietf-hpke-hpke</a>]</span><a href="#section-10.1.2-1.7.1" class="pilcrow">¶</a></p>
</li>
          </ul>
</section>
</div>
<div id="hpke-2">
<section id="section-10.1.3">
          <h4 id="name-hpke-2">
<a href="#section-10.1.3" class="section-number selfRef">10.1.3. </a><a href="#name-hpke-2" class="section-name selfRef">HPKE-2</a>
          </h4>
<ul class="normal">
<li class="normal" id="section-10.1.3-1.1">
              <p id="section-10.1.3-1.1.1">Algorithm Name: HPKE-2<a href="#section-10.1.3-1.1.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-10.1.3-1.2">
              <p id="section-10.1.3-1.2.1">Algorithm Description: Cipher suite for JOSE-HPKE using the DHKEM(P-521, HKDF-SHA512) KEM, the HKDF-SHA512 KDF, and the AES-256-GCM AEAD<a href="#section-10.1.3-1.2.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-10.1.3-1.3">
              <p id="section-10.1.3-1.3.1">Algorithm Usage Location(s): "alg"<a href="#section-10.1.3-1.3.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-10.1.3-1.4">
              <p id="section-10.1.3-1.4.1">JOSE Implementation Requirements: Optional<a href="#section-10.1.3-1.4.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-10.1.3-1.5">
              <p id="section-10.1.3-1.5.1">Change Controller: IETF<a href="#section-10.1.3-1.5.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-10.1.3-1.6">
              <p id="section-10.1.3-1.6.1">Specification Document(s): <a href="#alg-mapping" class="auto internal xref">Section 7</a> of this specification<a href="#section-10.1.3-1.6.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-10.1.3-1.7">
              <p id="section-10.1.3-1.7.1">Algorithm Analysis Documents(s): <span>[<a href="#I-D.ietf-hpke-hpke" class="cite xref">I-D.ietf-hpke-hpke</a>]</span><a href="#section-10.1.3-1.7.1" class="pilcrow">¶</a></p>
</li>
          </ul>
</section>
</div>
<div id="hpke-3">
<section id="section-10.1.4">
          <h4 id="name-hpke-3">
<a href="#section-10.1.4" class="section-number selfRef">10.1.4. </a><a href="#name-hpke-3" class="section-name selfRef">HPKE-3</a>
          </h4>
<ul class="normal">
<li class="normal" id="section-10.1.4-1.1">
              <p id="section-10.1.4-1.1.1">Algorithm Name: HPKE-3<a href="#section-10.1.4-1.1.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-10.1.4-1.2">
              <p id="section-10.1.4-1.2.1">Algorithm Description: Cipher suite for JOSE-HPKE using the DHKEM(X25519, HKDF-SHA256) KEM, the HKDF-SHA256 KDF, and the AES-128-GCM AEAD<a href="#section-10.1.4-1.2.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-10.1.4-1.3">
              <p id="section-10.1.4-1.3.1">Algorithm Usage Location(s): "alg"<a href="#section-10.1.4-1.3.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-10.1.4-1.4">
              <p id="section-10.1.4-1.4.1">JOSE Implementation Requirements: Optional<a href="#section-10.1.4-1.4.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-10.1.4-1.5">
              <p id="section-10.1.4-1.5.1">Change Controller: IETF<a href="#section-10.1.4-1.5.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-10.1.4-1.6">
              <p id="section-10.1.4-1.6.1">Specification Document(s): <a href="#alg-mapping" class="auto internal xref">Section 7</a> of this specification<a href="#section-10.1.4-1.6.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-10.1.4-1.7">
              <p id="section-10.1.4-1.7.1">Algorithm Analysis Documents(s): <span>[<a href="#I-D.ietf-hpke-hpke" class="cite xref">I-D.ietf-hpke-hpke</a>]</span><a href="#section-10.1.4-1.7.1" class="pilcrow">¶</a></p>
</li>
          </ul>
</section>
</div>
<div id="hpke-4">
<section id="section-10.1.5">
          <h4 id="name-hpke-4">
<a href="#section-10.1.5" class="section-number selfRef">10.1.5. </a><a href="#name-hpke-4" class="section-name selfRef">HPKE-4</a>
          </h4>
<ul class="normal">
<li class="normal" id="section-10.1.5-1.1">
              <p id="section-10.1.5-1.1.1">Algorithm Name: HPKE-4<a href="#section-10.1.5-1.1.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-10.1.5-1.2">
              <p id="section-10.1.5-1.2.1">Algorithm Description: Cipher suite for JOSE-HPKE using the DHKEM(X25519, HKDF-SHA256) KEM, the HKDF-SHA256 KDF, and the ChaCha20Poly1305 AEAD<a href="#section-10.1.5-1.2.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-10.1.5-1.3">
              <p id="section-10.1.5-1.3.1">Algorithm Usage Location(s): "alg"<a href="#section-10.1.5-1.3.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-10.1.5-1.4">
              <p id="section-10.1.5-1.4.1">JOSE Implementation Requirements: Optional<a href="#section-10.1.5-1.4.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-10.1.5-1.5">
              <p id="section-10.1.5-1.5.1">Change Controller: IETF<a href="#section-10.1.5-1.5.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-10.1.5-1.6">
              <p id="section-10.1.5-1.6.1">Specification Document(s): <a href="#alg-mapping" class="auto internal xref">Section 7</a> of this specification<a href="#section-10.1.5-1.6.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-10.1.5-1.7">
              <p id="section-10.1.5-1.7.1">Algorithm Analysis Documents(s): <span>[<a href="#I-D.ietf-hpke-hpke" class="cite xref">I-D.ietf-hpke-hpke</a>]</span><a href="#section-10.1.5-1.7.1" class="pilcrow">¶</a></p>
</li>
          </ul>
</section>
</div>
<div id="hpke-5">
<section id="section-10.1.6">
          <h4 id="name-hpke-5">
<a href="#section-10.1.6" class="section-number selfRef">10.1.6. </a><a href="#name-hpke-5" class="section-name selfRef">HPKE-5</a>
          </h4>
<ul class="normal">
<li class="normal" id="section-10.1.6-1.1">
              <p id="section-10.1.6-1.1.1">Algorithm Name: HPKE-5<a href="#section-10.1.6-1.1.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-10.1.6-1.2">
              <p id="section-10.1.6-1.2.1">Algorithm Description: Cipher suite for JOSE-HPKE using the DHKEM(X448, HKDF-SHA512) KEM, the HKDF-SHA512 KDF, and the AES-256-GCM AEAD<a href="#section-10.1.6-1.2.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-10.1.6-1.3">
              <p id="section-10.1.6-1.3.1">Algorithm Usage Location(s): "alg"<a href="#section-10.1.6-1.3.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-10.1.6-1.4">
              <p id="section-10.1.6-1.4.1">JOSE Implementation Requirements: Optional<a href="#section-10.1.6-1.4.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-10.1.6-1.5">
              <p id="section-10.1.6-1.5.1">Change Controller: IETF<a href="#section-10.1.6-1.5.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-10.1.6-1.6">
              <p id="section-10.1.6-1.6.1">Specification Document(s): <a href="#alg-mapping" class="auto internal xref">Section 7</a> of this specification<a href="#section-10.1.6-1.6.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-10.1.6-1.7">
              <p id="section-10.1.6-1.7.1">Algorithm Analysis Documents(s): <span>[<a href="#I-D.ietf-hpke-hpke" class="cite xref">I-D.ietf-hpke-hpke</a>]</span><a href="#section-10.1.6-1.7.1" class="pilcrow">¶</a></p>
</li>
          </ul>
</section>
</div>
<div id="hpke-6">
<section id="section-10.1.7">
          <h4 id="name-hpke-6">
<a href="#section-10.1.7" class="section-number selfRef">10.1.7. </a><a href="#name-hpke-6" class="section-name selfRef">HPKE-6</a>
          </h4>
<ul class="normal">
<li class="normal" id="section-10.1.7-1.1">
              <p id="section-10.1.7-1.1.1">Algorithm Name: HPKE-6<a href="#section-10.1.7-1.1.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-10.1.7-1.2">
              <p id="section-10.1.7-1.2.1">Algorithm Description: Cipher suite for JOSE-HPKE using the DHKEM(X448, HKDF-SHA512) KEM, the HKDF-SHA512 KDF, and the ChaCha20Poly1305 AEAD<a href="#section-10.1.7-1.2.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-10.1.7-1.3">
              <p id="section-10.1.7-1.3.1">Algorithm Usage Location(s): "alg"<a href="#section-10.1.7-1.3.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-10.1.7-1.4">
              <p id="section-10.1.7-1.4.1">JOSE Implementation Requirements: Optional<a href="#section-10.1.7-1.4.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-10.1.7-1.5">
              <p id="section-10.1.7-1.5.1">Change Controller: IETF<a href="#section-10.1.7-1.5.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-10.1.7-1.6">
              <p id="section-10.1.7-1.6.1">Specification Document(s): <a href="#alg-mapping" class="auto internal xref">Section 7</a> of this specification<a href="#section-10.1.7-1.6.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-10.1.7-1.7">
              <p id="section-10.1.7-1.7.1">Algorithm Analysis Documents(s): <span>[<a href="#I-D.ietf-hpke-hpke" class="cite xref">I-D.ietf-hpke-hpke</a>]</span><a href="#section-10.1.7-1.7.1" class="pilcrow">¶</a></p>
</li>
          </ul>
</section>
</div>
<div id="int">
<section id="section-10.1.8">
          <h4 id="name-int">
<a href="#section-10.1.8" class="section-number selfRef">10.1.8. </a><a href="#name-int" class="section-name selfRef">int</a>
          </h4>
<ul class="normal">
<li class="normal" id="section-10.1.8-1.1">
              <p id="section-10.1.8-1.1.1">Algorithm Name: int<a href="#section-10.1.8-1.1.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-10.1.8-1.2">
              <p id="section-10.1.8-1.2.1">Algorithm Description: Indicates that HPKE Integrated Encryption is being used<a href="#section-10.1.8-1.2.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-10.1.8-1.3">
              <p id="section-10.1.8-1.3.1">Algorithm Usage Location(s): "enc"<a href="#section-10.1.8-1.3.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-10.1.8-1.4">
              <p id="section-10.1.8-1.4.1">JOSE Implementation Requirements: Required<a href="#section-10.1.8-1.4.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-10.1.8-1.5">
              <p id="section-10.1.8-1.5.1">Change Controller: IETF<a href="#section-10.1.8-1.5.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-10.1.8-1.6">
              <p id="section-10.1.8-1.6.1">Specification Document(s): <a href="#overview" class="auto internal xref">Section 4</a> of this specification<a href="#section-10.1.8-1.6.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-10.1.8-1.7">
              <p id="section-10.1.8-1.7.1">Algorithm Analysis Documents(s): <span>[<a href="#I-D.ietf-hpke-hpke" class="cite xref">I-D.ietf-hpke-hpke</a>]</span><a href="#section-10.1.8-1.7.1" class="pilcrow">¶</a></p>
</li>
          </ul>
</section>
</div>
</section>
</div>
<div id="json-web-signature-and-encryption-header-parameters">
<section id="section-10.2">
        <h3 id="name-json-web-signature-and-encry">
<a href="#section-10.2" class="section-number selfRef">10.2. </a><a href="#name-json-web-signature-and-encry" class="section-name selfRef">JSON Web Signature and Encryption Header Parameters</a>
        </h3>
<p id="section-10.2-1">The following entries are added to the IANA "JSON Web Key Parameters" registry <span>[<a href="#IANA.JOSE" class="cite xref">IANA.JOSE</a>]</span>:<a href="#section-10.2-1" class="pilcrow">¶</a></p>
<div id="ek">
<section id="section-10.2.1">
          <h4 id="name-ek">
<a href="#section-10.2.1" class="section-number selfRef">10.2.1. </a><a href="#name-ek" class="section-name selfRef">ek</a>
          </h4>
<ul class="normal">
<li class="normal" id="section-10.2.1-1.1">
              <p id="section-10.2.1-1.1.1">Header Parameter Name: "ek"<a href="#section-10.2.1-1.1.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-10.2.1-1.2">
              <p id="section-10.2.1-1.2.1">Header Parameter Description: A base64url-encoded encapsulated key, as defined in <span><a href="https://datatracker.ietf.org/doc/html/draft-ietf-hpke-hpke-01#section-5" class="relref">Section 5</a> of [<a href="#I-D.ietf-hpke-hpke" class="cite xref">I-D.ietf-hpke-hpke</a>]</span><a href="#section-10.2.1-1.2.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-10.2.1-1.3">
              <p id="section-10.2.1-1.3.1">Header Parameter Usage Location(s): JWE<a href="#section-10.2.1-1.3.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-10.2.1-1.4">
              <p id="section-10.2.1-1.4.1">Change Controller: IETF<a href="#section-10.2.1-1.4.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-10.2.1-1.5">
              <p id="section-10.2.1-1.5.1">Specification Document(s): <a href="#encapsulated-keys" class="auto internal xref">Section 4.2</a> of this specification<a href="#section-10.2.1-1.5.1" class="pilcrow">¶</a></p>
</li>
          </ul>
</section>
</div>
<div id="pskid">
<section id="section-10.2.2">
          <h4 id="name-psk_id">
<a href="#section-10.2.2" class="section-number selfRef">10.2.2. </a><a href="#name-psk_id" class="section-name selfRef">psk_id</a>
          </h4>
<ul class="normal">
<li class="normal" id="section-10.2.2-1.1">
              <p id="section-10.2.2-1.1.1">Header Parameter Name: "psk_id"<a href="#section-10.2.2-1.1.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-10.2.2-1.2">
              <p id="section-10.2.2-1.2.1">Header Parameter Description: A base64url-encoded key identifier (kid) for the pre-shared key, as defined in <span><a href="https://datatracker.ietf.org/doc/html/draft-ietf-hpke-hpke-01#section-5.1.2" class="relref">Section 5.1.2</a> of [<a href="#I-D.ietf-hpke-hpke" class="cite xref">I-D.ietf-hpke-hpke</a>]</span><a href="#section-10.2.2-1.2.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-10.2.2-1.3">
              <p id="section-10.2.2-1.3.1">Header Parameter Usage Location(s): JWE<a href="#section-10.2.2-1.3.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-10.2.2-1.4">
              <p id="section-10.2.2-1.4.1">Change Controller: IETF<a href="#section-10.2.2-1.4.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-10.2.2-1.5">
              <p id="section-10.2.2-1.5.1">Specification Document(s): <a href="#overview" class="auto internal xref">Section 4</a> of this specification<a href="#section-10.2.2-1.5.1" class="pilcrow">¶</a></p>
</li>
          </ul>
</section>
</div>
</section>
</div>
</section>
</div>
<div id="sec-combined-references">
<section id="section-11">
      <h2 id="name-references">
<a href="#section-11" class="section-number selfRef">11. </a><a href="#name-references" class="section-name selfRef">References</a>
      </h2>
<div id="sec-normative-references">
<section id="section-11.1">
        <h3 id="name-normative-references">
<a href="#section-11.1" class="section-number selfRef">11.1. </a><a href="#name-normative-references" class="section-name selfRef">Normative References</a>
        </h3>
<dl class="references">
<dt id="I-D.ietf-hpke-hpke">[I-D.ietf-hpke-hpke]</dt>
        <dd>
<span class="refAuthor">Barnes, R.</span>, <span class="refAuthor">Bhargavan, K.</span>, <span class="refAuthor">Lipp, B.</span>, and <span class="refAuthor">C. A. Wood</span>, <span class="refTitle">"Hybrid Public Key Encryption"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-ietf-hpke-hpke-01</span>, <time datetime="2025-06-24" class="refDate">24 June 2025</time>, <span>&lt;<a href="https://datatracker.ietf.org/doc/html/draft-ietf-hpke-hpke-01">https://datatracker.ietf.org/doc/html/draft-ietf-hpke-hpke-01</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="IANA.JOSE">[IANA.JOSE]</dt>
        <dd>
<span class="refAuthor">IANA</span>, <span class="refTitle">"JSON Web Signature and Encryption Algorithms"</span>, <span>n.d.</span>, <span>&lt;<a href="https://www.iana.org/assignments/jose">https://www.iana.org/assignments/jose</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC2119">[RFC2119]</dt>
        <dd>
<span class="refAuthor">Bradner, S.</span>, <span class="refTitle">"Key words for use in RFCs to Indicate Requirement Levels"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 2119</span>, <span class="seriesInfo">DOI 10.17487/RFC2119</span>, <time datetime="1997-03" class="refDate">March 1997</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc2119">https://www.rfc-editor.org/rfc/rfc2119</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7156">[RFC7156]</dt>
        <dd>
<span class="refAuthor">Zorn, G.</span>, <span class="refAuthor">Wu, Q.</span>, and <span class="refAuthor">J. Korhonen</span>, <span class="refTitle">"Diameter Support for Proxy Mobile IPv6 Localized Routing"</span>, <span class="seriesInfo">RFC 7156</span>, <span class="seriesInfo">DOI 10.17487/RFC7156</span>, <time datetime="2014-04" class="refDate">April 2014</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc7156">https://www.rfc-editor.org/rfc/rfc7156</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7516">[RFC7516]</dt>
        <dd>
<span class="refAuthor">Jones, M.</span> and <span class="refAuthor">J. Hildebrand</span>, <span class="refTitle">"JSON Web Encryption (JWE)"</span>, <span class="seriesInfo">RFC 7516</span>, <span class="seriesInfo">DOI 10.17487/RFC7516</span>, <time datetime="2015-05" class="refDate">May 2015</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc7516">https://www.rfc-editor.org/rfc/rfc7516</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7517">[RFC7517]</dt>
        <dd>
<span class="refAuthor">Jones, M.</span>, <span class="refTitle">"JSON Web Key (JWK)"</span>, <span class="seriesInfo">RFC 7517</span>, <span class="seriesInfo">DOI 10.17487/RFC7517</span>, <time datetime="2015-05" class="refDate">May 2015</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc7517">https://www.rfc-editor.org/rfc/rfc7517</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7518">[RFC7518]</dt>
        <dd>
<span class="refAuthor">Jones, M.</span>, <span class="refTitle">"JSON Web Algorithms (JWA)"</span>, <span class="seriesInfo">RFC 7518</span>, <span class="seriesInfo">DOI 10.17487/RFC7518</span>, <time datetime="2015-05" class="refDate">May 2015</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc7518">https://www.rfc-editor.org/rfc/rfc7518</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7638">[RFC7638]</dt>
        <dd>
<span class="refAuthor">Jones, M.</span> and <span class="refAuthor">N. Sakimura</span>, <span class="refTitle">"JSON Web Key (JWK) Thumbprint"</span>, <span class="seriesInfo">RFC 7638</span>, <span class="seriesInfo">DOI 10.17487/RFC7638</span>, <time datetime="2015-09" class="refDate">September 2015</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc7638">https://www.rfc-editor.org/rfc/rfc7638</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8174">[RFC8174]</dt>
        <dd>
<span class="refAuthor">Leiba, B.</span>, <span class="refTitle">"Ambiguity of Uppercase vs Lowercase in RFC 2119 Key Words"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 8174</span>, <span class="seriesInfo">DOI 10.17487/RFC8174</span>, <time datetime="2017-05" class="refDate">May 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc8174">https://www.rfc-editor.org/rfc/rfc8174</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8725">[RFC8725]</dt>
      <dd>
<span class="refAuthor">Sheffer, Y.</span>, <span class="refAuthor">Hardt, D.</span>, and <span class="refAuthor">M. Jones</span>, <span class="refTitle">"JSON Web Token Best Current Practices"</span>, <span class="seriesInfo">BCP 225</span>, <span class="seriesInfo">RFC 8725</span>, <span class="seriesInfo">DOI 10.17487/RFC8725</span>, <time datetime="2020-02" class="refDate">February 2020</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc8725">https://www.rfc-editor.org/rfc/rfc8725</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
</div>
<div id="sec-informative-references">
<section id="section-11.2">
        <h3 id="name-informative-references">
<a href="#section-11.2" class="section-number selfRef">11.2. </a><a href="#name-informative-references" class="section-name selfRef">Informative References</a>
        </h3>
<dl class="references">
<dt id="I-D.ietf-cose-dilithium">[I-D.ietf-cose-dilithium]</dt>
        <dd>
<span class="refAuthor">Prorock, M.</span> and <span class="refAuthor">O. Steele</span>, <span class="refTitle">"ML-DSA for JOSE and COSE"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-ietf-cose-dilithium-09</span>, <time datetime="2025-09-12" class="refDate">12 September 2025</time>, <span>&lt;<a href="https://datatracker.ietf.org/doc/html/draft-ietf-cose-dilithium-09">https://datatracker.ietf.org/doc/html/draft-ietf-cose-dilithium-09</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="I-D.ietf-cose-hpke">[I-D.ietf-cose-hpke]</dt>
        <dd>
<span class="refAuthor">Tschofenig, H.</span>, <span class="refAuthor">Steele, O.</span>, <span class="refAuthor">Daisuke, A.</span>, and <span class="refAuthor">L. Lundblade</span>, <span class="refTitle">"Use of Hybrid Public-Key Encryption (HPKE) with CBOR Object Signing and Encryption (COSE)"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-ietf-cose-hpke-16</span>, <time datetime="2025-09-19" class="refDate">19 September 2025</time>, <span>&lt;<a href="https://datatracker.ietf.org/doc/html/draft-ietf-cose-hpke-16">https://datatracker.ietf.org/doc/html/draft-ietf-cose-hpke-16</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="IANA.HPKE">[IANA.HPKE]</dt>
        <dd>
<span class="refAuthor">IANA</span>, <span class="refTitle">"Hybrid Public Key Encryption (HPKE)"</span>, <span>n.d.</span>, <span>&lt;<a href="https://www.iana.org/assignments/hpke">https://www.iana.org/assignments/hpke</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="NIST.SP.800-56Ar3">[NIST.SP.800-56Ar3]</dt>
        <dd>
<span class="refAuthor">National Institute of Standards and Technology</span>, <span class="refTitle">"Recommendation for Pair-Wise Key-Establishment Schemes Using Discrete Logarithm Cryptography, NIST Special Publication 800-56A Revision 3"</span>, <time datetime="2018-04" class="refDate">April 2018</time>, <span>&lt;<a href="https://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-56Ar3.pdf">https://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-56Ar3.pdf</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC4086">[RFC4086]</dt>
      <dd>
<span class="refAuthor">Eastlake 3rd, D.</span>, <span class="refAuthor">Schiller, J.</span>, and <span class="refAuthor">S. Crocker</span>, <span class="refTitle">"Randomness Requirements for Security"</span>, <span class="seriesInfo">BCP 106</span>, <span class="seriesInfo">RFC 4086</span>, <span class="seriesInfo">DOI 10.17487/RFC4086</span>, <time datetime="2005-06" class="refDate">June 2005</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc4086">https://www.rfc-editor.org/rfc/rfc4086</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
</div>
</section>
</div>
<div id="keys-used">
<section id="appendix-A">
      <h2 id="name-keys-used-in-examples">
<a href="#appendix-A" class="section-number selfRef">Appendix A. </a><a href="#name-keys-used-in-examples" class="section-name selfRef">Keys Used in Examples</a>
      </h2>
<p id="appendix-A-1">This private key and its implied public key are used the examples:<a href="#appendix-A-1" class="pilcrow">¶</a></p>
<div class="lang-text sourcecode" id="appendix-A-2">
<pre>
{
  "kty": "EC",
  "use": "enc",
  "alg": "HPKE-0",
  "kid": "G5N__CqMv_kJGieGSFuAugvl0jrQJCZ3yKwVK6sUM4o",
  "crv": "P-256",
  "x": "gixQJ0qg4Ag-6HSMaIEDL_zbDhoXavMyKlmdn__AQVE",
  "y": "ZxTgRLWaKONCL_GbZKLNPsW9EW6nBsN4AwQGEFAFFbM",
  "d": "g2DXtKapi2oN2zL_RCWX8D4bWURHCKN2-ZNGC05ZaR8"
}
</pre><a href="#appendix-A-2" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="acknowledgments">
<section id="appendix-B">
      <h2 id="name-acknowledgments">
<a href="#name-acknowledgments" class="section-name selfRef">Acknowledgments</a>
      </h2>
<p id="appendix-B-1">This specification leverages text from <span>[<a href="#I-D.ietf-cose-hpke" class="cite xref">I-D.ietf-cose-hpke</a>]</span>.
We would like to thank
Matt Chanda,
Ilari Liusvaara,
Neil Madden,
Aaron Parecki,
Filip Skokan,
and
Sebastian Stenzel
for their contributions to the specification.<a href="#appendix-B-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="document-history">
<section id="appendix-C">
      <h2 id="name-document-history">
<a href="#name-document-history" class="section-name selfRef">Document History</a>
      </h2>
<p id="appendix-C-1">-12<a href="#appendix-C-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="appendix-C-2.1">
          <p id="appendix-C-2.1.1">Added the recipient_structure<a href="#appendix-C-2.1.1" class="pilcrow">¶</a></p>
</li>
      </ul>
<p id="appendix-C-3">-11<a href="#appendix-C-3" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="appendix-C-4.1">
          <p id="appendix-C-4.1.1">Fix too long lines<a href="#appendix-C-4.1.1" class="pilcrow">¶</a></p>
</li>
      </ul>
<p id="appendix-C-5">-10<a href="#appendix-C-5" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="appendix-C-6.1">
          <p id="appendix-C-6.1.1">Addressed WGLC review comments by Neil Madden and Sebastian Stenzel.<a href="#appendix-C-6.1.1" class="pilcrow">¶</a></p>
</li>
      </ul>
<p id="appendix-C-7">-09<a href="#appendix-C-7" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="appendix-C-8.1">
          <p id="appendix-C-8.1.1">Corrected examples.<a href="#appendix-C-8.1.1" class="pilcrow">¶</a></p>
</li>
      </ul>
<p id="appendix-C-9">-08<a href="#appendix-C-9" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="appendix-C-10.1">
          <p id="appendix-C-10.1.1">Use "enc":"int" for integrated encryption.<a href="#appendix-C-10.1.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="appendix-C-10.2">
          <p id="appendix-C-10.2.1">Described reasons for excluding authenticated HPKE.<a href="#appendix-C-10.2.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="appendix-C-10.3">
          <p id="appendix-C-10.3.1">Stated that mutually known private information <span class="bcp14">MAY</span> be used as the HPKE info value.<a href="#appendix-C-10.3.1" class="pilcrow">¶</a></p>
</li>
      </ul>
<p id="appendix-C-11">-07<a href="#appendix-C-11" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="appendix-C-12.1">
          <p id="appendix-C-12.1.1">Clarifications<a href="#appendix-C-12.1.1" class="pilcrow">¶</a></p>
</li>
      </ul>
<p id="appendix-C-13">-06<a href="#appendix-C-13" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="appendix-C-14.1">
          <p id="appendix-C-14.1.1">Remove auth mode and auth_kid from the specification.<a href="#appendix-C-14.1.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="appendix-C-14.2">
          <p id="appendix-C-14.2.1">HPKE AAD for JOSE HPKE Key Encryption is now empty.<a href="#appendix-C-14.2.1" class="pilcrow">¶</a></p>
</li>
      </ul>
<p id="appendix-C-15">-05<a href="#appendix-C-15" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="appendix-C-16.1">
          <p id="appendix-C-16.1.1">Removed incorrect text about HPKE algorithm names.<a href="#appendix-C-16.1.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="appendix-C-16.2">
          <p id="appendix-C-16.2.1">Fixed #21: Comply with NIST SP 800-227 Recommendations for Key-Encapsulation Mechanisms.<a href="#appendix-C-16.2.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="appendix-C-16.3">
          <p id="appendix-C-16.3.1">Fixed #19: Binding the Application Context.<a href="#appendix-C-16.3.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="appendix-C-16.4">
          <p id="appendix-C-16.4.1">Fixed #18: Use of apu and apv in Recipient context.<a href="#appendix-C-16.4.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="appendix-C-16.5">
          <p id="appendix-C-16.5.1">Added new Section 7.1 (Authentication using an Asymmetric Key).<a href="#appendix-C-16.5.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="appendix-C-16.6">
          <p id="appendix-C-16.6.1">Updated Section 7.2 (Key Management) to prevent cross-protocol attacks.<a href="#appendix-C-16.6.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="appendix-C-16.7">
          <p id="appendix-C-16.7.1">Updated HPKE Setup info parameter to be empty.<a href="#appendix-C-16.7.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="appendix-C-16.8">
          <p id="appendix-C-16.8.1">Added details on HPKE AEAD AAD, compression and decryption for HPKE Integrated Encryption.<a href="#appendix-C-16.8.1" class="pilcrow">¶</a></p>
</li>
      </ul>
<p id="appendix-C-17">-04<a href="#appendix-C-17" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="appendix-C-18.1">
          <p id="appendix-C-18.1.1">Fixed #8: Use short algorithm identifiers, per the JOSE naming conventions.<a href="#appendix-C-18.1.1" class="pilcrow">¶</a></p>
</li>
      </ul>
<p id="appendix-C-19">-03<a href="#appendix-C-19" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="appendix-C-20.1">
          <p id="appendix-C-20.1.1">Added new section 7.1 to discuss Key Management.<a href="#appendix-C-20.1.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="appendix-C-20.2">
          <p id="appendix-C-20.2.1">HPKE Setup info parameter is updated to carry JOSE context-specific data for both modes.<a href="#appendix-C-20.2.1" class="pilcrow">¶</a></p>
</li>
      </ul>
<p id="appendix-C-21">-02<a href="#appendix-C-21" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="appendix-C-22.1">
          <p id="appendix-C-22.1.1">Fixed #4: HPKE Integrated Encryption "enc: dir".<a href="#appendix-C-22.1.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="appendix-C-22.2">
          <p id="appendix-C-22.2.1">Updated text on the use of HPKE Setup info parameter.<a href="#appendix-C-22.2.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="appendix-C-22.3">
          <p id="appendix-C-22.3.1">Added Examples in Sections 5.1, 5.2 and 6.1.<a href="#appendix-C-22.3.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="appendix-C-22.4">
          <p id="appendix-C-22.4.1">Use of registered HPKE  "alg" value in the recipient unprotected header for Key Encryption.<a href="#appendix-C-22.4.1" class="pilcrow">¶</a></p>
</li>
      </ul>
<p id="appendix-C-23">-01<a href="#appendix-C-23" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="appendix-C-24.1">
          <p id="appendix-C-24.1.1">Apply feedback from call for adoption.<a href="#appendix-C-24.1.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="appendix-C-24.2">
          <p id="appendix-C-24.2.1">Provide examples of auth and psk modes for JSON and Compact Serializations<a href="#appendix-C-24.2.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="appendix-C-24.3">
          <p id="appendix-C-24.3.1">Simplify description of HPKE modes<a href="#appendix-C-24.3.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="appendix-C-24.4">
          <p id="appendix-C-24.4.1">Adjust IANA registration requests<a href="#appendix-C-24.4.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="appendix-C-24.5">
          <p id="appendix-C-24.5.1">Remove HPKE Mode from named algorithms<a href="#appendix-C-24.5.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="appendix-C-24.6">
          <p id="appendix-C-24.6.1">Fix AEAD named algorithms<a href="#appendix-C-24.6.1" class="pilcrow">¶</a></p>
</li>
      </ul>
<p id="appendix-C-25">-00<a href="#appendix-C-25" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="appendix-C-26.1">
          <p id="appendix-C-26.1.1">Created initial working group version from draft-rha-jose-hpke-encrypt-07<a href="#appendix-C-26.1.1" class="pilcrow">¶</a></p>
</li>
      </ul>
</section>
</div>
<div id="authors-addresses">
<section id="appendix-D">
      <h2 id="name-authors-addresses">
<a href="#name-authors-addresses" class="section-name selfRef">Authors' Addresses</a>
      </h2>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Tirumaleswar Reddy</span></div>
<div dir="auto" class="left"><span class="org">Nokia</span></div>
<div dir="auto" class="left">
<span class="locality">Bangalore</span> </div>
<div dir="auto" class="left"><span class="region">Karnataka</span></div>
<div dir="auto" class="left"><span class="country-name">India</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:kondtir@gmail.com" class="email">kondtir@gmail.com</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Hannes Tschofenig</span></div>
<div dir="auto" class="left"><span class="org">University of Applied Sciences Bonn-Rhein-Sieg</span></div>
<div dir="auto" class="left"><span class="country-name">Germany</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:hannes.tschofenig@gmx.net" class="email">hannes.tschofenig@gmx.net</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Aritra Banerjee</span></div>
<div dir="auto" class="left"><span class="org">Nokia</span></div>
<div dir="auto" class="left"><span class="locality">Munich</span></div>
<div dir="auto" class="left"><span class="country-name">Germany</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:aritra.banerjee@nokia.com" class="email">aritra.banerjee@nokia.com</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Orie Steele</span></div>
<div dir="auto" class="left"><span class="org">Tradeverifyd</span></div>
<div dir="auto" class="left"><span class="country-name">United States</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:orie@or13.io" class="email">orie@or13.io</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Michael B. Jones</span></div>
<div dir="auto" class="left"><span class="org">Self-Issued Consulting</span></div>
<div dir="auto" class="left"><span class="country-name">United States</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:michael_b_jones@hotmail.com" class="email">michael_b_jones@hotmail.com</a>
</div>
<div class="url">
<span>URI:</span>
<a href="https://self-issued.info/" class="url">https://self-issued.info/</a>
</div>
</address>
</section>
</div>
<script>const toc = document.getElementById("toc");
toc.querySelector("h2").addEventListener("click", e => {
  toc.classList.toggle("active");
});
toc.querySelector("nav").addEventListener("click", e => {
  toc.classList.remove("active");
});
</script>
</body>
</html>
