<!DOCTYPE html>
<html lang="en" class="Internet-Draft">
<head>
<meta charset="utf-8">
<meta content="Common,Inherited,Latin" name="scripts">
<meta content="initial-scale=1.0" name="viewport">
<title>Use of Hybrid Public Key Encryption (HPKE) with JSON Object Signing and Encryption (JOSE)</title>
<meta content="Tirumaleswar Reddy" name="author">
<meta content="Hannes Tschofenig" name="author">
<meta content="Aritra Banerjee" name="author">
<meta content="Orie Steele" name="author">
<meta content="Michael B. Jones" name="author">
<meta content="
       This specification defines Hybrid Public Key Encryption (HPKE) for use with
JSON Object Signing and Encryption (JOSE). HPKE offers a variant of
public key encryption of arbitrary-sized plaintexts for a recipient public key. 
       HPKE works for any combination of an asymmetric key encapsulation mechanism (KEM),
key derivation function (KDF), and authenticated encryption with additional data
(AEAD) function. Authentication for HPKE in JOSE is provided by
JOSE-native security mechanisms or by one of the authenticated variants of HPKE. 
       This document defines the use of the HPKE with JOSE. 
    " name="description">
<meta content="xml2rfc 3.23.2" name="generator">
<meta content="HPKE" name="keyword">
<meta content="JOSE" name="keyword">
<meta content="PQC" name="keyword">
<meta content="Hybrid" name="keyword">
<meta content="draft-ietf-jose-hpke-encrypt-latest" name="ietf.draft">
<!-- Generator version information:
  xml2rfc 3.23.2
    Python 3.12.7
    ConfigArgParse 1.7
    google-i18n-address 3.1.1
    intervaltree 3.1.0
    Jinja2 3.1.4
    lxml 4.9.4
    platformdirs 4.3.6
    pycountry 22.3.5
    PyYAML 6.0.1
    requests 2.32.3
    setuptools 70.3.0
    wcwidth 0.2.13
-->
<link href="draft-ietf-jose-hpke-encrypt.xml" rel="alternate" type="application/rfc+xml">
<link href="#copyright" rel="license">
<style type="text/css">@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0460-052F, U+1C80-1C88, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
}
@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
}
@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-vietnamese.woff2') format('woff2');
  unicode-range: U+0102-0103, U+0110-0111, U+1EA0-1EF9, U+20AB;
}
@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}

@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0460-052F, U+1C80-1C88, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-cyrillic.woff2') format('woff2');
  unicode-range: U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-vietnamese.woff2') format('woff2');
  unicode-range: U+0102-0103, U+0110-0111, U+1EA0-1EF9, U+20AB;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}

@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0460-052F, U+1C80-1C88, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-cyrillic.woff2') format('woff2');
  unicode-range: U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-vietnamese.woff2') format('woff2');
  unicode-range: U+0102-0103, U+0110-0111, U+1EA0-1EF9, U+20AB;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 600;
  font-display: swap;
  src: local('Lora SemiBold'), local('Lora-SemiBold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-semibold-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}

@font-face {
  font-family: 'Cabin Condensed';
  font-style: normal;
  font-weight: 600;
  font-display: swap;
  src: local('Cabin Condensed SemiBold'), local('CabinCondensed-SemiBold'), url('https://martinthomson.github.io/rfc-css/fonts/cabincondensed-semibold-vietnamese.woff2') format('woff2');
  unicode-range: U+0102-0103, U+0110-0111, U+1EA0-1EF9, U+20AB;
}
@font-face {
  font-family: 'Cabin Condensed';
  font-style: normal;
  font-weight: 600;
  font-display: swap;
  src: local('Cabin Condensed SemiBold'), local('CabinCondensed-SemiBold'), url('https://martinthomson.github.io/rfc-css/fonts/cabincondensed-semibold-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Cabin Condensed';
  font-style: normal;
  font-weight: 600;
  font-display: swap;
  src: local('Cabin Condensed SemiBold'), local('CabinCondensed-SemiBold'), url('https://martinthomson.github.io/rfc-css/fonts/cabincondensed-semibold-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}

@font-face {
  font-family: 'Oxygen Mono';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Oxygen Mono'), local('OxygenMono-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/oxygenmono-regular-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Oxygen Mono';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Oxygen Mono'), local('OxygenMono-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/oxygenmono-regular-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}

:root {
  color-scheme: light dark;
  --background-color: #fff;
  --text-color: #222;
  --title-color: #191919;
  --link-color: #2a6496;
  --highlight-color: #f9f9f9;
  --line-color: #eee;
  --pilcrow-weak: #ddd;
  --pilcrow-strong: #bbb;
  --small-font-size: 14.5px;
  --font-mono: 'Oxygen Mono', monospace;
  scrollbar-color: #bbb #eee;
}
body {
  max-width: 600px;
  margin: 75px auto;
  padding: 0 5px;
  color: var(--text-color);
  background-color: var(--background-color);
  font: 16px/22px "Lora", serif;
  scroll-behavior: smooth;
}

.ears {
  display: none;
}

/* headings */
h1, h2, h3, h4, h5, h6 {
  font-family: "Cabin Condensed", sans-serif;
  font-weight: 600;
  margin: 0.8em 0 0.3em;
  font-size-adjust: 0.5;
  color: var(--title-color);
}
h1#title {
  font-size: 32px;
  line-height: 40px;
  clear: both;
}
h1#title, h1#rfcnum {
  margin: 1.5em 0 0.2em;
}
h1#rfcnum + h1#title {
  margin: 0.2em 0;
}

h1, h2, h3 {
  font-size: 22px;
  line-height: 27px;
}
h4, h5, h6 {
  font-size: 20px;
  line-height: 24px;
}

/* general structure */
.author {
  padding-bottom: 0.3em;
}
#abstract+p {
  font-size: 18px;
  line-height: 24px;
}
#abstract+p code, #abstract+p samp, #abstract+p tt {
  font-size: 16px;
  line-height: 0;
}

p {
  padding: 0;
  margin: 0.5em 0;
  text-align: left;
}
div {
  margin: 0;
}
.alignRight.art-text {
  background-color: var(--highlight-color);
  border: 1px solid var(--line-color);
  border-radius: 3px;
  padding: 0.5em 1em 0;
  margin-bottom: 0.5em;
}
.alignRight.art-text pre {
  padding: 0;
  width: auto;
}
.alignRight {
  margin: 1em 0;
}
.alignRight > *:first-child {
  border: none;
  margin: 0;
  float: right;
  clear: both;
}
.alignRight > *:nth-child(2) {
  clear: both;
  display: block;
  border: none;
}
svg {
  display: block;
}
/* font-family isn't space-separated, but =~ will have to do */
svg[font-family~="monospace" i], svg [font-family~="monospace" i] {
  font-family: var(--font-mono);
}
.alignCenter.art-text {
  background-color: var(--highlight-color);
  border: 1px solid var(--line-color);
  border-radius: 3px;
  padding: 0.5em 1em 0;
  margin-bottom: 0.5em;
}
.alignCenter.art-text pre {
  padding: 0;
  width: auto;
}
.alignCenter {
  margin: 1em 0;
}
.alignCenter > *:first-child {
  border: none;
  /* this isn't optimal, but it's an existence proof.  PrinceXML doesn't
     support flexbox yet.
  */
  display: table;
  margin: 0 auto;
}

/* lists */
ol, ul {
  padding: 0;
  margin: 0 0 0.5em 2em;
}
:is(ol, ul) :is(ol, ul) {
  margin-left: 1em;
}
li {
  margin: 0 0 0.25em 0;
}
.ulCompact li {
  margin: 0;
}
ul.empty, .ulEmpty {
  list-style-type: none;
}
ul.empty li, .ulEmpty li {
  margin-top: 0.5em;
}
:is(ul, ol).compact, .ulCompact, .olCompact {
  line-height: 1;
  margin: 0 0 0 2em;
}

/* definition lists */
dl {
  clear: left;
  --indent: 3ch;
  /* --indent: attr(indent ch); not supported in any browser, but we can dream */
}
dl.olPercent {
  --indent: 5ch;
}
dl > dt {
  float: left;
  margin-right: 2ch;
  min-width: 8ch;
}
dl.dlNewline > dt {
  float: none;
}
dl > dd {
  margin-bottom: .8em;
  margin-left: var(--indent) !important; /* stupid element overrides */
  min-height: 2ex;
}
dl.olPercent > dt {
  min-width: calc(var(--indent) - 2ch);
}
:is(dl.compact, .dlCompact) > dd {
  margin-bottom: 0;
}
:is(dl.compact, .dlCompact) > dd > :is(:first-child, .break:first-child + *) {
  margin-top: 0;
}
:is(dl.compact, .dlCompact) > dd > :is(:last-child) {
  margin-bottom: 0;
}
dl > dd > dl {
  margin-top: 0.5em;
  margin-bottom: 0;
}
:is(dd, span).break {
  display: none;
}

/* links */
a, a[href].selfRef:hover {
  text-decoration: none;
}
a[href] {
  color: var(--link-color);
}
a[href].selfRef, .iref + a[href].internal {
  color: var(--text-color);
}
a[href]:hover {
  text-decoration: underline;
}
a[href].selfRef:hover {
  background-color: var(--highlight-color);
}
a.xref:is(.cite, .auto), :is(#status-of-memo, #copyright) a {
  white-space: nowrap;
}

/* Figures */
tt, code, pre {
  background-color: var(--highlight-color);
  font: 14px/22px var(--font-mono);
}
tt, code {
  /* changing the font for inline elements leads to different ascender
     and descender heights; as we want to retain baseline alignment,
     remove leading to avoid altering the final height of lines
     note: this fails if these blocks take an entire line,
     a different solution would be great */
  line-height: 0;
}
:is(h1, h2, h3, h4, h5, h6) :is(tt, code) {
  font-size: 84%;
}
pre {
  border: 1px solid var(--line-color);
  font-size: 13.5px;
  line-height: 16px;
  letter-spacing: -0.2px;
  margin: 5px;
  padding: 5px;
}
img {
  max-width: 100%;
}
figure {
  margin: 0.5em 0;
  padding: 0;
}
figure blockquote {
  margin: 0.8em 0.4em 0.4em;
}
figcaption, caption {
  font-style: italic;
  margin: 0.5em 1.5em;
  text-align: left;
}
@media screen {
  /* Auto-collapse boilerplate. */
  :is(#status-of-memo, #copyright) p {
    margin: -2px 0;
    max-height: 0;
    transition: max-height 2s ease, margin 0.5s ease 0.5s;
    overflow: hidden;
  }
  :is(#status-of-memo, #copyright):hover p,
  :is(#status-of-memo, #copyright) h2:target ~ p {
    margin: 0.5em 0;
    max-height: 500px;
    overflow: auto;
  }
  pre, svg {
    display: inline-block;
    overflow-x: auto;
  }
  pre {
    max-width: 100%;
    width: calc(100% - 22px - 1em);
  }
  svg {
    max-width: calc(100% - 22px - 1em);
  }
  figure pre {
    display: block;
    width: calc(100% - 25px);
  }
  :is(pre, svg) + .pilcrow {
    display: inline-block;
    vertical-align: text-bottom;
    padding-bottom: 8px;
  }
}

/* aside, blockquote */
aside, blockquote {
  margin-left: 0;
  padding: 0 2em;
  font-style: italic;
}
blockquote {
  margin: 1em 0;
}
cite {
  display: block;
  text-align: right;
  font-style: italic;
}

/* tables */
table {
  max-width: 100%;
  margin: 0 0 1em;
  border-collapse: collapse;
}
table.right {
  margin-left: auto;
}
table.center {
  margin-left: auto;
  margin-right: auto;
}
table.left {
  margin-right: auto;
}
thead, tbody {
  border: 1px solid var(--line-color);
}
th, td {
  text-align: left;
  vertical-align: top;
  padding: 5px 10px;
}
th {
  background-color: var(--line-color);
}
:is(tr:nth-child(2n), thead+tbody > tr:nth-child(2n+1)) > td {
  background-color: var(--background-color);
}
:is(tr:nth-child(2n+1), thead+tbody > tr:nth-child(2n)) > td {
  background-color: var(--highlight-color);
}
table caption {
  margin: 0;
  padding: 3px 0 3px 1em;
}
table p {
  margin: 0;
}

/* pilcrow */
a.pilcrow {
  margin-left: 3px;
  opacity: 0.2;
  user-select: none;
}
a.pilcrow[href] { color: var(--pilcrow-weak); }
a.pilcrow[href]:hover { text-decoration: none; }
@media not print {
  :hover > a.pilcrow {
    opacity: 1;
  }
  a.pilcrow[href]:hover {
    color: var(--pilcrow-strong);
    background-color: transparent;
  }
}
@media print {
  a.pilcrow {
    display: none;
  }
}

/* misc */
hr {
  border: 0;
  border-top: 1px solid var(--line-color);
}
.bcp14 {
  font-variant: small-caps;
  font-weight: 600;
  font-size: var(--small-font-size);
}
.role {
  font-variant: all-small-caps;
}
sub, sup {
  line-height: 1;
  font-size: 80%;
}

/* info block */
#identifiers {
  margin: 0;
  font-size: var(--small-font-size);
  line-height: 18px;
  --identifier-width: 15ch;
}
#identifiers dt {
  width: var(--identifier-width);
  min-width: var(--identifier-width);
  clear: left;
  float: left;
  text-align: right;
  margin-right: 1ch;
}
#identifiers dd {
  margin: 0;
  margin-left: calc(1em + var(--identifier-width)) !important;
  min-width: 5em;
}
#identifiers .authors .author {
  display: inline-block;
  margin-right: 1.5em;
}
#identifiers .authors .org {
  font-style: italic;
}

/* The prepared/rendered info at the very bottom of the page */
.docInfo {
  color: #999;
  font-size: 0.9em;
  font-style: italic;
  margin-top: 2em;
}
.docInfo .prepared {
  float: left;
}
.docInfo .prepared {
  float: right;
}

/* table of contents */
#toc {
  padding: 0.75em 0 2em 0;
  margin-bottom: 1em;
}
#toc nav ul {
  margin: 0 0.5em 0 0;
  padding: 0;
  list-style: none;
}
#toc nav li {
  line-height: 1.3em;
  margin: 2px 0;
  padding-left: 1.2em;
  text-indent: -1.2em;
}
#toc a.xref {
  white-space: normal;
}
/* references */
.references dt {
  text-align: right;
  font-weight: bold;
  min-width: 10ch;
  margin-right: 1.5ch;
}
.references dt:target::before {
  content: "⇒";
  width: 15px;
  margin: 0 10px 0 -25px;
}
.references dd {
  margin-left: 12ch !important;
  overflow: auto;
}

.refInstance {
  margin-bottom: 1.25em;
}

.references .ascii {
  margin-bottom: 0.25em;
}

/* index */
#rfc\.index\.index + ul {
  margin-left: 0;
}

/* authors */
address.vcard {
  font-style: normal;
  margin: 1em 0;
}
address.vcard .nameRole {
  font-weight: 700;
  margin-left: 0;
}
address.vcard .label {
  margin: 0.5em 0;
}
address.vcard .type {
  display: none;
}
.alternative-contact {
  margin: 1.5em 0 1em;
}
hr.addr {
  border-top: 1px dashed;
  margin: 0;
  color: #ddd;
  max-width: calc(100% - 16px);
}
@media (min-width: 500px) {
  #authors-addresses > section {
    column-count: 2;
    column-gap: 20px;
  }
  #authors-addresses > section > h2 {
    column-span: all;
  }
  /* hack for break-inside: avoid-column */
  #authors-addresses address {
    display: inline-block;
    break-inside: avoid-column;
  }
}

.rfcEditorRemove p:first-of-type {
  font-style: italic;
}
.cref {
  background-color: rgba(249, 232, 105, 0.3);
  padding: 2px 4px;
}
.crefSource {
  font-style: italic;
}
/* alternative layout for smaller screens */
@media screen and (max-width: 929px) {
  #toc {
    position: fixed;
    z-index: 2;
    top: 0;
    right: 0;
    padding: 1px 0 0 0;
    margin: 0;
    border-bottom: 1px solid #ccc;
    opacity: 0.6;
  }
  #toc.active {
      opacity: 1;
  }
  #toc h2 {
    margin: 0;
    padding: 2px 0 2px 6px;
    padding-right: 1em;
    font-size: 18px;
    line-height: 24px;
    min-width: 190px;
    text-align: right;
    background-color: #444;
    color: white;
    cursor: pointer;
  }
  #toc h2::before { /* css hamburger */
    float: right;
    position: relative;
    width: 1em;
    height: 1px;
    left: -164px;
    margin: 8px 0 0 0;
    background: white none repeat scroll 0 0;
    box-shadow: 0 4px 0 0 white, 0 8px 0 0 white;
    content: "";
  }
  #toc nav {
    display: none;
    background-color: var(--background-color);
    padding: 0.5em 1em 1em;
    overflow: auto;
    overscroll-behavior: contain;
    height: calc(100vh - 48px);
    border-left: 1px solid #ddd;
  }
  #toc.active nav {
    display: block;
  }
  /* Make the collapsed ToC header render white on gray also when it's a link */
  #toc h2 a,
  #toc h2 a:link,
  #toc h2 a:focus,
  #toc h2 a:hover,
  #toc a.toplink,
  #toc a.toplink:hover {
    color: white;
    background-color: #444;
    text-decoration: none;
  }
  #toc a.toplink {
    margin-top: 2px;
  }
}

/* alternative layout for wide screens */
@media screen and (min-width: 930px) {
  body {
    padding-right: 360px;
    padding-right: calc(min(180px + 20%, 500px));
  }
  #toc {
    position: fixed;
    bottom: 0;
    right: 0;
    right: calc(50vw - 480px);
    width: 312px;
    margin: 0;
    padding: 0;
    z-index: 1;
  }
  #toc h2 {
    margin: 0;
    padding: 0.25em 1em 1em 0;
  }
  #toc nav {
    display: block;
    height: calc(90vh - 84px);
    bottom: 0;
    padding: 0.5em 0 2em;
    overflow: auto;
    overscroll-behavior: contain;
    scrollbar-width: thin;
  }
  #toc nav > ul  {
    margin-bottom: 2em;
  }
  #toc ul {
    margin: 0 0 0 4px;
    font-size: var(--small-font-size);
  }
  #toc ul :is(p, li) {
    margin: 2px 0;
    line-height: 22px;
  }
  img { /* future proofing */
    max-width: 100%;
    height: auto;
  }
}

/* pagination */
@media print {
  body {
    width: 100%;
  }
  p {
    orphans: 3;
    widows: 3;
  }
  #n-copyright-notice {
    border-bottom: none;
  }
  #toc, #n-introduction {
    page-break-before: always;
  }
  #toc {
    border-top: none;
    padding-top: 0;
  }
  figure, pre, .vcard {
    page-break-inside: avoid;
  }
  h1, h2, h3, h4, h5, h6 {
    page-break-after: avoid;
  }
  :is(h2, h3, h4, h5, h6)+*, dd {
    page-break-before: avoid;
  }
  pre {
    white-space: pre-wrap;
    word-wrap: break-word;
    font-size: 10pt;
  }
  table {
    border: 1px solid #ddd;
  }
  td {
    border-top: 1px solid #ddd;
  }
  .toplink {
    display: none;
  }
}

@page :first {
  padding-top: 0;
  @top-left {
    content: normal;
    border: none;
  }
  @top-center {
    content: normal;
    border: none;
  }
  @top-right {
    content: normal;
    border: none;
  }
}

@page {
  size: A4;
  margin-bottom: 45mm;
  padding-top: 20px;
}

/* Changes introduced to fix issues found during implementation */

/* Separate body from document info even without intervening H1 */
section {
  clear: both;
}

/* Top align author divs, to avoid names without organization dropping level with org names */
.author {
  vertical-align: top;
}

/* Style section numbers with more space between number and title */
.section-number {
  padding-right: 0.5em;
}

/* Add styling for a link in the ToC that points to the top of the document */
a.toplink {
  float: right;
  margin: 8px 0.5em 0;
}

/* Provide styling for table cell text alignment */
table .text-left {
  text-align: left;
}
table .text-center {
  text-align: center;
}
table .text-right {
  text-align: right;
}

/* Make the alternative author contact information look less like just another
   author, and group it closer with the primary author contact information */
.alternative-contact {
  margin: 0.5em 0 0.25em 0;
}
address .non-ascii {
  margin: 0 0 0 2em;
}

/* With it being possible to set tables with alignment
  left, center, and right, { width: 100%; } does not make sense */
table {
  width: auto;
}

/* Avoid reference text that sits in a block with very wide left margin,
   because of a long floating dt label.*/
.references dd {
  overflow: visible;
}

/* Control caption placement */
caption {
  caption-side: bottom;
}

/* Limit the width of the author address vcard, so names in right-to-left
   script don't end up on the other side of the page. */

address.vcard {
  max-width: 20em;
  margin-right: auto;
}

/* For address alignment dependent on LTR or RTL scripts */
address div.left {
  text-align: left;
}
address div.right {
  text-align: right;
}

/* Dark mode. */
@media (prefers-color-scheme: dark) {
:root {
  --background-color: #121212;
  --text-color: #f0f0f0;
  --title-color: #fff;
  --link-color: #4da4f0;
  --highlight-color: #282828;
  --line-color: #444;
  --pilcrow-weak: #444;
  --pilcrow-strong: #666;
  scrollbar-color: #777 #333;
}
}

/* SVG Trick: a prefix match works because only black and white are allowed */
svg :is([stroke="black"], [stroke^="#000"]) {
  stroke: var(--text-color);
}
svg :is([stroke="white"], [stroke^="#fff"]) {
  stroke: var(--background-color);
}
svg :is([fill="black"], [fill^="#000"], :not([fill])) {
  fill: var(--text-color);
}
svg :is([fill="white"], [fill^="#fff"]) {
  fill: var(--background-color);
}
</style>

</head>
<body class="xml2rfc">
<table class="ears">
<thead><tr>
<td class="left">Internet-Draft</td>
<td class="center">Use of HPKE in JOSE</td>
<td class="right">October 2024</td>
</tr></thead>
<tfoot><tr>
<td class="left">Reddy, et al.</td>
<td class="center">Expires 27 April 2025</td>
<td class="right">[Page]</td>
</tr></tfoot>
</table>
<div id="external-metadata" class="document-information"></div>
<div id="internal-metadata" class="document-information">
<dl id="identifiers">
<dt class="label-workgroup">Workgroup:</dt>
<dd class="workgroup">JOSE</dd>
<dt class="label-internet-draft">Internet-Draft:</dt>
<dd class="internet-draft">draft-ietf-jose-hpke-encrypt-latest</dd>
<dt class="label-published">Published:</dt>
<dd class="published">
<time datetime="2024-10-24" class="published">24 October 2024</time>
    </dd>
<dt class="label-intended-status">Intended Status:</dt>
<dd class="intended-status">Standards Track</dd>
<dt class="label-expires">Expires:</dt>
<dd class="expires"><time datetime="2025-04-27">27 April 2025</time></dd>
<dt class="label-authors">Authors:</dt>
<dd class="authors">
<div class="author">
      <div class="author-name">T. Reddy</div>
<div class="org">Nokia</div>
</div>
<div class="author">
      <div class="author-name">H. Tschofenig</div>
</div>
<div class="author">
      <div class="author-name">A. Banerjee</div>
<div class="org">Nokia</div>
</div>
<div class="author">
      <div class="author-name">O. Steele</div>
<div class="org">Transmute</div>
</div>
<div class="author">
      <div class="author-name">M. Jones</div>
<div class="org">Self-Issued Consulting</div>
</div>
</dd>
</dl>
</div>
<h1 id="title">Use of Hybrid Public Key Encryption (HPKE) with JSON Object Signing and Encryption (JOSE)</h1>
<section id="section-abstract">
      <h2 id="abstract"><a href="#abstract" class="selfRef">Abstract</a></h2>
<p id="section-abstract-1">This specification defines Hybrid Public Key Encryption (HPKE) for use with
JSON Object Signing and Encryption (JOSE). HPKE offers a variant of
public key encryption of arbitrary-sized plaintexts for a recipient public key.<a href="#section-abstract-1" class="pilcrow">¶</a></p>
<p id="section-abstract-2">HPKE works for any combination of an asymmetric key encapsulation mechanism (KEM),
key derivation function (KDF), and authenticated encryption with additional data
(AEAD) function. Authentication for HPKE in JOSE is provided by
JOSE-native security mechanisms or by one of the authenticated variants of HPKE.<a href="#section-abstract-2" class="pilcrow">¶</a></p>
<p id="section-abstract-3">This document defines the use of the HPKE with JOSE.<a href="#section-abstract-3" class="pilcrow">¶</a></p>
</section>
<section class="note rfcEditorRemove" id="section-note.1">
      <h2 id="name-about-this-document">
<a href="#name-about-this-document" class="section-name selfRef">About This Document</a>
      </h2>
<p id="section-note.1-1">This note is to be removed before publishing as an RFC.<a href="#section-note.1-1" class="pilcrow">¶</a></p>
<p id="section-note.1-2">
        Status information for this document may be found at <span><a href="https://datatracker.ietf.org/doc/draft-ietf-jose-hpke-encrypt/">https://datatracker.ietf.org/doc/draft-ietf-jose-hpke-encrypt/</a></span>.<a href="#section-note.1-2" class="pilcrow">¶</a></p>
<p id="section-note.1-3">
        Discussion of this document takes place on the
        jose Working Group mailing list (<span><a href="mailto:jose@ietf.org">mailto:jose@ietf.org</a></span>),
        which is archived at <span><a href="https://mailarchive.ietf.org/arch/browse/jose/">https://mailarchive.ietf.org/arch/browse/jose/</a></span>.
        Subscribe at <span><a href="https://www.ietf.org/mailman/listinfo/jose/">https://www.ietf.org/mailman/listinfo/jose/</a></span>.<a href="#section-note.1-3" class="pilcrow">¶</a></p>
</section>
<div id="status-of-memo">
<section id="section-boilerplate.1">
        <h2 id="name-status-of-this-memo">
<a href="#name-status-of-this-memo" class="section-name selfRef">Status of This Memo</a>
        </h2>
<p id="section-boilerplate.1-1">
        This Internet-Draft is submitted in full conformance with the
        provisions of BCP 78 and BCP 79.<a href="#section-boilerplate.1-1" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-2">
        Internet-Drafts are working documents of the Internet Engineering Task
        Force (IETF). Note that other groups may also distribute working
        documents as Internet-Drafts. The list of current Internet-Drafts is
        at <span><a href="https://datatracker.ietf.org/drafts/current/">https://datatracker.ietf.org/drafts/current/</a></span>.<a href="#section-boilerplate.1-2" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-3">
        Internet-Drafts are draft documents valid for a maximum of six months
        and may be updated, replaced, or obsoleted by other documents at any
        time. It is inappropriate to use Internet-Drafts as reference
        material or to cite them other than as "work in progress."<a href="#section-boilerplate.1-3" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-4">
        This Internet-Draft will expire on 27 April 2025.<a href="#section-boilerplate.1-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="copyright">
<section id="section-boilerplate.2">
        <h2 id="name-copyright-notice">
<a href="#name-copyright-notice" class="section-name selfRef">Copyright Notice</a>
        </h2>
<p id="section-boilerplate.2-1">
            Copyright (c) 2024 IETF Trust and the persons identified as the
            document authors. All rights reserved.<a href="#section-boilerplate.2-1" class="pilcrow">¶</a></p>
<p id="section-boilerplate.2-2">
            This document is subject to BCP 78 and the IETF Trust's Legal
            Provisions Relating to IETF Documents
            (<span><a href="https://trustee.ietf.org/license-info">https://trustee.ietf.org/license-info</a></span>) in effect on the date of
            publication of this document. Please review these documents
            carefully, as they describe your rights and restrictions with
            respect to this document. Code Components extracted from this
            document must include Revised BSD License text as described in
            Section 4.e of the Trust Legal Provisions and are provided without
            warranty as described in the Revised BSD License.<a href="#section-boilerplate.2-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="toc">
<section id="section-toc.1">
        <a href="#" onclick="scroll(0,0)" class="toplink">▲</a><h2 id="name-table-of-contents">
<a href="#name-table-of-contents" class="section-name selfRef">Table of Contents</a>
        </h2>
<nav class="toc"><ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1">
            <p id="section-toc.1-1.1.1" class="keepWithNext"><a href="#section-1" class="auto internal xref">1</a>.  <a href="#name-introduction" class="internal xref">Introduction</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2">
            <p id="section-toc.1-1.2.1" class="keepWithNext"><a href="#section-2" class="auto internal xref">2</a>.  <a href="#name-conventions-and-definitions" class="internal xref">Conventions and Definitions</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3">
            <p id="section-toc.1-1.3.1" class="keepWithNext"><a href="#section-3" class="auto internal xref">3</a>.  <a href="#name-conventions-and-terminology" class="internal xref">Conventions and Terminology</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4">
            <p id="section-toc.1-1.4.1"><a href="#section-4" class="auto internal xref">4</a>.  <a href="#name-overview" class="internal xref">Overview</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.1">
                <p id="section-toc.1-1.4.2.1.1"><a href="#section-4.1" class="auto internal xref">4.1</a>.  <a href="#name-auxiliary-authenticated-app" class="internal xref">Auxiliary Authenticated Application Information</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.2">
                <p id="section-toc.1-1.4.2.2.1"><a href="#section-4.2" class="auto internal xref">4.2</a>.  <a href="#name-encapsulated-keys" class="internal xref">Encapsulated Keys</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5">
            <p id="section-toc.1-1.5.1"><a href="#section-5" class="auto internal xref">5</a>.  <a href="#name-integrated-encryption" class="internal xref">Integrated Encryption</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6">
            <p id="section-toc.1-1.6.1"><a href="#section-6" class="auto internal xref">6</a>.  <a href="#name-key-encryption" class="internal xref">Key Encryption</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7">
            <p id="section-toc.1-1.7.1"><a href="#section-7" class="auto internal xref">7</a>.  <a href="#name-security-considerations" class="internal xref">Security Considerations</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.1">
                <p id="section-toc.1-1.7.2.1.1"><a href="#section-7.1" class="auto internal xref">7.1</a>.  <a href="#name-plaintext-compression" class="internal xref">Plaintext Compression</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.2">
                <p id="section-toc.1-1.7.2.2.1"><a href="#section-7.2" class="auto internal xref">7.2</a>.  <a href="#name-header-parameters" class="internal xref">Header Parameters</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.3">
                <p id="section-toc.1-1.7.2.3.1"><a href="#section-7.3" class="auto internal xref">7.3</a>.  <a href="#name-ensure-cryptographic-keys-h" class="internal xref">Ensure Cryptographic Keys Have Sufficient Entropy</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.4">
                <p id="section-toc.1-1.7.2.4.1"><a href="#section-7.4" class="auto internal xref">7.4</a>.  <a href="#name-validate-cryptographic-inpu" class="internal xref">Validate Cryptographic Inputs</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.5">
                <p id="section-toc.1-1.7.2.5.1"><a href="#section-7.5" class="auto internal xref">7.5</a>.  <a href="#name-use-appropriate-algorithms" class="internal xref">Use Appropriate Algorithms</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8">
            <p id="section-toc.1-1.8.1"><a href="#section-8" class="auto internal xref">8</a>.  <a href="#name-iana-considerations" class="internal xref">IANA Considerations</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.1">
                <p id="section-toc.1-1.8.2.1.1"><a href="#section-8.1" class="auto internal xref">8.1</a>.  <a href="#name-ciphersuite-registration" class="internal xref">Ciphersuite Registration</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.2">
                <p id="section-toc.1-1.8.2.2.1"><a href="#section-8.2" class="auto internal xref">8.2</a>.  <a href="#name-json-web-signature-and-encr" class="internal xref">JSON Web Signature and Encryption Algorithms</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.2.2.1">
                    <p id="section-toc.1-1.8.2.2.2.1.1"><a href="#section-8.2.1" class="auto internal xref">8.2.1</a>.  <a href="#name-hpke-p256-sha256-a128gcm" class="internal xref">HPKE-P256-SHA256-A128GCM</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.2.2.2">
                    <p id="section-toc.1-1.8.2.2.2.2.1"><a href="#section-8.2.2" class="auto internal xref">8.2.2</a>.  <a href="#name-hpke-p384-sha384-a256gcm" class="internal xref">HPKE-P384-SHA384-A256GCM</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.2.2.3">
                    <p id="section-toc.1-1.8.2.2.2.3.1"><a href="#section-8.2.3" class="auto internal xref">8.2.3</a>.  <a href="#name-hpke-p521-sha512-a256gcm" class="internal xref">HPKE-P521-SHA512-A256GCM</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.2.2.4">
                    <p id="section-toc.1-1.8.2.2.2.4.1"><a href="#section-8.2.4" class="auto internal xref">8.2.4</a>.  <a href="#name-hpke-x25519-sha256-a128gcm" class="internal xref">HPKE-X25519-SHA256-A128GCM</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.2.2.5">
                    <p id="section-toc.1-1.8.2.2.2.5.1"><a href="#section-8.2.5" class="auto internal xref">8.2.5</a>.  <a href="#name-hpke-x25519-sha256-chacha20" class="internal xref">HPKE-X25519-SHA256-ChaCha20Poly1305</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.2.2.6">
                    <p id="section-toc.1-1.8.2.2.2.6.1"><a href="#section-8.2.6" class="auto internal xref">8.2.6</a>.  <a href="#name-hpke-x448-sha512-a256gcm" class="internal xref">HPKE-X448-SHA512-A256GCM</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.2.2.7">
                    <p id="section-toc.1-1.8.2.2.2.7.1"><a href="#section-8.2.7" class="auto internal xref">8.2.7</a>.  <a href="#name-hpke-x448-sha512-chacha20po" class="internal xref">HPKE-X448-SHA512-ChaCha20Poly1305</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.3">
                <p id="section-toc.1-1.8.2.3.1"><a href="#section-8.3" class="auto internal xref">8.3</a>.  <a href="#name-json-web-signature-and-encry" class="internal xref">JSON Web Signature and Encryption Header Parameters</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.3.2.1">
                    <p id="section-toc.1-1.8.2.3.2.1.1"><a href="#section-8.3.1" class="auto internal xref">8.3.1</a>.  <a href="#name-ek" class="internal xref">ek</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.3.2.2">
                    <p id="section-toc.1-1.8.2.3.2.2.1"><a href="#section-8.3.2" class="auto internal xref">8.3.2</a>.  <a href="#name-psk_id" class="internal xref">psk_id</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.3.2.3">
                    <p id="section-toc.1-1.8.2.3.2.3.1"><a href="#section-8.3.3" class="auto internal xref">8.3.3</a>.  <a href="#name-auth_kid" class="internal xref">auth_kid</a></p>
</li>
                </ul>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9">
            <p id="section-toc.1-1.9.1"><a href="#section-9" class="auto internal xref">9</a>.  <a href="#name-references" class="internal xref">References</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9.2.1">
                <p id="section-toc.1-1.9.2.1.1"><a href="#section-9.1" class="auto internal xref">9.1</a>.  <a href="#name-normative-references" class="internal xref">Normative References</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9.2.2">
                <p id="section-toc.1-1.9.2.2.1"><a href="#section-9.2" class="auto internal xref">9.2</a>.  <a href="#name-informative-references" class="internal xref">Informative References</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10">
            <p id="section-toc.1-1.10.1"><a href="#appendix-A" class="auto internal xref">Appendix A</a>.  <a href="#name-examples" class="internal xref">Examples</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10.2.1">
                <p id="section-toc.1-1.10.2.1.1"><a href="#appendix-A.1" class="auto internal xref">A.1</a>.  <a href="#name-integrated-encryption-2" class="internal xref">Integrated Encryption</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10.2.1.2.1">
                    <p id="section-toc.1-1.10.2.1.2.1.1"><a href="#appendix-A.1.1" class="auto internal xref">A.1.1</a>.  <a href="#name-example-0" class="internal xref">Example 0</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10.2.1.2.2">
                    <p id="section-toc.1-1.10.2.1.2.2.1"><a href="#appendix-A.1.2" class="auto internal xref">A.1.2</a>.  <a href="#name-example-1" class="internal xref">Example 1</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10.2.2">
                <p id="section-toc.1-1.10.2.2.1"><a href="#appendix-A.2" class="auto internal xref">A.2</a>.  <a href="#name-key-encryption-2" class="internal xref">Key Encryption</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10.2.2.2.1">
                    <p id="section-toc.1-1.10.2.2.2.1.1"><a href="#appendix-A.2.1" class="auto internal xref">A.2.1</a>.  <a href="#name-example-2" class="internal xref">Example 2</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10.2.2.2.2">
                    <p id="section-toc.1-1.10.2.2.2.2.1"><a href="#appendix-A.2.2" class="auto internal xref">A.2.2</a>.  <a href="#name-example-3" class="internal xref">Example 3</a></p>
</li>
                </ul>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11">
            <p id="section-toc.1-1.11.1"><a href="#appendix-B" class="auto internal xref"></a><a href="#name-acknowledgments" class="internal xref">Acknowledgments</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.12">
            <p id="section-toc.1-1.12.1"><a href="#appendix-C" class="auto internal xref"></a><a href="#name-document-history" class="internal xref">Document History</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.13">
            <p id="section-toc.1-1.13.1"><a href="#appendix-D" class="auto internal xref"></a><a href="#name-authors-addresses" class="internal xref">Authors' Addresses</a></p>
</li>
        </ul>
</nav>
</section>
</div>
<div id="introduction">
<section id="section-1">
      <h2 id="name-introduction">
<a href="#section-1" class="section-number selfRef">1. </a><a href="#name-introduction" class="section-name selfRef">Introduction</a>
      </h2>
<p id="section-1-1">Hybrid Public Key Encryption (HPKE) <span>[<a href="#RFC9180" class="cite xref">RFC9180</a>]</span> is a scheme that
provides public key encryption of arbitrary-sized plaintexts given a
recipient's public key.<a href="#section-1-1" class="pilcrow">¶</a></p>
<p id="section-1-2">This specification enables JSON Web Encryption (JWE) to leverage HPKE,
bringing support for KEMs and the possibility of Post Quantum or Hybrid KEMs to JWE.<a href="#section-1-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="conventions-and-definitions">
<section id="section-2">
      <h2 id="name-conventions-and-definitions">
<a href="#section-2" class="section-number selfRef">2. </a><a href="#name-conventions-and-definitions" class="section-name selfRef">Conventions and Definitions</a>
      </h2>
<p id="section-2-1">The key words "<span class="bcp14">MUST</span>", "<span class="bcp14">MUST NOT</span>", "<span class="bcp14">REQUIRED</span>", "<span class="bcp14">SHALL</span>", "<span class="bcp14">SHALL NOT</span>", "<span class="bcp14">SHOULD</span>", "<span class="bcp14">SHOULD NOT</span>", "<span class="bcp14">RECOMMENDED</span>", "<span class="bcp14">NOT RECOMMENDED</span>",
"<span class="bcp14">MAY</span>", and "<span class="bcp14">OPTIONAL</span>" in this document are to be interpreted as
described in BCP 14 <span>[<a href="#RFC2119" class="cite xref">RFC2119</a>]</span> <span>[<a href="#RFC8174" class="cite xref">RFC8174</a>]</span> when, and only when, they
appear in all capitals, as shown here.<a href="#section-2-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="conventions-and-terminology">
<section id="section-3">
      <h2 id="name-conventions-and-terminology">
<a href="#section-3" class="section-number selfRef">3. </a><a href="#name-conventions-and-terminology" class="section-name selfRef">Conventions and Terminology</a>
      </h2>
<p id="section-3-1">This specification uses the following abbreviations and terms:<a href="#section-3-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3-2.1">
          <p id="section-3-2.1.1">Content Encryption Key (CEK), is defined in <span>[<a href="#RFC7517" class="cite xref">RFC7517</a>]</span>.<a href="#section-3-2.1.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-3-2.2">
          <p id="section-3-2.2.1">Hybrid Public Key Encryption (HPKE) is defined in <span>[<a href="#RFC9180" class="cite xref">RFC9180</a>]</span>.<a href="#section-3-2.2.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-3-2.3">
          <p id="section-3-2.3.1">pkR is the public key of the recipient, as defined in <span>[<a href="#RFC9180" class="cite xref">RFC9180</a>]</span>.<a href="#section-3-2.3.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-3-2.4">
          <p id="section-3-2.4.1">skR is the private key of the recipient, as defined in <span>[<a href="#RFC9180" class="cite xref">RFC9180</a>]</span>.<a href="#section-3-2.4.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-3-2.5">
          <p id="section-3-2.5.1">Key Encapsulation Mechanism (KEM), see <span>[<a href="#RFC9180" class="cite xref">RFC9180</a>]</span>.<a href="#section-3-2.5.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-3-2.6">
          <p id="section-3-2.6.1">Key Derivation Function (KDF), see <span>[<a href="#RFC9180" class="cite xref">RFC9180</a>]</span>.<a href="#section-3-2.6.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-3-2.7">
          <p id="section-3-2.7.1">Authenticated Encryption with Associated Data (AEAD), see <span>[<a href="#RFC9180" class="cite xref">RFC9180</a>]</span>.<a href="#section-3-2.7.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-3-2.8">
          <p id="section-3-2.8.1">Additional Authenticated Data (AAD), see <span>[<a href="#RFC9180" class="cite xref">RFC9180</a>]</span>.<a href="#section-3-2.8.1" class="pilcrow">¶</a></p>
</li>
      </ul>
</section>
</div>
<div id="overview">
<section id="section-4">
      <h2 id="name-overview">
<a href="#section-4" class="section-number selfRef">4. </a><a href="#name-overview" class="section-name selfRef">Overview</a>
      </h2>
<p id="section-4-1">This specification describes two modes of use for HPKE in JWE:<a href="#section-4-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4-2.1">
          <p id="section-4-2.1.1">HPKE JWE Integrated Encryption, where HPKE is used to encrypt the plaintext.<a href="#section-4-2.1.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-4-2.2">
          <p id="section-4-2.2.1">HPKE JWE Key Encryption, where HPKE is used to encrypt a content encryption key (CEK) and the CEK is subsequently used to encrypt the plaintext.<a href="#section-4-2.2.1" class="pilcrow">¶</a></p>
</li>
      </ul>
<p id="section-4-3">When "alg" and "enc" are both present in a protected header and when "iv" and "tag" are empty, the mode is HPKE JWE Integrated Encryption.<a href="#section-4-3" class="pilcrow">¶</a></p>
<p id="section-4-4">When "enc" is present in a protected header and "alg" is absent, the mode is HPKE JWE Key Encryption when a valid HPKE "alg" value is present in the unprotected headers.<a href="#section-4-4" class="pilcrow">¶</a></p>
<p id="section-4-5">HPKE supports several modes, which are described in Table 1 of <span>[<a href="#RFC9180" class="cite xref">RFC9180</a>]</span>.<a href="#section-4-5" class="pilcrow">¶</a></p>
<p id="section-4-6">In JWE, the use of specific HPKE modes such as "mode_base" or "mode_auth_psk" is determined by the presence of the header parameters "psk_id" and "auth_kid".<a href="#section-4-6" class="pilcrow">¶</a></p>
<p id="section-4-7">JWE supports different serializations, including Compact JWE Serialization as described in Section 3.1 of <span>[<a href="#RFC7516" class="cite xref">RFC7516</a>]</span>, General JWE JSON Serialization as described in Section 3.2 of <span>[<a href="#RFC7516" class="cite xref">RFC7516</a>]</span>.<a href="#section-4-7" class="pilcrow">¶</a></p>
<p id="section-4-8">Certain JWE features are only supported in specific serializations.<a href="#section-4-8" class="pilcrow">¶</a></p>
<p id="section-4-9">For example Compact JWE Serialization does not support the following:<a href="#section-4-9" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4-10.1">
          <p id="section-4-10.1.1">additional authenticated data<a href="#section-4-10.1.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-4-10.2">
          <p id="section-4-10.2.1">multiple recipients<a href="#section-4-10.2.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-4-10.3">
          <p id="section-4-10.3.1">unprotected headers<a href="#section-4-10.3.1" class="pilcrow">¶</a></p>
</li>
      </ul>
<p id="section-4-11">HPKE JWE Key Encryption can be used with "aad" but only when not expressed with Compact JWE Serialization.<a href="#section-4-11" class="pilcrow">¶</a></p>
<p id="section-4-12">Single recipient HPKE JWE Key Encryption with no "aad" can be expressed in Compact JWE Serialization, so long as the recipient and sender use the same HPKE Setup process as described in { Section 5 of RFC9180 }.<a href="#section-4-12" class="pilcrow">¶</a></p>
<div id="auxiliary-authenticated-application-information">
<section id="section-4.1">
        <h3 id="name-auxiliary-authenticated-app">
<a href="#section-4.1" class="section-number selfRef">4.1. </a><a href="#name-auxiliary-authenticated-app" class="section-name selfRef">Auxiliary Authenticated Application Information</a>
        </h3>
<p id="section-4.1-1">HPKE has two places at which applications can specify auxiliary authenticated information as described in { Section 8.1 of RFC9180 }.<a href="#section-4.1-1" class="pilcrow">¶</a></p>
<p id="section-4.1-2">HPKE algorithms are not required to process "apu" and "apv" as described in Section 4.6.1 of <span>[<a href="#RFC7518" class="cite xref">RFC7518</a>]</span>, despite appearing to be similar to key agreement algorithms (such as "ECDH-ES").<a href="#section-4.1-2" class="pilcrow">¶</a></p>
<p id="section-4.1-3">The "Setup info" <span class="bcp14">MUST NOT</span> be used with either HPKE JWE Integrated Encryption and HPKE JWE Key Encryption.<a href="#section-4.1-3" class="pilcrow">¶</a></p>
<p id="section-4.1-4">The "aad parameter" for Open() and Seal() <span class="bcp14">MUST</span> be used with both HPKE JWE Integrated Encryption and HPKE JWE Key Encryption.<a href="#section-4.1-4" class="pilcrow">¶</a></p>
<p id="section-4.1-5">To avoid confusion between JWE AAD and HPKE AAD, this document uses the term "HPKE AEAD AAD" to refer the "aad parameter" for Open() and Seal().<a href="#section-4.1-5" class="pilcrow">¶</a></p>
<p id="section-4.1-6">The HPKE AEAD AAD <span class="bcp14">MUST</span> be set to the "JWE Additional Authenticated Data encryption parameter" defined in Step 14 of Section 5.1 of <span>[<a href="#RFC7516" class="cite xref">RFC7516</a>]</span> which is repeated here for clarity:<a href="#section-4.1-6" class="pilcrow">¶</a></p>
<p id="section-4.1-7">Let the Additional Authenticated Data encryption parameter be ASCII(Encoded Protected Header).
However, if a JWE AAD value is present (which can only be the case when using the JWE JSON Serialization), instead let the Additional Authenticated Data encryption parameter be ASCII(Encoded Protected Header || '.' || BASE64URL(JWE AAD)).<a href="#section-4.1-7" class="pilcrow">¶</a></p>
</section>
</div>
<div id="encapsulated-keys">
<section id="section-4.2">
        <h3 id="name-encapsulated-keys">
<a href="#section-4.2" class="section-number selfRef">4.2. </a><a href="#name-encapsulated-keys" class="section-name selfRef">Encapsulated Keys</a>
        </h3>
<p id="section-4.2-1">Encapsulated keys <span class="bcp14">MUST</span> be the base64url encoded encapsulated key as defined in Section 5.1.1 of <span>[<a href="#RFC9180" class="cite xref">RFC9180</a>]</span>.<a href="#section-4.2-1" class="pilcrow">¶</a></p>
<p id="section-4.2-2">In HPKE JWE Integrated Encryption, JWE Encrypted Key is the encapsulated key.<a href="#section-4.2-2" class="pilcrow">¶</a></p>
<p id="section-4.2-3">In HPKE JWE Key Encryption, each recipient JWE Encrypted Key is the encrypted content encryption key, and the encapsulated key is found in the recipient header.<a href="#section-4.2-3" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="integrated-encryption">
<section id="section-5">
      <h2 id="name-integrated-encryption">
<a href="#section-5" class="section-number selfRef">5. </a><a href="#name-integrated-encryption" class="section-name selfRef">Integrated Encryption</a>
      </h2>
<p id="section-5-1">In HPKE JWE Integrated Encryption:<a href="#section-5-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-5-2.1">
          <p id="section-5-2.1.1">The protected header <span class="bcp14">MUST</span> contain an "alg" that starts with "HPKE".<a href="#section-5-2.1.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-5-2.2">
          <p id="section-5-2.2.1">The protected header <span class="bcp14">MUST</span> contain an "enc" that is registered in both the IANA HPKE AEAD Identifiers Registry, and the IANA JSON Web Signature and Encryption Algorithms Registry.<a href="#section-5-2.2.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-5-2.3">
          <p id="section-5-2.3.1">The protected header parameters "psk_id" and "auth_kid" <span class="bcp14">MAY</span> be present.<a href="#section-5-2.3.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-5-2.4">
          <p id="section-5-2.4.1">The protected header parameters "ek" <span class="bcp14">MUST NOT</span> be present.<a href="#section-5-2.4.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-5-2.5">
          <p id="section-5-2.5.1">The "encrypted_key" <span class="bcp14">MUST</span> be the base64url encoded encapsulated key as defined in Section 5.1.1 of <span>[<a href="#RFC9180" class="cite xref">RFC9180</a>]</span>.<a href="#section-5-2.5.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-5-2.6">
          <p id="section-5-2.6.1">The "iv", "tag" and "aad" members <span class="bcp14">MUST NOT</span> be present.<a href="#section-5-2.6.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-5-2.7">
          <p id="section-5-2.7.1">The "ciphertext" <span class="bcp14">MUST</span> be the base64url encoded ciphertext as defined in Section 5.2 of <span>[<a href="#RFC9180" class="cite xref">RFC9180</a>]</span>.<a href="#section-5-2.7.1" class="pilcrow">¶</a></p>
</li>
      </ul>
</section>
</div>
<div id="key-encryption">
<section id="section-6">
      <h2 id="name-key-encryption">
<a href="#section-6" class="section-number selfRef">6. </a><a href="#name-key-encryption" class="section-name selfRef">Key Encryption</a>
      </h2>
<p id="section-6-1">HPKE based recipients can be added alongside existing <code>ECDH-ES+A128KW</code> or <code>RSA-OAEP-384</code> recipients because HPKE is only used to encrypt the content encryption key, and because the protected header used in content encryption is passed to HPKE as Additional Authenticated Data.<a href="#section-6-1" class="pilcrow">¶</a></p>
<p id="section-6-2">In HPKE JWE Key Encryption:<a href="#section-6-2" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-6-3.1">
          <p id="section-6-3.1.1">The protected header <span class="bcp14">MUST NOT</span> contain an "alg".<a href="#section-6-3.1.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-6-3.2">
          <p id="section-6-3.2.1">The protected header <span class="bcp14">MUST</span> contain an "enc" that is registered in both the IANA HPKE AEAD Identifiers Registry, and the IANA JSON Web Signature and Encryption Algorithms Registry.<a href="#section-6-3.2.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-6-3.3">
          <p id="section-6-3.3.1">The recipient unprotected header parameters "psk_id" and "auth_kid" <span class="bcp14">MAY</span> be present.<a href="#section-6-3.3.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-6-3.4">
          <p id="section-6-3.4.1">The recipient unprotected header parameter "ek" <span class="bcp14">MUST</span> be present.<a href="#section-6-3.4.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-6-3.5">
          <p id="section-6-3.5.1">The recipient unprotected header parameter <span class="bcp14">MAY</span> contain "alg" and "enc" values.<a href="#section-6-3.5.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-6-3.6">
          <p id="section-6-3.6.1">The "encrypted_key" <span class="bcp14">MUST</span> be the base64url encoded content encryption key as described in Step 15 in { Section 5.1 of RFC7516 }.<a href="#section-6-3.6.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-6-3.7">
          <p id="section-6-3.7.1">The recipient "encrypted_key" is as described in { Section 7.2.1 of RFC7516 } .<a href="#section-6-3.7.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-6-3.8">
          <p id="section-6-3.8.1">The "iv", "tag" JWE members <span class="bcp14">MUST</span> be present.<a href="#section-6-3.8.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-6-3.9">
          <p id="section-6-3.9.1">The "aad" JWE member <span class="bcp14">MAY</span> be present.<a href="#section-6-3.9.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-6-3.10">
          <p id="section-6-3.10.1">The "ciphertext" <span class="bcp14">MUST</span> be the base64url encoded ciphertext as described in Step 19 in { Section 5.1 of RFC7516 }.<a href="#section-6-3.10.1" class="pilcrow">¶</a></p>
</li>
      </ul>
</section>
</div>
<div id="security-considerations">
<section id="section-7">
      <h2 id="name-security-considerations">
<a href="#section-7" class="section-number selfRef">7. </a><a href="#name-security-considerations" class="section-name selfRef">Security Considerations</a>
      </h2>
<p id="section-7-1">This specification is based on HPKE and the security considerations of
<span>[<a href="#RFC9180" class="cite xref">RFC9180</a>]</span> are therefore applicable also to this specification.<a href="#section-7-1" class="pilcrow">¶</a></p>
<p id="section-7-2">HPKE assumes the sender is in possession of the public key of the recipient and
HPKE JOSE makes the same assumptions. Hence, some form of public key distribution
mechanism is assumed to exist but outside the scope of this document.<a href="#section-7-2" class="pilcrow">¶</a></p>
<p id="section-7-3">HPKE in Base mode does not offer authentication as part of the HPKE KEM.
In this case JOSE constructs like JWS and JSON Web Tokens (JWTs) can be used to add authentication.
HPKE also offers modes that offer authentication.<a href="#section-7-3" class="pilcrow">¶</a></p>
<p id="section-7-4">HPKE relies on a source of randomness to be available on the device.
In Key Agreement with Key Wrapping mode, CEK has to be randomly generated and it <span class="bcp14">MUST</span> be ensured that the guidelines in <span>[<a href="#RFC8937" class="cite xref">RFC8937</a>]</span> for random number generations are followed.<a href="#section-7-4" class="pilcrow">¶</a></p>
<div id="plaintext-compression">
<section id="section-7.1">
        <h3 id="name-plaintext-compression">
<a href="#section-7.1" class="section-number selfRef">7.1. </a><a href="#name-plaintext-compression" class="section-name selfRef">Plaintext Compression</a>
        </h3>
<p id="section-7.1-1">Implementers are advised to review Section 3.6 of <span>[<a href="#RFC8725" class="cite xref">RFC8725</a>]</span>, which states:
Compression of data <span class="bcp14">SHOULD NOT</span> be done before encryption, because such compressed data often reveals information about the plaintext.<a href="#section-7.1-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="header-parameters">
<section id="section-7.2">
        <h3 id="name-header-parameters">
<a href="#section-7.2" class="section-number selfRef">7.2. </a><a href="#name-header-parameters" class="section-name selfRef">Header Parameters</a>
        </h3>
<p id="section-7.2-1">Implementers are advised to review Section 3.10 of <span>[<a href="#RFC8725" class="cite xref">RFC8725</a>]</span>, which comments on application processing of JWE Protected Headers.
Additionally, Unprotected Headers can contain similar information which an attacker could leverage to mount denial of service, forgery or injection attacks.<a href="#section-7.2-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="ensure-cryptographic-keys-have-sufficient-entropy">
<section id="section-7.3">
        <h3 id="name-ensure-cryptographic-keys-h">
<a href="#section-7.3" class="section-number selfRef">7.3. </a><a href="#name-ensure-cryptographic-keys-h" class="section-name selfRef">Ensure Cryptographic Keys Have Sufficient Entropy</a>
        </h3>
<p id="section-7.3-1">Implementers are advised to review Section 3.5 of <span>[<a href="#RFC8725" class="cite xref">RFC8725</a>]</span>, which provides comments on entropy requirements for keys.
This guidance is relevant to both public and private keys used in both Key Encryption and Integrated Encryption.
Additionally, this guidance is applicable to content encryption keys used in Key Encryption mode.<a href="#section-7.3-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="validate-cryptographic-inputs">
<section id="section-7.4">
        <h3 id="name-validate-cryptographic-inpu">
<a href="#section-7.4" class="section-number selfRef">7.4. </a><a href="#name-validate-cryptographic-inpu" class="section-name selfRef">Validate Cryptographic Inputs</a>
        </h3>
<p id="section-7.4-1">Implementers are advised to review Section 3.4 of <span>[<a href="#RFC8725" class="cite xref">RFC8725</a>]</span>, which provides comments on the validation of cryptographic inputs.
This guidance is relevant to both public and private keys used in both Key Encryption and Integrated Encryption, specifically focusing on the structure of the public and private keys.
These inputs are crucial for the HPKE KEM operations.<a href="#section-7.4-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="use-appropriate-algorithms">
<section id="section-7.5">
        <h3 id="name-use-appropriate-algorithms">
<a href="#section-7.5" class="section-number selfRef">7.5. </a><a href="#name-use-appropriate-algorithms" class="section-name selfRef">Use Appropriate Algorithms</a>
        </h3>
<p id="section-7.5-1">Implementers are advised to review Section 3.2 of <span>[<a href="#RFC8725" class="cite xref">RFC8725</a>]</span>, which comments on the selection of appropriate algorithms.
This is guidance is relevant to both Key Encryption and Integrated Encryption.
When using Key Encryption, the strength of the content encryption algorithm should not be significantly different from the strengh of the Key Encryption algorithms used.<a href="#section-7.5-1" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="IANA">
<section id="section-8">
      <h2 id="name-iana-considerations">
<a href="#section-8" class="section-number selfRef">8. </a><a href="#name-iana-considerations" class="section-name selfRef">IANA Considerations</a>
      </h2>
<p id="section-8-1">This document adds entries to <span>[<a href="#JOSE-IANA" class="cite xref">JOSE-IANA</a>]</span>.<a href="#section-8-1" class="pilcrow">¶</a></p>
<div id="ciphersuite-registration">
<section id="section-8.1">
        <h3 id="name-ciphersuite-registration">
<a href="#section-8.1" class="section-number selfRef">8.1. </a><a href="#name-ciphersuite-registration" class="section-name selfRef">Ciphersuite Registration</a>
        </h3>
<p id="section-8.1-1">This specification registers a number of ciphersuites for use with HPKE.
A ciphersuite is a group of algorithms, often sharing component algorithms such as hash functions, targeting a security level.
An HPKE ciphersuite, is composed of the following choices:<a href="#section-8.1-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-8.1-2.1">
            <p id="section-8.1-2.1.1">HPKE Mode<a href="#section-8.1-2.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-8.1-2.2">
            <p id="section-8.1-2.2.1">KEM Algorithm<a href="#section-8.1-2.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-8.1-2.3">
            <p id="section-8.1-2.3.1">KDF Algorithm<a href="#section-8.1-2.3.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-8.1-2.4">
            <p id="section-8.1-2.4.1">AEAD Algorithm<a href="#section-8.1-2.4.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="section-8.1-3">The "KEM", "KDF", and "AEAD" values are chosen from the HPKE IANA registry <span>[<a href="#HPKE-IANA" class="cite xref">HPKE-IANA</a>]</span>.<a href="#section-8.1-3" class="pilcrow">¶</a></p>
<p id="section-8.1-4">For readability the algorithm ciphersuites labels are built according to the following scheme:<a href="#section-8.1-4" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-8.1-5">
<pre>
HPKE-&lt;KEM&gt;-&lt;KDF&gt;-&lt;AEAD&gt;
</pre><a href="#section-8.1-5" class="pilcrow">¶</a>
</div>
<p id="section-8.1-6">The "HPKE Mode" is described in Table 1 of <span>[<a href="#RFC9180" class="cite xref">RFC9180</a>]</span>:<a href="#section-8.1-6" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-8.1-7.1">
            <p id="section-8.1-7.1.1">"Base" refers to "mode_base" described in Section 5.1.1 of <span>[<a href="#RFC9180" class="cite xref">RFC9180</a>]</span>,
which only enables encryption to the holder of a given KEM private key.<a href="#section-8.1-7.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-8.1-7.2">
            <p id="section-8.1-7.2.1">"PSK" refers to "mode_psk", described in Section 5.1.2 of <span>[<a href="#RFC9180" class="cite xref">RFC9180</a>]</span>,
which authenticates using a pre-shared key.<a href="#section-8.1-7.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-8.1-7.3">
            <p id="section-8.1-7.3.1">"Auth" refers to "mode_auth", described in Section 5.1.3 of <span>[<a href="#RFC9180" class="cite xref">RFC9180</a>]</span>,
which authenticates using an asymmetric key.<a href="#section-8.1-7.3.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-8.1-7.4">
            <p id="section-8.1-7.4.1">"Auth_Psk" refers to "mode_auth_psk", described in Section 5.1.4 of <span>[<a href="#RFC9180" class="cite xref">RFC9180</a>]</span>,
which authenticates using both a PSK and an asymmetric key.<a href="#section-8.1-7.4.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="section-8.1-8">Implementations detect the use of modes by inspecting header parameters.<a href="#section-8.1-8" class="pilcrow">¶</a></p>
</section>
</div>
<div id="json-web-signature-and-encryption-algorithms">
<section id="section-8.2">
        <h3 id="name-json-web-signature-and-encr">
<a href="#section-8.2" class="section-number selfRef">8.2. </a><a href="#name-json-web-signature-and-encr" class="section-name selfRef">JSON Web Signature and Encryption Algorithms</a>
        </h3>
<p id="section-8.2-1">The following entries are added to the "JSON Web Signature and Encryption Algorithms" registry:<a href="#section-8.2-1" class="pilcrow">¶</a></p>
<div id="hpke-p256-sha256-a128gcm">
<section id="section-8.2.1">
          <h4 id="name-hpke-p256-sha256-a128gcm">
<a href="#section-8.2.1" class="section-number selfRef">8.2.1. </a><a href="#name-hpke-p256-sha256-a128gcm" class="section-name selfRef">HPKE-P256-SHA256-A128GCM</a>
          </h4>
<ul class="normal">
<li class="normal" id="section-8.2.1-1.1">
              <p id="section-8.2.1-1.1.1">Algorithm Name: HPKE-P256-SHA256-A128GCM<a href="#section-8.2.1-1.1.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-8.2.1-1.2">
              <p id="section-8.2.1-1.2.1">Algorithm Description: Cipher suite for JOSE-HPKE in Base Mode that uses the DHKEM(P-256, HKDF-SHA256) KEM, the HKDF-SHA256 KDF and the AES-128-GCM AEAD.<a href="#section-8.2.1-1.2.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-8.2.1-1.3">
              <p id="section-8.2.1-1.3.1">Algorithm Usage Location(s): "alg"<a href="#section-8.2.1-1.3.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-8.2.1-1.4">
              <p id="section-8.2.1-1.4.1">JOSE Implementation Requirements: Optional<a href="#section-8.2.1-1.4.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-8.2.1-1.5">
              <p id="section-8.2.1-1.5.1">Change Controller: IETF<a href="#section-8.2.1-1.5.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-8.2.1-1.6">
              <p id="section-8.2.1-1.6.1">Specification Document(s):   RFCXXXX<a href="#section-8.2.1-1.6.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-8.2.1-1.7">
              <p id="section-8.2.1-1.7.1">Algorithm Analysis Documents(s): TODO<a href="#section-8.2.1-1.7.1" class="pilcrow">¶</a></p>
</li>
          </ul>
</section>
</div>
<div id="hpke-p384-sha384-a256gcm">
<section id="section-8.2.2">
          <h4 id="name-hpke-p384-sha384-a256gcm">
<a href="#section-8.2.2" class="section-number selfRef">8.2.2. </a><a href="#name-hpke-p384-sha384-a256gcm" class="section-name selfRef">HPKE-P384-SHA384-A256GCM</a>
          </h4>
<ul class="normal">
<li class="normal" id="section-8.2.2-1.1">
              <p id="section-8.2.2-1.1.1">Algorithm Name: HPKE-P384-SHA384-A256GCM<a href="#section-8.2.2-1.1.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-8.2.2-1.2">
              <p id="section-8.2.2-1.2.1">Algorithm Description: Cipher suite for JOSE-HPKE in Base Mode that uses the DHKEM(P-384, HKDF-SHA384) KEM, the HKDF-SHA384 KDF, and the AES-256-GCM AEAD.<a href="#section-8.2.2-1.2.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-8.2.2-1.3">
              <p id="section-8.2.2-1.3.1">Algorithm Usage Location(s): "alg"<a href="#section-8.2.2-1.3.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-8.2.2-1.4">
              <p id="section-8.2.2-1.4.1">JOSE Implementation Requirements: Optional<a href="#section-8.2.2-1.4.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-8.2.2-1.5">
              <p id="section-8.2.2-1.5.1">Change Controller: IETF<a href="#section-8.2.2-1.5.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-8.2.2-1.6">
              <p id="section-8.2.2-1.6.1">Specification Document(s):   RFCXXXX<a href="#section-8.2.2-1.6.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-8.2.2-1.7">
              <p id="section-8.2.2-1.7.1">Algorithm Analysis Documents(s): TODO<a href="#section-8.2.2-1.7.1" class="pilcrow">¶</a></p>
</li>
          </ul>
</section>
</div>
<div id="hpke-p521-sha512-a256gcm">
<section id="section-8.2.3">
          <h4 id="name-hpke-p521-sha512-a256gcm">
<a href="#section-8.2.3" class="section-number selfRef">8.2.3. </a><a href="#name-hpke-p521-sha512-a256gcm" class="section-name selfRef">HPKE-P521-SHA512-A256GCM</a>
          </h4>
<ul class="normal">
<li class="normal" id="section-8.2.3-1.1">
              <p id="section-8.2.3-1.1.1">Algorithm Name: HPKE-P521-SHA512-A256GCM<a href="#section-8.2.3-1.1.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-8.2.3-1.2">
              <p id="section-8.2.3-1.2.1">Algorithm Description: Cipher suite for JOSE-HPKE in Base Mode that uses the DHKEM(P-521, HKDF-SHA512) KEM, the HKDF-SHA512 KDF, and the AES-256-GCM AEAD.<a href="#section-8.2.3-1.2.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-8.2.3-1.3">
              <p id="section-8.2.3-1.3.1">Algorithm Usage Location(s): "alg"<a href="#section-8.2.3-1.3.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-8.2.3-1.4">
              <p id="section-8.2.3-1.4.1">JOSE Implementation Requirements: Optional<a href="#section-8.2.3-1.4.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-8.2.3-1.5">
              <p id="section-8.2.3-1.5.1">Change Controller: IETF<a href="#section-8.2.3-1.5.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-8.2.3-1.6">
              <p id="section-8.2.3-1.6.1">Specification Document(s):   RFCXXXX<a href="#section-8.2.3-1.6.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-8.2.3-1.7">
              <p id="section-8.2.3-1.7.1">Algorithm Analysis Documents(s): TODO<a href="#section-8.2.3-1.7.1" class="pilcrow">¶</a></p>
</li>
          </ul>
</section>
</div>
<div id="hpke-x25519-sha256-a128gcm">
<section id="section-8.2.4">
          <h4 id="name-hpke-x25519-sha256-a128gcm">
<a href="#section-8.2.4" class="section-number selfRef">8.2.4. </a><a href="#name-hpke-x25519-sha256-a128gcm" class="section-name selfRef">HPKE-X25519-SHA256-A128GCM</a>
          </h4>
<ul class="normal">
<li class="normal" id="section-8.2.4-1.1">
              <p id="section-8.2.4-1.1.1">Algorithm Name: HPKE-X25519-SHA256-A128GCM<a href="#section-8.2.4-1.1.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-8.2.4-1.2">
              <p id="section-8.2.4-1.2.1">Algorithm Description: Cipher suite for JOSE-HPKE in Base Mode that uses the DHKEM(X25519, HKDF-SHA256) KEM, the HKDF-SHA256 KDF, and the AES-128-GCM AEAD.<a href="#section-8.2.4-1.2.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-8.2.4-1.3">
              <p id="section-8.2.4-1.3.1">Algorithm Usage Location(s): "alg"<a href="#section-8.2.4-1.3.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-8.2.4-1.4">
              <p id="section-8.2.4-1.4.1">JOSE Implementation Requirements: Optional<a href="#section-8.2.4-1.4.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-8.2.4-1.5">
              <p id="section-8.2.4-1.5.1">Change Controller: IETF<a href="#section-8.2.4-1.5.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-8.2.4-1.6">
              <p id="section-8.2.4-1.6.1">Specification Document(s):   RFCXXXX<a href="#section-8.2.4-1.6.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-8.2.4-1.7">
              <p id="section-8.2.4-1.7.1">Algorithm Analysis Documents(s): TODO<a href="#section-8.2.4-1.7.1" class="pilcrow">¶</a></p>
</li>
          </ul>
</section>
</div>
<div id="hpke-x25519-sha256-chacha20poly1305">
<section id="section-8.2.5">
          <h4 id="name-hpke-x25519-sha256-chacha20">
<a href="#section-8.2.5" class="section-number selfRef">8.2.5. </a><a href="#name-hpke-x25519-sha256-chacha20" class="section-name selfRef">HPKE-X25519-SHA256-ChaCha20Poly1305</a>
          </h4>
<ul class="normal">
<li class="normal" id="section-8.2.5-1.1">
              <p id="section-8.2.5-1.1.1">Algorithm Name: HPKE-X25519-SHA256-ChaCha20Poly1305<a href="#section-8.2.5-1.1.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-8.2.5-1.2">
              <p id="section-8.2.5-1.2.1">Algorithm Description: Cipher suite for JOSE-HPKE in Base Mode that uses the DHKEM(X25519, HKDF-SHA256) KEM, the HKDF-SHA256 KDF, and the ChaCha20Poly1305 AEAD.<a href="#section-8.2.5-1.2.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-8.2.5-1.3">
              <p id="section-8.2.5-1.3.1">Algorithm Usage Location(s): "alg, enc"<a href="#section-8.2.5-1.3.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-8.2.5-1.4">
              <p id="section-8.2.5-1.4.1">JOSE Implementation Requirements: Optional<a href="#section-8.2.5-1.4.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-8.2.5-1.5">
              <p id="section-8.2.5-1.5.1">Change Controller: IETF<a href="#section-8.2.5-1.5.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-8.2.5-1.6">
              <p id="section-8.2.5-1.6.1">Specification Document(s):   RFCXXXX<a href="#section-8.2.5-1.6.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-8.2.5-1.7">
              <p id="section-8.2.5-1.7.1">Algorithm Analysis Documents(s): TODO<a href="#section-8.2.5-1.7.1" class="pilcrow">¶</a></p>
</li>
          </ul>
</section>
</div>
<div id="hpke-x448-sha512-a256gcm">
<section id="section-8.2.6">
          <h4 id="name-hpke-x448-sha512-a256gcm">
<a href="#section-8.2.6" class="section-number selfRef">8.2.6. </a><a href="#name-hpke-x448-sha512-a256gcm" class="section-name selfRef">HPKE-X448-SHA512-A256GCM</a>
          </h4>
<ul class="normal">
<li class="normal" id="section-8.2.6-1.1">
              <p id="section-8.2.6-1.1.1">Algorithm Name: HPKE-X448-SHA512-A256GCM<a href="#section-8.2.6-1.1.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-8.2.6-1.2">
              <p id="section-8.2.6-1.2.1">Algorithm Description: Cipher suite for JOSE-HPKE in Base Mode that uses the DHKEM(X448, HKDF-SHA512) KEM, the HKDF-SHA512 KDF, and the AES-256-GCM AEAD.<a href="#section-8.2.6-1.2.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-8.2.6-1.3">
              <p id="section-8.2.6-1.3.1">Algorithm Usage Location(s): "alg"<a href="#section-8.2.6-1.3.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-8.2.6-1.4">
              <p id="section-8.2.6-1.4.1">JOSE Implementation Requirements: Optional<a href="#section-8.2.6-1.4.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-8.2.6-1.5">
              <p id="section-8.2.6-1.5.1">Change Controller: IETF<a href="#section-8.2.6-1.5.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-8.2.6-1.6">
              <p id="section-8.2.6-1.6.1">Specification Document(s):   RFCXXXX<a href="#section-8.2.6-1.6.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-8.2.6-1.7">
              <p id="section-8.2.6-1.7.1">Algorithm Analysis Documents(s): TODO<a href="#section-8.2.6-1.7.1" class="pilcrow">¶</a></p>
</li>
          </ul>
</section>
</div>
<div id="hpke-x448-sha512-chacha20poly1305">
<section id="section-8.2.7">
          <h4 id="name-hpke-x448-sha512-chacha20po">
<a href="#section-8.2.7" class="section-number selfRef">8.2.7. </a><a href="#name-hpke-x448-sha512-chacha20po" class="section-name selfRef">HPKE-X448-SHA512-ChaCha20Poly1305</a>
          </h4>
<ul class="normal">
<li class="normal" id="section-8.2.7-1.1">
              <p id="section-8.2.7-1.1.1">Algorithm Name: HPKE-X448-SHA512-ChaCha20Poly1305<a href="#section-8.2.7-1.1.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-8.2.7-1.2">
              <p id="section-8.2.7-1.2.1">Algorithm Description: Cipher suite for JOSE-HPKE in Base Mode that uses the DHKEM(X448, HKDF-SHA512) KEM, the HKDF-SHA512 KDF, and the ChaCha20Poly1305 AEAD.<a href="#section-8.2.7-1.2.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-8.2.7-1.3">
              <p id="section-8.2.7-1.3.1">Algorithm Usage Location(s): "alg"<a href="#section-8.2.7-1.3.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-8.2.7-1.4">
              <p id="section-8.2.7-1.4.1">JOSE Implementation Requirements: Optional<a href="#section-8.2.7-1.4.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-8.2.7-1.5">
              <p id="section-8.2.7-1.5.1">Change Controller: IETF<a href="#section-8.2.7-1.5.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-8.2.7-1.6">
              <p id="section-8.2.7-1.6.1">Specification Document(s):   RFCXXXX<a href="#section-8.2.7-1.6.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-8.2.7-1.7">
              <p id="section-8.2.7-1.7.1">Algorithm Analysis Documents(s): TODO<a href="#section-8.2.7-1.7.1" class="pilcrow">¶</a></p>
</li>
          </ul>
</section>
</div>
</section>
</div>
<div id="json-web-signature-and-encryption-header-parameters">
<section id="section-8.3">
        <h3 id="name-json-web-signature-and-encry">
<a href="#section-8.3" class="section-number selfRef">8.3. </a><a href="#name-json-web-signature-and-encry" class="section-name selfRef">JSON Web Signature and Encryption Header Parameters</a>
        </h3>
<p id="section-8.3-1">The following entries are added to the "JSON Web Key Parameters" registry:<a href="#section-8.3-1" class="pilcrow">¶</a></p>
<div id="ek">
<section id="section-8.3.1">
          <h4 id="name-ek">
<a href="#section-8.3.1" class="section-number selfRef">8.3.1. </a><a href="#name-ek" class="section-name selfRef">ek</a>
          </h4>
<ul class="normal">
<li class="normal" id="section-8.3.1-1.1">
              <p id="section-8.3.1-1.1.1">Header Parameter Name: "ek"<a href="#section-8.3.1-1.1.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-8.3.1-1.2">
              <p id="section-8.3.1-1.2.1">Header Parameter Description: An encapsulated key as defined in { Section 5.1.1 of RFC9180 }<a href="#section-8.3.1-1.2.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-8.3.1-1.3">
              <p id="section-8.3.1-1.3.1">Header Parameter Usage Location(s): JWE<a href="#section-8.3.1-1.3.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-8.3.1-1.4">
              <p id="section-8.3.1-1.4.1">Change Controller: IETF<a href="#section-8.3.1-1.4.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-8.3.1-1.5">
              <p id="section-8.3.1-1.5.1">Specification Document(s):   RFCXXXX<a href="#section-8.3.1-1.5.1" class="pilcrow">¶</a></p>
</li>
          </ul>
</section>
</div>
<div id="pskid">
<section id="section-8.3.2">
          <h4 id="name-psk_id">
<a href="#section-8.3.2" class="section-number selfRef">8.3.2. </a><a href="#name-psk_id" class="section-name selfRef">psk_id</a>
          </h4>
<ul class="normal">
<li class="normal" id="section-8.3.2-1.1">
              <p id="section-8.3.2-1.1.1">Header Parameter Name: "psk_id"<a href="#section-8.3.2-1.1.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-8.3.2-1.2">
              <p id="section-8.3.2-1.2.1">Header Parameter Description: A key identifier (kid) for the pre-shared key as defined in { Section 5.1.2 of RFC9180 }<a href="#section-8.3.2-1.2.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-8.3.2-1.3">
              <p id="section-8.3.2-1.3.1">Header Parameter Usage Location(s): JWE<a href="#section-8.3.2-1.3.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-8.3.2-1.4">
              <p id="section-8.3.2-1.4.1">Change Controller: IETF<a href="#section-8.3.2-1.4.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-8.3.2-1.5">
              <p id="section-8.3.2-1.5.1">Specification Document(s):   RFCXXXX<a href="#section-8.3.2-1.5.1" class="pilcrow">¶</a></p>
</li>
          </ul>
</section>
</div>
<div id="authkid">
<section id="section-8.3.3">
          <h4 id="name-auth_kid">
<a href="#section-8.3.3" class="section-number selfRef">8.3.3. </a><a href="#name-auth_kid" class="section-name selfRef">auth_kid</a>
          </h4>
<ul class="normal">
<li class="normal" id="section-8.3.3-1.1">
              <p id="section-8.3.3-1.1.1">Header Parameter Name: "auth_kid"<a href="#section-8.3.3-1.1.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-8.3.3-1.2">
              <p id="section-8.3.3-1.2.1">Header Parameter Description: A key identifier (kid) for the asymmetric key as defined in { Section 5.1.3 of RFC9180 }<a href="#section-8.3.3-1.2.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-8.3.3-1.3">
              <p id="section-8.3.3-1.3.1">Header Parameter Usage Location(s): JWE<a href="#section-8.3.3-1.3.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-8.3.3-1.4">
              <p id="section-8.3.3-1.4.1">Change Controller: IETF<a href="#section-8.3.3-1.4.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-8.3.3-1.5">
              <p id="section-8.3.3-1.5.1">Specification Document(s):   RFCXXXX<a href="#section-8.3.3-1.5.1" class="pilcrow">¶</a></p>
</li>
          </ul>
</section>
</div>
</section>
</div>
</section>
</div>
<div id="sec-combined-references">
<section id="section-9">
      <h2 id="name-references">
<a href="#section-9" class="section-number selfRef">9. </a><a href="#name-references" class="section-name selfRef">References</a>
      </h2>
<div id="sec-normative-references">
<section id="section-9.1">
        <h3 id="name-normative-references">
<a href="#section-9.1" class="section-number selfRef">9.1. </a><a href="#name-normative-references" class="section-name selfRef">Normative References</a>
        </h3>
<dl class="references">
<dt id="JOSE-IANA">[JOSE-IANA]</dt>
        <dd>
<span class="refAuthor">IANA</span>, <span class="refTitle">"JSON Web Signature and Encryption Algorithms"</span>, <span>n.d.</span>, <span>&lt;<a href="https://www.iana.org/assignments/jose/jose.xhtml">https://www.iana.org/assignments/jose/jose.xhtml</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC2119">[RFC2119]</dt>
        <dd>
<span class="refAuthor">Bradner, S.</span>, <span class="refTitle">"Key words for use in RFCs to Indicate Requirement Levels"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 2119</span>, <span class="seriesInfo">DOI 10.17487/RFC2119</span>, <time datetime="1997-03" class="refDate">March 1997</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc2119">https://www.rfc-editor.org/rfc/rfc2119</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7516">[RFC7516]</dt>
        <dd>
<span class="refAuthor">Jones, M.</span> and <span class="refAuthor">J. Hildebrand</span>, <span class="refTitle">"JSON Web Encryption (JWE)"</span>, <span class="seriesInfo">RFC 7516</span>, <span class="seriesInfo">DOI 10.17487/RFC7516</span>, <time datetime="2015-05" class="refDate">May 2015</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc7516">https://www.rfc-editor.org/rfc/rfc7516</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7517">[RFC7517]</dt>
        <dd>
<span class="refAuthor">Jones, M.</span>, <span class="refTitle">"JSON Web Key (JWK)"</span>, <span class="seriesInfo">RFC 7517</span>, <span class="seriesInfo">DOI 10.17487/RFC7517</span>, <time datetime="2015-05" class="refDate">May 2015</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc7517">https://www.rfc-editor.org/rfc/rfc7517</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7518">[RFC7518]</dt>
        <dd>
<span class="refAuthor">Jones, M.</span>, <span class="refTitle">"JSON Web Algorithms (JWA)"</span>, <span class="seriesInfo">RFC 7518</span>, <span class="seriesInfo">DOI 10.17487/RFC7518</span>, <time datetime="2015-05" class="refDate">May 2015</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc7518">https://www.rfc-editor.org/rfc/rfc7518</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8174">[RFC8174]</dt>
        <dd>
<span class="refAuthor">Leiba, B.</span>, <span class="refTitle">"Ambiguity of Uppercase vs Lowercase in RFC 2119 Key Words"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 8174</span>, <span class="seriesInfo">DOI 10.17487/RFC8174</span>, <time datetime="2017-05" class="refDate">May 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc8174">https://www.rfc-editor.org/rfc/rfc8174</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8725">[RFC8725]</dt>
        <dd>
<span class="refAuthor">Sheffer, Y.</span>, <span class="refAuthor">Hardt, D.</span>, and <span class="refAuthor">M. Jones</span>, <span class="refTitle">"JSON Web Token Best Current Practices"</span>, <span class="seriesInfo">BCP 225</span>, <span class="seriesInfo">RFC 8725</span>, <span class="seriesInfo">DOI 10.17487/RFC8725</span>, <time datetime="2020-02" class="refDate">February 2020</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc8725">https://www.rfc-editor.org/rfc/rfc8725</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC9180">[RFC9180]</dt>
      <dd>
<span class="refAuthor">Barnes, R.</span>, <span class="refAuthor">Bhargavan, K.</span>, <span class="refAuthor">Lipp, B.</span>, and <span class="refAuthor">C. Wood</span>, <span class="refTitle">"Hybrid Public Key Encryption"</span>, <span class="seriesInfo">RFC 9180</span>, <span class="seriesInfo">DOI 10.17487/RFC9180</span>, <time datetime="2022-02" class="refDate">February 2022</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc9180">https://www.rfc-editor.org/rfc/rfc9180</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
</div>
<div id="sec-informative-references">
<section id="section-9.2">
        <h3 id="name-informative-references">
<a href="#section-9.2" class="section-number selfRef">9.2. </a><a href="#name-informative-references" class="section-name selfRef">Informative References</a>
        </h3>
<dl class="references">
<dt id="HPKE-IANA">[HPKE-IANA]</dt>
        <dd>
<span class="refAuthor">IANA</span>, <span class="refTitle">"Hybrid Public Key Encryption (HPKE) IANA Registry"</span>, <time datetime="2023-10" class="refDate">October 2023</time>, <span>&lt;<a href="https://www.iana.org/assignments/hpke/hpke.xhtml">https://www.iana.org/assignments/hpke/hpke.xhtml</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="I-D.ietf-cose-hpke">[I-D.ietf-cose-hpke]</dt>
        <dd>
<span class="refAuthor">Tschofenig, H.</span>, <span class="refAuthor">Steele, O.</span>, <span class="refAuthor">Daisuke, A.</span>, and <span class="refAuthor">L. Lundblade</span>, <span class="refTitle">"Use of Hybrid Public-Key Encryption (HPKE) with CBOR Object Signing and Encryption (COSE)"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-ietf-cose-hpke-09</span>, <time datetime="2024-07-12" class="refDate">12 July 2024</time>, <span>&lt;<a href="https://datatracker.ietf.org/doc/html/draft-ietf-cose-hpke-09">https://datatracker.ietf.org/doc/html/draft-ietf-cose-hpke-09</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8937">[RFC8937]</dt>
      <dd>
<span class="refAuthor">Cremers, C.</span>, <span class="refAuthor">Garratt, L.</span>, <span class="refAuthor">Smyshlyaev, S.</span>, <span class="refAuthor">Sullivan, N.</span>, and <span class="refAuthor">C. Wood</span>, <span class="refTitle">"Randomness Improvements for Security Protocols"</span>, <span class="seriesInfo">RFC 8937</span>, <span class="seriesInfo">DOI 10.17487/RFC8937</span>, <time datetime="2020-10" class="refDate">October 2020</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc8937">https://www.rfc-editor.org/rfc/rfc8937</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
</div>
</section>
</div>
<div id="examples">
<section id="appendix-A">
      <h2 id="name-examples">
<a href="#appendix-A" class="section-number selfRef">Appendix A. </a><a href="#name-examples" class="section-name selfRef">Examples</a>
      </h2>
<p id="appendix-A-1">The following examples contain newlines for readability.<a href="#appendix-A-1" class="pilcrow">¶</a></p>
<p id="appendix-A-2">This private key and it implied public key are used in the following examples:<a href="#appendix-A-2" class="pilcrow">¶</a></p>
<div class="lang-text sourcecode" id="appendix-A-3">
<pre>
{
  "kid": "S6AXfdU_6Yfzvu0KDDJb0sFuwnIWPk6LMTErYhPb32s",
  "alg": "HPKE-P256-SHA256-A128GCM",
  "kty": "EC",
  "crv": "P-256",
  "x": "wt36K06T4T4APWfGtioqDBXCvRN9evqkZjNydib9MaM",
  "y": "eupgedeE_HAmVJ62kpSt2_EOoXb6e0y2YF1JPlfr1-I",
  "d": "O3KznUTAxw-ov-9ZokwNaJ289RgP9VxQc7GJthaXzWY"
}
</pre><a href="#appendix-A-3" class="pilcrow">¶</a>
</div>
<p id="appendix-A-4">This pre shared key is used in the following examples:<a href="#appendix-A-4" class="pilcrow">¶</a></p>
<div class="lang-text sourcecode" id="appendix-A-5">
<pre>
{
  "kty": "oct",
  "kid": "our-pre-shared-key-id",
  "k": "anVnZW11anVnZW11Z29rb3Vub3N1cmlraXJla2FpamE"
}
</pre><a href="#appendix-A-5" class="pilcrow">¶</a>
</div>
<div id="integrated-encryption-1">
<section id="appendix-A.1">
        <h3 id="name-integrated-encryption-2">
<a href="#appendix-A.1" class="section-number selfRef">A.1. </a><a href="#name-integrated-encryption-2" class="section-name selfRef">Integrated Encryption</a>
        </h3>
<div id="example-0">
<section id="appendix-A.1.1">
          <h4 id="name-example-0">
<a href="#appendix-A.1.1" class="section-number selfRef">A.1.1. </a><a href="#name-example-0" class="section-name selfRef">Example 0</a>
          </h4>
<p id="appendix-A.1.1-1">This example demonstrates the use of Integrated Encryption with Auth Mode and a Pre shared key.<a href="#appendix-A.1.1-1" class="pilcrow">¶</a></p>
<p id="appendix-A.1.1-2">The compact serialization is:<a href="#appendix-A.1.1-2" class="pilcrow">¶</a></p>
<div class="lang-text sourcecode" id="appendix-A.1.1-3">
<pre>
eyJhbGciOiJIUEtFLVAyNTYtU0hBMjU2LUExMjhHQ00iLCJlbmMiOiJBMTI4R0NNIiwi
a2lkIjoidXJuOmlldGY6cGFyYW1zOm9hdXRoOmp3ay10aHVtYnByaW50OnNoYS0yNTY6
UzZBWGZkVV82WWZ6dnUwS0RESmIwc0Z1d25JV1BrNkxNVEVyWWhQYjMycyIsInBza19p
ZCI6Im91ci1wcmUtc2hhcmVkLWtleS1pZCIsImF1dGhfa2lkIjoidXJuOmlldGY6cGFy
YW1zOm9hdXRoOmp3ay10aHVtYnByaW50OnNoYS0yNTY6UzZBWGZkVV82WWZ6dnUwS0RE
SmIwc0Z1d25JV1BrNkxNVEVyWWhQYjMycyJ9.BL_K7-o0jtNcCtYfoFhgh42jPxrz4aW
1jvjeSyHnAXKsomGQ1VCvwjSduwaWJ1Ewrrh3G1vf94xJ_Bb9YwYE9JU..Fl0HsSaXA-
ICfSz97iRRW6qApb5MFQct9llEPvkL0gEim9GmrDm8REJcquETwdTTaGitDZ_IbnwTwk
57ic1nfyRjWTFzEZLs_IAqZphP2J6KcqKHHBJJraeTkN9r1kNrDP6yg4xqcceCVmcn_f
dd2Oudij-FlU2IXsQKRyo2B2H9Q2si.
</pre><a href="#appendix-A.1.1-3" class="pilcrow">¶</a>
</div>
<p id="appendix-A.1.1-4">The json serialization is:<a href="#appendix-A.1.1-4" class="pilcrow">¶</a></p>
<div class="lang-text sourcecode" id="appendix-A.1.1-5">
<pre>
{
  "protected":"eyJhbGciOiJIUEtFLVAyNTYtU0hBMjU2LUExMjhHQ00iLCJlbmMiO
  iJBMTI4R0NNIiwia2lkIjoidXJuOmlldGY6cGFyYW1zOm9hdXRoOmp3ay10aHVtYnB
  yaW50OnNoYS0yNTY6UzZBWGZkVV82WWZ6dnUwS0RESmIwc0Z1d25JV1BrNkxNVEVyW
  WhQYjMycyIsInBza19pZCI6Im91ci1wcmUtc2hhcmVkLWtleS1pZCIsImF1dGhfa2l
  kIjoidXJuOmlldGY6cGFyYW1zOm9hdXRoOmp3ay10aHVtYnByaW50OnNoYS0yNTY6U
  zZBWGZkVV82WWZ6dnUwS0RESmIwc0Z1d25JV1BrNkxNVEVyWWhQYjMycyJ9",

  "encrypted_key":"BL_K7-o0jtNcCtYfoFhgh42jPxrz4aW1jvjeSyHnAXKsomGQ1
  VCvwjSduwaWJ1Ewrrh3G1vf94xJ_Bb9YwYE9JU",

  "ciphertext":"Fl0HsSaXA-ICfSz97iRRW6qApb5MFQct9llEPvkL0gEim9GmrDm8
  REJcquETwdTTaGitDZ_IbnwTwk57ic1nfyRjWTFzEZLs_IAqZphP2J6KcqKHHBJJra
  eTkN9r1kNrDP6yg4xqcceCVmcn_fdd2Oudij-FlU2IXsQKRyo2B2H9Q2si"
}
</pre><a href="#appendix-A.1.1-5" class="pilcrow">¶</a>
</div>
<p id="appendix-A.1.1-6">The decoded protected header is:<a href="#appendix-A.1.1-6" class="pilcrow">¶</a></p>
<div class="lang-text sourcecode" id="appendix-A.1.1-7">
<pre>
{
  "alg": "HPKE-P256-SHA256-A128GCM",
  "enc": "A128GCM",
  "kid": "urn:ietf:params:oauth:jwk-thumbprint:sha-256:S6AXfdU_6Yfzv
  u0KDDJb0sFuwnIWPk6LMTErYhPb32s",
  "psk_id": "our-pre-shared-key-id",
  "auth_kid": "urn:ietf:params:oauth:jwk-thumbprint:sha-256:S6AXfdU_
  6Yfzvu0KDDJb0sFuwnIWPk6LMTErYhPb32s"
}
</pre><a href="#appendix-A.1.1-7" class="pilcrow">¶</a>
</div>
<p id="appendix-A.1.1-8">The decrypted plaintext is:<a href="#appendix-A.1.1-8" class="pilcrow">¶</a></p>
<div class="lang-text sourcecode" id="appendix-A.1.1-9">
<pre>
{
  "urn:example:claim":true,
  "iss":"urn:example:issuer",
  "aud":"urn:example:audience",
  "iat":1720387513,
  "exp":1720394713
}
</pre><a href="#appendix-A.1.1-9" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="example-1">
<section id="appendix-A.1.2">
          <h4 id="name-example-1">
<a href="#appendix-A.1.2" class="section-number selfRef">A.1.2. </a><a href="#name-example-1" class="section-name selfRef">Example 1</a>
          </h4>
<p id="appendix-A.1.2-1">This example demonstrates the use of Integrated Encryption with Auth Mode and a Pre shared key as well as JWE Additional Authenticated Data.<a href="#appendix-A.1.2-1" class="pilcrow">¶</a></p>
<p id="appendix-A.1.2-2">There is way to express a JWE with aad in Compact JWE Serialization.<a href="#appendix-A.1.2-2" class="pilcrow">¶</a></p>
<div class="lang-text sourcecode" id="appendix-A.1.2-3">
<pre>
{
  "protected":"eyJhbGciOiJIUEtFLVAyNTYtU0hBMjU2LUExMjhHQ00iLCJlbmMiO
  iJBMTI4R0NNIiwia2lkIjoidXJuOmlldGY6cGFyYW1zOm9hdXRoOmp3ay10aHVtYnB
  yaW50OnNoYS0yNTY6UzZBWGZkVV82WWZ6dnUwS0RESmIwc0Z1d25JV1BrNkxNVEVyW
  WhQYjMycyIsInBza19pZCI6Im91ci1wcmUtc2hhcmVkLWtleS1pZCIsImF1dGhfa2l
  kIjoidXJuOmlldGY6cGFyYW1zOm9hdXRoOmp3ay10aHVtYnByaW50OnNoYS0yNTY6U
  zZBWGZkVV82WWZ6dnUwS0RESmIwc0Z1d25JV1BrNkxNVEVyWWhQYjMycyJ9",

  "encrypted_key":"BPlPRS-eX1m6zcxNScg4f_W6-eZTvu9n0F-wUcTuJZNsnf7Z1
  wasEW_g4sdbhFiDxBdd1_gCtyXpAatukbunN_I",

  "ciphertext":"RM7Bhz3WHSTeVYDlzLuYMhvECfKXhFIJPgMb1gUGMMkyUZeR",

  "aad":"8J-PtOKAjeKYoO-4jyBiZXdhcmUgdGhlIGFhZCE"
}
</pre><a href="#appendix-A.1.2-3" class="pilcrow">¶</a>
</div>
<p id="appendix-A.1.2-4">The decoded protected header is:<a href="#appendix-A.1.2-4" class="pilcrow">¶</a></p>
<div class="lang-text sourcecode" id="appendix-A.1.2-5">
<pre>
{
  "alg": "HPKE-P256-SHA256-A128GCM",
  "enc": "A128GCM",
  "kid": "urn:ietf:params:oauth:jwk-thumbprint:sha-256:S6AXfdU_6Yfzv
  u0KDDJb0sFuwnIWPk6LMTErYhPb32s",
  "psk_id": "our-pre-shared-key-id",
  "auth_kid": "urn:ietf:params:oauth:jwk-thumbprint:sha-256:S6AXfdU_
  6Yfzvu0KDDJb0sFuwnIWPk6LMTErYhPb32s"
}
</pre><a href="#appendix-A.1.2-5" class="pilcrow">¶</a>
</div>
<p id="appendix-A.1.2-6">The decrypted plaintext is:<a href="#appendix-A.1.2-6" class="pilcrow">¶</a></p>
<div class="lang-text sourcecode" id="appendix-A.1.2-7">
<pre>
🖤 this plaintext!
</pre><a href="#appendix-A.1.2-7" class="pilcrow">¶</a>
</div>
<p id="appendix-A.1.2-8">The decoded aad is:<a href="#appendix-A.1.2-8" class="pilcrow">¶</a></p>
<div class="lang-text sourcecode" id="appendix-A.1.2-9">
<pre>
🏴‍☠️ beware the aad!
</pre><a href="#appendix-A.1.2-9" class="pilcrow">¶</a>
</div>
</section>
</div>
</section>
</div>
<div id="key-encryption-1">
<section id="appendix-A.2">
        <h3 id="name-key-encryption-2">
<a href="#appendix-A.2" class="section-number selfRef">A.2. </a><a href="#name-key-encryption-2" class="section-name selfRef">Key Encryption</a>
        </h3>
<div id="example-2">
<section id="appendix-A.2.1">
          <h4 id="name-example-2">
<a href="#appendix-A.2.1" class="section-number selfRef">A.2.1. </a><a href="#name-example-2" class="section-name selfRef">Example 2</a>
          </h4>
<p id="appendix-A.2.1-1">This example demonstrates the use of Key Encryption with Auth Mode and a Pre shared key, in both Compact JWE Serialization and General JWE JSON Serialization.<a href="#appendix-A.2.1-1" class="pilcrow">¶</a></p>
<div class="lang-text sourcecode" id="appendix-A.2.1-2">
<pre>
 eyJlbmMiOiJBMTI4R0NNIn0.S_y3YPaLfjiwGz5o65BHciu14AZv-0J4Kzgtp2s7p7Q
 .EfX5ELXllga3S6Xx.up_VjB87-VSXd7d5ycPmhK9RtHx6vxOQJNjHjcqdrNKAWJcqb
 QEFzypSRhtSn9GmmlRQKl2j0DxUbT9q9mVZ.PutkemRFtDPkog7lh3aqbw
</pre><a href="#appendix-A.2.1-2" class="pilcrow">¶</a>
</div>
<p id="appendix-A.2.1-3">Note that the recipient structure is destroyed when converting to compact serialization, and that "ek" moves to "encrypted_key".<a href="#appendix-A.2.1-3" class="pilcrow">¶</a></p>
<div class="lang-text sourcecode" id="appendix-A.2.1-4">
<pre>
{
  "protected": "eyJlbmMiOiJBMTI4R0NNIn0",
  "iv": "EfX5ELXllga3S6Xx",
  "ciphertext": "up_VjB87-VSXd7d5ycPmhK9RtHx6vxOQJNjHjcqdrNKAWJcqbQE
  FzypSRhtSn9GmmlRQKl2j0DxUbT9q9mVZ",
  "tag": "PutkemRFtDPkog7lh3aqbw",
  "recipients": [
    {
      "encrypted_key": "S_y3YPaLfjiwGz5o65BHciu14AZv-0J4Kzgtp2s7p7Q",
      "header": {
        "alg": "HPKE-P256-SHA256-A128GCM",
        "enc": "A128GCM",
        "kid": "urn:ietf:params:oauth:jwk-thumbprint:sha-256:bVviD6o
        OxaE-bCceWhaMYxOA7V-uy8fUl1xxvZ-Krvc",
        "psk_id": "our-pre-shared-key-id",
        "auth_kid": "urn:ietf:params:oauth:jwk-thumbprint:sha-256:bV
        viD6oOxaE-bCceWhaMYxOA7V-uy8fUl1xxvZ-Krvc",
        "ek": "BKVLrAsOZ81MrTY3oyvSHnbBQWBp0viMZi0xYJkrOWcFIJThiyHkl
        LwplWoLQsQyE3xM6glXxWhJyb4LCzMGOLc"
      }
    }
  ]
}
</pre><a href="#appendix-A.2.1-4" class="pilcrow">¶</a>
</div>
<p id="appendix-A.2.1-5">The decoded protected header is:<a href="#appendix-A.2.1-5" class="pilcrow">¶</a></p>
<div class="lang-text sourcecode" id="appendix-A.2.1-6">
<pre>
{
  "enc": "A128GCM"
}
</pre><a href="#appendix-A.2.1-6" class="pilcrow">¶</a>
</div>
<p id="appendix-A.2.1-7">The decrypted plaintext is:<a href="#appendix-A.2.1-7" class="pilcrow">¶</a></p>
<div class="lang-text sourcecode" id="appendix-A.2.1-8">
<pre>
⌛ My lungs taste the air of Time Blown past falling sands ⌛
</pre><a href="#appendix-A.2.1-8" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="example-3">
<section id="appendix-A.2.2">
          <h4 id="name-example-3">
<a href="#appendix-A.2.2" class="section-number selfRef">A.2.2. </a><a href="#name-example-3" class="section-name selfRef">Example 3</a>
          </h4>
<p id="appendix-A.2.2-1">This example demonstrates the use of Key Encryption with Auth Mode and a Pre shared key, JWE Additional Authenticated Data and General JWE JSON Serialization.<a href="#appendix-A.2.2-1" class="pilcrow">¶</a></p>
<p id="appendix-A.2.2-2">There is way to express a JWE with aad in Compact JWE Serialization.<a href="#appendix-A.2.2-2" class="pilcrow">¶</a></p>
<div class="lang-text sourcecode" id="appendix-A.2.2-3">
<pre>
{
  "protected": "eyJlbmMiOiJBMTI4R0NNIn0",
  "iv": "Koo4oayn9ooLgbKp",
  "ciphertext": "rGtay4qzhd_PyahVR7YcjmVd9txM1xndn74Bo5xGG3EIQJ5CPXl
  O7VqA8H_YDTWICdpoUWJbJNKI1wniEwhO",
  "tag": "Q68sYFCFFYH6CGXUbPcU0g",
  "aad": "cGF1bCBhdHJlaWRlcw",
  "recipients": [
    {
      "encrypted_key": "hSi_NAlaas0QarPbpESlBXuE9d204faW",
      "header": {
        "kid": "urn:ietf:params:oauth:jwk-thumbprint:sha-256:gnW5wb1
        7yYOST5_wEv87Y6Cf_bqF7dV5b0v_8Lxsrko",
        "alg": "ECDH-ES+A128KW",
        "epk": {
          "kty": "EC",
          "crv": "P-256",
          "x": "41mLA3QKwfhO9yWbPeMV6Xw35Vwpn1di6deLdK0kGjc",
          "y": "SzVzu3IWH6YaPA9DjgKh81jDcRvhcmRgpP9S_qEechU"
        }
      }
    },
    {
      "encrypted_key": "2WJXQE3eKLITL7m61gz4MXA37bE8QfPHjwnt0Kgq3u8",
      "header": {
        "alg": "HPKE-P256-SHA256-A128GCM",
        "enc": "A128GCM",
        "kid": "urn:ietf:params:oauth:jwk-thumbprint:sha-256:1x34RWo
        fdglrdlAhqUJotlSnknAc0pcsarZtZPADNxk",
        "psk_id": "our-pre-shared-key-id",
        "auth_kid": "urn:ietf:params:oauth:jwk-thumbprint:sha-256:1x
        34RWofdglrdlAhqUJotlSnknAc0pcsarZtZPADNxk",
        "ek": "BLRK__E3XUC75sGRAo8de-wDasg_IDNcmmC-Lfnvk1S-uJ00fccdf
        TKKXgDeo4cGGYviPYdq7xhEWbAA4VpIxVg"
      }
    }
  ]
}
</pre><a href="#appendix-A.2.2-3" class="pilcrow">¶</a>
</div>
<p id="appendix-A.2.2-4">The decoded protected header is:<a href="#appendix-A.2.2-4" class="pilcrow">¶</a></p>
<div class="lang-text sourcecode" id="appendix-A.2.2-5">
<pre>
{
  "enc": "A128GCM"
}
</pre><a href="#appendix-A.2.2-5" class="pilcrow">¶</a>
</div>
<p id="appendix-A.2.2-6">The decrypted plaintext is:<a href="#appendix-A.2.2-6" class="pilcrow">¶</a></p>
<div class="lang-text sourcecode" id="appendix-A.2.2-7">
<pre>
⌛ My lungs taste the air of Time Blown past falling sands ⌛
</pre><a href="#appendix-A.2.2-7" class="pilcrow">¶</a>
</div>
<p id="appendix-A.2.2-8">The decoded aad is:<a href="#appendix-A.2.2-8" class="pilcrow">¶</a></p>
<div class="lang-text sourcecode" id="appendix-A.2.2-9">
<pre>
paul atreides
</pre><a href="#appendix-A.2.2-9" class="pilcrow">¶</a>
</div>
</section>
</div>
</section>
</div>
</section>
</div>
<div id="acknowledgments">
<section id="appendix-B">
      <h2 id="name-acknowledgments">
<a href="#name-acknowledgments" class="section-name selfRef">Acknowledgments</a>
      </h2>
<p id="appendix-B-1">This specification leverages text from <span>[<a href="#I-D.ietf-cose-hpke" class="cite xref">I-D.ietf-cose-hpke</a>]</span>. We would like to thank Matt Chanda, Ilari Liusvaara, Aaron Parecki and Filip Skokan for their feedback.<a href="#appendix-B-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="document-history">
<section id="appendix-C">
      <h2 id="name-document-history">
<a href="#name-document-history" class="section-name selfRef">Document History</a>
      </h2>
<p id="appendix-C-1">-01<a href="#appendix-C-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="appendix-C-2.1">
          <p id="appendix-C-2.1.1">Apply feedback from call for adoption.<a href="#appendix-C-2.1.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="appendix-C-2.2">
          <p id="appendix-C-2.2.1">Provide examples of auth and psk modes for JSON and Compact Serializations<a href="#appendix-C-2.2.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="appendix-C-2.3">
          <p id="appendix-C-2.3.1">Simplify description of HPKE modes<a href="#appendix-C-2.3.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="appendix-C-2.4">
          <p id="appendix-C-2.4.1">Adjust IANA registration requests<a href="#appendix-C-2.4.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="appendix-C-2.5">
          <p id="appendix-C-2.5.1">Remove HPKE Mode from named algorithms<a href="#appendix-C-2.5.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="appendix-C-2.6">
          <p id="appendix-C-2.6.1">Fix AEAD named algorithms<a href="#appendix-C-2.6.1" class="pilcrow">¶</a></p>
</li>
      </ul>
<p id="appendix-C-3">-00<a href="#appendix-C-3" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="appendix-C-4.1">
          <p id="appendix-C-4.1.1">Created initial working group version from draft-rha-jose-hpke-encrypt-07<a href="#appendix-C-4.1.1" class="pilcrow">¶</a></p>
</li>
      </ul>
</section>
</div>
<div id="authors-addresses">
<section id="appendix-D">
      <h2 id="name-authors-addresses">
<a href="#name-authors-addresses" class="section-name selfRef">Authors' Addresses</a>
      </h2>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Tirumaleswar Reddy</span></div>
<div dir="auto" class="left"><span class="org">Nokia</span></div>
<div dir="auto" class="left">
<span class="locality">Bangalore</span> </div>
<div dir="auto" class="left"><span class="region">Karnataka</span></div>
<div dir="auto" class="left"><span class="country-name">India</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:kondtir@gmail.com" class="email">kondtir@gmail.com</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Hannes Tschofenig</span></div>
<div dir="auto" class="left"><span class="country-name">Austria</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:hannes.tschofenig@gmx.net" class="email">hannes.tschofenig@gmx.net</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Aritra Banerjee</span></div>
<div dir="auto" class="left"><span class="org">Nokia</span></div>
<div dir="auto" class="left"><span class="locality">Munich</span></div>
<div dir="auto" class="left"><span class="country-name">Germany</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:aritra.banerjee@nokia.com" class="email">aritra.banerjee@nokia.com</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Orie Steele</span></div>
<div dir="auto" class="left"><span class="org">Transmute</span></div>
<div dir="auto" class="left"><span class="country-name">United States</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:orie@transmute.industries" class="email">orie@transmute.industries</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Michael B. Jones</span></div>
<div dir="auto" class="left"><span class="org">Self-Issued Consulting</span></div>
<div dir="auto" class="left"><span class="country-name">United States</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:michael_b_jones@hotmail.com" class="email">michael_b_jones@hotmail.com</a>
</div>
<div class="url">
<span>URI:</span>
<a href="https://self-issued.info/" class="url">https://self-issued.info/</a>
</div>
</address>
</section>
</div>
<script>const toc = document.getElementById("toc");
toc.querySelector("h2").addEventListener("click", e => {
  toc.classList.toggle("active");
});
toc.querySelector("nav").addEventListener("click", e => {
  toc.classList.remove("active");
});
</script>
</body>
</html>
